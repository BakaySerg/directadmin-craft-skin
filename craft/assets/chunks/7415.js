"use strict";(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[7415],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/history/chart.vue?vue&type=script&lang=js&":function(e,t,r){r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.object.define-properties.js"),r("./node_modules/core-js/modules/es.object.define-property.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js"));r("./node_modules/core-js/modules/es.object.values.js"),r("./node_modules/core-js/modules/es.array.reduce.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.regexp.to-string.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.parse-int.js");var n=o(r("./node_modules/vue/dist/vue.common.js")),a=r("./src/js/components/local/history/base-charts.js");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={components:{LineChart:n.default.extend({extends:a.Line,mixins:[a.reactiveProp],props:["chart","options"],mounted:function(){this.renderChart(this.chartData,this.options)}})},props:{type:{type:String,required:!1,default:"volumes"},history:{type:Array,required:!0},hideLinks:{type:Boolean,required:!1,default:!1}},data:function(){return{year:null,hovered:null}},computed:{years:function(){return Object.values(this.history.reduce((function(e,t){var r=t.year;return l((0,s.default)({},r,r.toString()),e)}),{}))},rows:function(){var e=this;return this.history.filter((function(t){return t.year.toString()===e.year}))},labels:function(){return this.rows.map(this.getMonthName)},chartData:function(){return this.chart[this.type].chartData},options:function(){return this.chart[this.type].options},chart:function(){var e=this,t={enabled:!0,mode:"nearest",intersect:!1,bodySpacing:6,padding:10,titleFont:{family:"Open Sans"},bodyFont:{family:"Open Sans"},footerFont:{family:"Open Sans",size:10},displayColors:!1};return{volumes:{chartData:{labels:this.labels,datasets:[l({label:this.$gettext("Bandwidth"),data:this.rows.map((function(e){return e.bandwidth}))},this.datasetOptions("danger")),l({label:this.$gettext("Disk Usage"),data:this.rows.map((function(e){return e.quota}))},this.datasetOptions("primary"))]},options:{onClick:this.chartsClick,scales:{y:{ticks:{callback:this.size}}},plugins:{legend:{onClick:function(){}},tooltip:l(l({},t),{},{callbacks:{title:function(t){var r=e.rows[t[0].dataIndex];return"".concat(e.getMonthName(r)," ").concat(r.year)},label:function(t){var r=t.datasetIndex,o=t.raw,s=[e.$gettext("Bandwidth"),e.$gettext("Disk Usage")][r];return 0!==o?"".concat(s,": ").concat(e.size(o)):""},footer:function(t){return 0!==t[0].datasetIndex||e.hideLinks?(e.$emit("hover:clear"),""):(e.$emit("hover:date",e.rows[t[0].dataIndex]),e.$gettext("Click for details"))}}})}}},inodes:{chartData:{labels:this.labels,datasets:[l({label:this.$gettext("Inodes Count"),data:this.rows.map((function(e){return e.inode}))},this.datasetOptions("safe"))]},options:{plugins:{legend:{onClick:function(){}},tooltip:l(l({},t),{},{callbacks:{title:function(t){var r=e.rows[t[0].dataIndex];return"".concat(e.getMonthName(r)," ").concat(r.year)},footer:function(){return e.hideLinks?void 0:e.$gettext("Click for details")}}})}}}}}},created:function(){var e=this;this.year=this.years[this.years.length-1],this.$on("hover:date",(function(t){var r=t.year,o=t.month;e.hovered={year:r,month:o}})),this.$on("hover:clear",(function(){e.hovered=null}))},methods:{chartsClick:function(){this.hovered&&this.$emit("click",this.hovered)},size:function(e){return this.$options.filters.humanReadableSize(e)},datasetOptions:function(e){var t=function(e){return getComputedStyle(document.body).getPropertyValue("--".concat(e))};return{backgroundColor:t("".concat(e,"-overlay")),borderColor:t(e),pointBackgroundColor:t(e),borderWidth:3,pointRadius:5,pointHitRadius:20,tension:.4}},getMonthName:function(e){var t=e.month;return[this.$gettext("January"),this.$gettext("February"),this.$gettext("March"),this.$gettext("April"),this.$gettext("May"),this.$gettext("June"),this.$gettext("July"),this.$gettext("August"),this.$gettext("September"),this.$gettext("October"),this.$gettext("November"),this.$gettext("December")][parseInt(t,10)-1]}}};t.Z=u},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/history/table.vue?vue&type=script&lang=js&":function(e,t,r){r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.weak-map.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=r("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.parse-int.js");var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=a?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(s,i,l):s[i]=e[i]}s.default=e,r&&r.set(e,s);return s}(r("./node_modules/ramda/src/index.js"));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}var a={props:{history:{type:Array,required:!0},hideLinks:{type:Boolean,required:!1,default:!1}},data:function(){return{sort:{key:"year",order:"DESC"}}},computed:{ipp:function(){var e=Number(this.$route.query.ipp)||!1;return e&&e>0?e:this.$state.options["tables/ipp"]},page:function(){var e=Number(this.$route.query.page)||!1;return e&&e>0?e:1},sortComparator:function(){var e="DESC"===this.sort.order?s.descend:s.ascend;return s.sortWith("year"===this.sort.key?[e(s.prop("year")),e(s.prop("month"))]:[e(s.prop(this.sort.key))])},sortedHistory:function(){return this.sortComparator(this.history)},rows:function(){return this.sortedHistory.slice((this.page-1)*this.ipp,this.page*this.ipp)}},methods:{getMonthName:function(e){return[this.$gettext("January"),this.$gettext("February"),this.$gettext("March"),this.$gettext("April"),this.$gettext("May"),this.$gettext("June"),this.$gettext("July"),this.$gettext("August"),this.$gettext("September"),this.$gettext("October"),this.$gettext("November"),this.$gettext("December")][parseInt(e,10)-1]}}};t.Z=a},"./src/js/api/commands/history.js":function(e,t,r){r("./node_modules/core-js/modules/es.object.define-property.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getUserHistory=t.getServerHistory=t.getResellerHistory=void 0,r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.promise.js");var s=o(r("./src/js/api/command/index.js")),n=s.default.get({url:"/CMD_USER_HISTORY",response:[],after:function(e){return e.flow(e.toArray,e.mapArrayProps({bandwidth:e.convert.toAppNumber,quota:e.convert.toAppNumber,inode:e.convert.toAppNumber,year:e.convert.toAppNumber,month:e.convert.toAppNumber}))}}),a=n.extend({id:"USER_HISTORY",url:"/CMD_USER_HISTORY",schema:{user:s.default.OPTIONAL_STRING}});t.getUserHistory=a;var i=n.extend({id:"RESELLER_HISTORY",url:"/CMD_RESELLER_HISTORY",schema:{user:s.default.OPTIONAL_STRING}});t.getResellerHistory=i;var l=n.extend({id:"ADMIN_HISTORY",url:"/CMD_ADMIN_HISTORY"});t.getServerHistory=l},"./src/js/components/local/history/base-charts.js":function(e,t,r){r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.object.define-properties.js"),r("./node_modules/core-js/modules/es.object.define-property.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.Line=void 0,t.generateChart=c,t.reactiveProp=t.reactiveData=void 0;var s=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),n=o(r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"));r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.index-of.js");var a=r("./node_modules/chart.js/dist/chart.esm.js");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw n}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function c(e,t){return{render:function(e){return e("div",{style:this.styles,class:this.cssClasses},[e("canvas",{attrs:{id:this.chartId,width:this.width,height:this.height},ref:"canvas"})])},props:{chartId:{default:e,type:String},width:{default:400,type:Number},height:{default:400,type:Number},cssClasses:{type:String,default:""},styles:{type:Object},plugins:{type:Array,default:function(){return[]}}},data:function(){return{_chart:null}},created:function(){a.Chart.register.apply(a.Chart,(0,n.default)(a.registerables))},methods:{renderChart:function(e,r){this.$data._chart&&this.$data._chart.destroy();var o=r;if(this.plugins.length>0){var s,n=u(this.plugins);try{for(n.s();!(s=n.n()).done;){var i=s.value;o.plugins=l(l({},o.plugins),i)}}catch(e){n.e(e)}finally{n.f()}}this.$data._chart=new a.Chart(this.$refs.canvas.getContext("2d"),{type:t,data:e,options:o})}},beforeDestroy:function(){this.$data._chart&&this.$data._chart.destroy()}}}function h(e,t){if(t){var r=this.$data._chart,o=e.datasets.map((function(e){return e.label})),s=t.datasets.map((function(e){return e.label})),n=JSON.stringify(s);JSON.stringify(o)===n&&t.datasets.length===e.datasets.length?(e.datasets.forEach((function(e,o){var s=Object.keys(t.datasets[o]),n=Object.keys(e),a=s.filter((function(e){return"_meta"!==e&&-1===n.indexOf(e)}));for(var i in a.forEach((function(e){delete r.data.datasets[o][e]})),e)e.hasOwnProperty(i)&&(r.data.datasets[o][i]=e[i])})),e.hasOwnProperty("labels")&&(r.data.labels=e.labels,this.$emit("labels:update")),r.update(),this.$emit("chart:update")):(r&&(r.destroy(),this.$emit("chart:destroy")),this.renderChart(this.chartData,this.options),this.$emit("chart:render"))}else this.$data._chart&&(this.$data._chart.destroy(),this.$emit("chart:destroy")),this.renderChart(this.chartData,this.options),this.$emit("chart:render")}var p={data:function(){return{chartData:null}},watch:{chartData:h}};t.reactiveData=p;var m={props:{chartData:{type:Object,required:!0,default:function(){}}},watch:{chartData:h}};t.reactiveProp=m;var f=c("line-chart","line");t.Line=f},"./src/js/components/local/history/chart.vue":function(e,t,r){r.r(t),r.d(t,{__esModule:function(){return o.X},default:function(){return n}});var o=r("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/history/chart.vue?vue&type=script&lang=js&"),s=o.Z,n=(0,r("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("app-page-section",[r("ui-form-element",{attrs:{underline:!1,"vertical-on-phone":!1}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Year:\n        ")]),e._v(" "),r("input-select",{attrs:{slot:"content",options:e.years},slot:"content",model:{value:e.year,callback:function(t){e.year=t},expression:"year"}})],1),e._v(" "),r("line-chart",e._b({key:e.type},"line-chart",e.chart[e.type],!1))],1)}),[],!1,null,null,null).exports},"./src/js/components/local/history/table.vue":function(e,t,r){r.r(t),r.d(t,{__esModule:function(){return o.X},default:function(){return n}});var o=r("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/history/table.vue?vue&type=script&lang=js&"),s=o.Z,n=(0,r("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("app-page-section",[r("ui-r-table",{attrs:{rows:e.rows,sort:e.sort,columns:[{id:"year",label:e.$gettext("Date")},{id:"bandwidth",label:e.$gettext("Bandwidth")},{id:"quota",label:e.$gettext("Disk Usage")},{id:"inode",label:e.$gettext("Inodes Count")}],"rows-count":e.history.length,"is-checkable":!1,"vertical-layout":e.$_Client.isPhone,"is-sortable":"","external-sorting":"",sort:e.sort,"equal-width-layout":""},on:{"update:sort":function(t){e.sort=t}},scopedSlots:e._u([{key:"col:year",fn:function(t){var o=t.year,s=t.month;return r(e.hideLinks?"span":"ui-link",{tag:"component",staticClass:"txt:bold",on:{click:function(t){return e.$emit("click",{year:o,month:s})}}},[e._v("\n            "+e._s(e.getMonthName(s))+", "+e._s(o)+"\n        ")])}},{key:"col:bandwidth",fn:function(t){var r=t.bandwidth;return[e._v("\n            "+e._s(e._f("humanReadableSize")(r))+"\n        ")]}},{key:"col:quota",fn:function(t){var r=t.quota;return[e._v("\n            "+e._s(e._f("humanReadableSize")(r))+"\n        ")]}}])})],1)}),[],!1,null,null,null).exports}}]);