(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[8043],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/updates.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r,o,a,i=n(s("./node_modules/@babel/runtime/regenerator/index.js")),d=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=(n(s("./node_modules/vue/dist/vue.common.js")),s("./src/js/api/endpoint/index.ts")),c=s("./src/js/endpoints/version/index.ts"),l=s("./src/js/endpoints/version/helpers.ts"),p=s("./node_modules/ramda/src/index.js"),m=s("./src/js/api/commands/admin/services.js"),v=(s("./src/js/modules/constants.js"),{beforeRouteEnter:(0,u.preload)([function(){return c.getVersion.request()}]),data:function(){return{restarted:!1,updated:!1}},computed:{version:c.getVersion.bindData((0,p.evolve)({uptime:l.getUptimeString})),changelogLink:function(){return"https://docs.directadmin.com/changelog/version-".concat(this.version.update.version,".html")},craftVersion:function(){return{version:this.$_session.skinVersion,commit:"d9d5021e2687883f2203ffbb18e8bf328822f654"}}},methods:{updateDA:(a=(0,d.default)(i.default.mark((function e(){var t,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.updateDirectadmin.request();case 2:if(t=e.sent,!(s=t.error)){e.next=7;break}return s.notify(),e.abrupt("return");case 7:this.$notifications.success({title:this.$gettext("Success"),content:this.$gettext("Update is scheduled")});case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),restartDA:(o=(0,d.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.restart)({service:"directadmin"});case 2:if(!e.sent){e.next=4;break}this.restarted=!0;case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),changeUpdateChannel:(r=(0,d.default)(i.default.mark((function e(t){var s,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==c.getVersion.data.update.channel){e.next=2;break}return e.abrupt("return");case 2:return s=c.getVersion.data.update.channel,c.getVersion.data=(0,p.mergeDeepRight)(c.getVersion.data,{update:{channel:t}}),e.next=6,c.changeUpdateChannel.request({update:{channel:t}});case 6:if("error"!==(n=e.sent).state){e.next=11;break}return c.getVersion.data=(0,p.mergeDeepRight)(c.getVersion.data,{update:{channel:s}}),n.error.notify(),e.abrupt("return");case 11:c.getVersion.data=n.data,this.$notifications.success({title:this.$gettext("Success"),content:this.$gettext("Channel update scheduled")});case 13:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}});t.Z=v},"./src/js/api/commands/admin/services.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.stop=t.start=t.restart=t.reload=t.rebootServer=t.getServices=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js"));s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.reduce.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var o=n(s("./src/js/api/command/index.js"));function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){(0,r.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var d=["reload","restart","start","stop"],u=o.default.get({id:"SERVICES",url:"/CMD_SHOW_SERVICES",response:[],params:{bytes:!0},after:function(){return function(e){return Object.keys(e.status).map((function(t){return{service:t,memory:e.memory[t],pid:e.pids[t]||[],running:"on"===e.status[t],actions:d.reduce((function(s,n){return i(i({},s),{},(0,r.default)({},n,e.actions[t].includes(n)))}),{})}}))}}});t.getServices=u;var c=function(e){return o.default.post({url:"/CMD_SERVICE",params:{action:e},schema:{service:o.default.REQUIRED_STRING},notifySuccess:!1})},l=c("start");t.start=l;var p=c("stop");t.stop=p;var m=c("restart");t.restart=m;var v=c("reload");t.reload=v;var f=o.default.post({url:"/CMD_REBOOT",params:{json:!0},schema:{passwd:o.default.REQUIRED_STRING}});t.rebootServer=f},"./src/js/endpoints/version/helpers.ts":function(e,t,s){"use strict";s.r(t),s.d(t,{getUptimeString:function(){return i}});var n=s("./node_modules/vue/dist/vue.common.prod.js"),r=s.n(n),o=s("./node_modules/date-fns/esm/subSeconds/index.js"),a=s("./node_modules/date-fns/esm/intervalToDuration/index.js"),i=function(e){var t=new(r()),s=Math.round(e*Math.pow(10,-9)),n=Date.now(),i=(0,o.default)(n,s),d=(0,a.Z)({start:i,end:n}),u=t.$ngettext,c=t.$gettextInterpolate,l=function(e,t){return c(e,{n:t})};return Object.entries(d).reduce((function(e,t){var s=t[0],n=t[1];if(0===n||void 0===n)return e;switch(s){case"years":e.push(l(u("%{n} year","%{n} years",n),n));break;case"months":e.push(l(u("%{n} month","%{n} months",n),n));break;case"days":e.push(l(u("%{n} day","%{n} days",n),n));break;case"hours":e.push(l(u("%{n} hour","%{n} hours",n),n));break;case"minutes":e.push(l(u("%{n} minute","%{n} minutes",n),n));break;case"seconds":e.push(l(u("%{n} second","%{n} seconds",n),n))}return e}),[]).join(", ")}},"./src/js/endpoints/version/index.ts":function(e,t,s){"use strict";s.r(t),s.d(t,{getVersion:function(){return r},updateDirectadmin:function(){return o},changeUpdateChannel:function(){return a}});var n=s("./src/js/api/endpoint/index.ts"),r=(0,n.GET)("/version"),o=(0,n.POST)("/version/update"),a=(0,n.PATCH)("/version",{statusCodes:{304:"NOT_MODIFIED"},errorMessages:{NOT_MODIFIED:(0,n.$gettext)("Previous update still in progress")}})},"./src/js/pages/admin/updates.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return u}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/updates.vue?vue&type=script&lang=js&"),r=n.Z,o=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=s("./src/js/pages/admin/updates.vue?vue&type=custom&index=0&blockType=route"),i=s.n(a),d=(0,o.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",[s("app-page-section",[s("table",{staticClass:"table-elem"},[s("tbody",[s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("Version"))}}),e._v(" "),s("td",[s("translate",{attrs:{"translate-params":e.version}},[e._v("\n                            %{ version } (build %{ commit })\n                        ")]),e._v(" "),s("translate",{staticClass:"c:txt:primary",attrs:{tag:"a",href:"https://docs.directadmin.com/changelog/version-"+e.version.version+".html"}},[e._v("\n                            Changelog\n                        ")])],1)]),e._v(" "),s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("DA build for OS"))}}),e._v(" "),s("td",{domProps:{textContent:e._s(e.version.buildDistro)}})]),e._v(" "),s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("Detected server OS"))}}),e._v(" "),s("td",{domProps:{textContent:e._s(e.version.detectedDistro)}})]),e._v(" "),s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("Uptime"))}}),e._v(" "),s("td",{domProps:{textContent:e._s(e.version.uptime)}})]),e._v(" "),s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("Update Channel"))}}),e._v(" "),s("td",[s("input-select",{attrs:{options:e.version.update.availableChannels,selected:e.version.update.channel},on:{change:e.changeUpdateChannel}})],1)]),e._v(" "),e.version.update.available?s("tr",[s("td",{staticClass:"txt:bold",domProps:{textContent:e._s(e.$gettext("Available Update"))}}),e._v(" "),s("td",[s("translate",{attrs:{"translate-params":e.version.update}},[e._v("\n                            %{ version } (build %{ commit })\n                        ")]),e._v(" "),s("ui-link",{staticClass:"c:txt:primary",attrs:{target:"_blank",href:e.changelogLink}},[s("translate",[e._v("Changelog")])],1)],1)]):e._e(),e._v(" "),s("tr",[s("td",{staticClass:"txt:bold"},[e._v("\n                        Craft Version\n                    ")]),e._v(" "),s("td",[s("translate",{attrs:{"translate-params":e.craftVersion}},[e._v("\n                            %{ version } (build %{ commit })\n                        ")])],1)])])]),e._v(" "),s("template",{slot:"footer:buttons"},[e.version.update.available?s("ui-button",{attrs:{disabled:e.updated,theme:"primary"},on:{click:e.updateDA}},[e._v("\n                "+e._s(e.updated?e.$gettext("Updating now..."):e.$gettext("Update DirectAdmin"))+"\n            ")]):e._e(),e._v(" "),s("ui-button",{attrs:{theme:"danger",disabled:e.restarted},on:{click:e.restartDA}},[e._v("\n                "+e._s(e.restarted?e.$gettext("Restarting now..."):e.$gettext("Restart DirectAdmin"))+"\n            ")])],1)],2)],1)}),[],!1,null,null,null);"function"==typeof i()&&i()(d);var u=d.exports},"./src/js/pages/admin/updates.vue?vue&type=custom&index=0&blockType=route":function(){}}]);