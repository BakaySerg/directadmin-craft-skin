(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1856:function(e,t,r){"use strict";r.r(t);var n=r(4054),a=r(2731);for(var o in a)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(o);var i=r(0),s=r(3755),u=r.n(s),c=Object(i.a)(a.default,n.a,n.b,!1,null,null,null);"function"==typeof u.a&&u()(c),t.default=c.exports},2010:function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.getDirs=t.updateName=t.unprotectDirectory=t.deleteUsers=t.addUser=t.getDirectoryInfo=t.getDirectoryStatus=t.getDirectories=t.protectDirectory=void 0;var a=n(r(78)),o="/CMD_FILE_MANAGER",i=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{path:a.default.REQUIRED_STRING,user:a.default.REQUIRED_STRING,passwd:a.default.REQUIRED_STRING,passwd2:a.default.REQUIRED_STRING}});t.protectDirectory=i;var s=a.default.get({id:"PROTECTED_DIRECTORIES",url:"/CMD_PROTECTED_DIRECTORIES",domain:!0,response:[]});t.getDirectories=s;var u=a.default.get({id:"PROTECTED_DIRECTORY_STATUS",url:o,params:{action:"protect"},schema:{path:a.default.REQUIRED_STRING},response:{protected:!1},after:function(){return function(e){return{protected:!!e.ENABLED}}}});t.getDirectoryStatus=u;var c=u.extend({id:"PROTECTED_DIRECTORY_INFO",pagination:!0,response:{},after:function(e){return e.flow(e.deleteProp("ENABLED"),e.deleteProp("domain"),e.deleteProp("path"),e.processTableInfo("users"),e.moveProp({users:"rows",NAME:"name"}),e.mapProp("rows",e.toArray))}});t.getDirectoryInfo=c;var l=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING,user:a.default.REQUIRED_STRING,passwd:a.default.REQUIRED_STRING,passwd2:a.default.REQUIRED_STRING}});t.addUser=l;var d=a.default.select({url:o,params:{action:"delete"},schema:{path:a.default.REQUIRED_STRING}});t.deleteUsers=d;var f=a.default.post({url:o,params:{action:"protect"},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING}});t.unprotectDirectory=f;var p=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING}});t.updateName=p;var v=a.default.get({url:"/CMD_FILE_MANAGER",params:{action:"json_all",ipp:1e5,comparison12:"equals",value12:"directory"}});t.getDirs=v},2731:function(e,t,r){"use strict";r.r(t);var n=r(2732),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t.default=a.a},2732:function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(36));r(26);var o,i=n(r(37)),s=n(r(3747)),u=r(2010),c={preload:u.getDirectories,components:{FmTree:s.default},api:u.getDirectories,data:function(){return{path:"",name:"",user:"",passwd:""}},methods:{protectDirectory:(o=(0,i.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.protectDirectory)({path:this.path,name:this.name,user:this.user,passwd:this.passwd,passwd2:this.passwd});case 2:if(!(e.sent instanceof Error)){e.next=5;break}return e.abrupt("return");case 5:this.$router.push({name:"user/protected-directories/view",query:{path:this.path}});case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})}};t.default=c},2733:function(e,t,r){"use strict";r.r(t);var n=r(2734),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t.default=a.a},2734:function(e,t,r){"use strict";r(7),r(10),r(6),r(8),r(11);var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(36)),o=n(r(37)),i=n(r(2));r(34),r(12),r(15),r(5),r(50),r(17),r(26);var s=n(r(3146)),u=r(2010);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d,f,p,v={name:"FmTree",components:{FmTreeBody:s.default},model:{prop:"value",event:"update:value"},props:{value:{type:String,required:!0},protected:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{expanded:[],dirs:{},loading:!0}},computed:{nodes:function(){var e=this;return function t(r){return(e.dirs[r]||[]).map((function(r){return l(l({},r),{},{children:t(r.path),expanded:e.isExpanded(r.path),selected:e.value===r.path})}))}("/domains")}},mounted:(p=(0,o.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDirs("/domains");case 2:this.loading=!1;case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),methods:{isExpanded:function(e){return this.expanded.includes(e)},chooseDirectory:function(e){this.$emit("update:value",e)},loadDirs:(f=(0,o.default)(a.default.mark((function e(t){var r,n=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.getDirs)({path:t});case 2:delete(r=e.sent).info,this.$set(this.dirs,t,Object.values(r).filter((function(e){return"0"===e.islink})).map((function(e){return{protectable:1==(1&Number(e.api_flags)),name:e.name,path:e.truepath,lazy:Number(e.sub_directories)>0,isProtected:n.protected.includes(e.truepath)}})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)}),togglePath:(d=(0,o.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isExpanded(t)){e.next=4;break}this.expanded=this.expanded.filter((function(e){return t!==e})),e.next=7;break;case 4:return e.next=6,this.loadDirs(t);case 6:this.expanded.push(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)}),getPathChildren:function(e){return this.dirs[e]||[]}}};t.default=v},2735:function(e,t,r){"use strict";r.r(t);var n=r(2736),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t.default=a.a},2736:function(e,t,r){"use strict";var n=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(3146)),o=n(r(3748)),i={name:"FmTreeBody",components:{FmTreeBody:a.default,FmTreeHeader:o.default},props:{nodes:{type:Array,required:!0}}};t.default=i},2737:function(e,t,r){"use strict";r.r(t);var n=r(2738),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t.default=a.a},2738:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={props:{path:{type:String,required:!0},name:{type:String,required:!0},protectable:Boolean,selected:Boolean,expanded:Boolean,isProtected:Boolean,lazy:Boolean},computed:{model:function(){return this.selected||this.isProtected},disabled:function(){return!1===this.protectable||!0===this.isnprotected}}};t.default=n},3146:function(e,t,r){"use strict";r.r(t);var n=r(4235),a=r(2735);for(var o in a)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(o);r(3751);var i=r(0),s=Object(i.a)(a.default,n.a,n.b,!1,null,null,null);t.default=s.exports},3147:function(e,t,r){var n=r(3750);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(4).default)("2aa5b6bc",n,!0,{})},3148:function(e,t,r){var n=r(3752);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(4).default)("70abdd7c",n,!0,{})},3149:function(e,t,r){var n=r(3754);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(4).default)("004ee462",n,!0,{})},3747:function(e,t,r){"use strict";r.r(t);var n=r(4185),a=r(2733);for(var o in a)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(o);r(3753);var i=r(0),s=Object(i.a)(a.default,n.a,n.b,!1,null,null,null);t.default=s.exports},3748:function(e,t,r){"use strict";r.r(t);var n=r(4263),a=r(2737);for(var o in a)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(o);r(3749);var i=r(0),s=Object(i.a)(a.default,n.a,n.b,!1,null,null,null);t.default=s.exports},3749:function(e,t,r){"use strict";r(3147)},3750:function(e,t,r){},3751:function(e,t,r){"use strict";r(3148)},3752:function(e,t,r){},3753:function(e,t,r){"use strict";r(3149)},3754:function(e,t,r){},3755:function(e,t){},4054:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("app-page",[r("app-page-section",[r("ui-form-element",[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Path\n            ")]),e._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("fm-tree",{attrs:{protected:e.$api},model:{value:e.path,callback:function(t){e.path=t},expression:"path"}}),e._v(" "),e.path?r("input-text",{directives:[{name:"margin",rawName:"v-margin:top",value:.5,expression:"0.5",arg:"top"}],staticClass:"width:100%",attrs:{value:e.path,disabled:""}}):e._e()],1)],1),e._v(" "),r("ui-form-element",{attrs:{vertical:""}}),e._v(" "),r("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Protected Directory Prompt\n            ")]),e._v(" "),r("input-text",{attrs:{slot:"content",placeholder:e.$gettext("e.g. Member's Area")},slot:"content",model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),r("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Set/Update User\n            ")]),e._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1),e._v(" "),r("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Password\n            ")]),e._v(" "),r("input-password",{attrs:{slot:"content","show-generator":""},slot:"content",model:{value:e.passwd,callback:function(t){e.passwd=t},expression:"passwd"}})],1)],1),e._v(" "),r("ui-button",{attrs:{slot:"footer:buttons",theme:"primary","validate-group":"protectDir",disabled:""===e.path},on:{click:e.protectDirectory},slot:"footer:buttons"},[r("translate",[e._v("Protect")])],1)],1)},a=[]},4185:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fm-tree scrollbar:primary"},[this.loading?t("ui-center",{attrs:{height:"400px"}},[t("ui-loader-icon",{attrs:{size:32}})],1):t("fm-tree-body",this._b({on:{select:this.chooseDirectory,expand:this.togglePath}},"fm-tree-body",{nodes:this.nodes},!1))],1)},a=[]},4235:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fm-tree-body"},e._l(e.nodes,(function(t){return r("div",{key:t.path,staticClass:"fm-tree-item"},[r("fm-tree-header",e._g(e._b({},"fm-tree-header",t,!1),e.$listeners)),e._v(" "),t.expanded&&t.children.length?r("fm-tree-body",e._g({attrs:{nodes:t.children}},e.$listeners)):e._e()],1)})),0)},a=[]},4263:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"row",cross:"center"},expression:"{ dir: 'row', cross: 'center' }"}],staticClass:"fm-tree-header"},[r("span",{staticClass:"fm-tree-header-expand cursor:pointer",on:{click:function(t){return e.$emit("expand",e.path)}}},[e.lazy?r("ui-icon",{class:{"--expanded":e.expanded},attrs:{id:"caret-right",size:12,color:"var(--primary)"}}):e._e()],1),e._v(" "),r("input-checkbox",e._b({directives:[{name:"margin",rawName:"v-margin:left",value:1,expression:"1",arg:"left"},{name:"margin",rawName:"v-margin:right",value:.5,expression:"0.5",arg:"right"}],on:{change:function(t){return e.$emit("select",e.path)}}},"input-checkbox",{model:e.model,disabled:e.disabled},!1),[r("span",{class:{"txt:bold":e.protectable&&!1===e.isProtected},domProps:{textContent:e._s(e.name)}})]),e._v(" "),e.isProtected?r("ui-tooltip",[r("translate",[e._v("Edit Protection")]),e._v(" "),e.isProtected?r("ui-link",{attrs:{slot:"trigger",name:"user/protected-directories/view",query:{path:e.path}},slot:"trigger"},[r("ui-icon",{attrs:{id:"exclamation-triangle"}})],1):e._e()],1):e._e()],1)},a=[]}}]);