(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[5177],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/clamav/index.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=n(s("./node_modules/@babel/runtime/regenerator/index.js"));s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js");var a,o,i,c,u,l=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=s("./src/js/endpoints/clamav/index.ts"),p={beforeRouteEnter:(0,s("./src/js/api/endpoint/index.ts").preload)([function(){return d.getClamAV.request()}]),data:function(){return{currentItem:{},query:{path:""},type:"home",refreshTimeout:3e4,refresh:!0}},computed:{clamavList:d.getClamAV.bindData()},mounted:function(){this.refreshList()},beforeDestroy:function(){clearTimeout(this.timeoutId)},methods:{startScan:(u=(0,l.default)(r.default.mark((function e(){var t,s=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=["Maildir","imap"],e.t0=this.type,e.next="home"===e.t0?4:"domains"===e.t0?6:"mail"===e.t0?8:"custom"===e.t0?10:13;break;case 4:return this.createScan(""),e.abrupt("break",13);case 6:return this.createScan("domains"),e.abrupt("break",13);case 8:return t.forEach((function(e){s.createScan(e)})),e.abrupt("break",13);case 10:return this.createScan(this.query.path),this.query.path="",e.abrupt("break",13);case 13:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),createScan:(c=(0,l.default)(r.default.mark((function e(t){var s,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.postClamAV.request({path:t});case 2:s=e.sent,(n=s.error)?n.notify():(this.$notifications.success({title:this.$gettext("Start"),content:this.$gettext("Directory scan process started")}),d.getClamAV.request());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)}),deleteProcessBefore:(i=(0,l.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentItem=t,this.$dialog("DELETE_ITEMS_DIALOG").open();case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)}),deleteProcessAfter:(o=(0,l.default)(r.default.mark((function e(){var t,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.deleteClamAV.request({pid:this.currentItem.pid});case 2:t=e.sent,(s=t.error)?"CLAMAV_PROCESS_NOT_FOUND"==s.type?this.$notifications.success({title:this.$gettext("Cancel"),content:s.message}):s.notify():(this.$notifications.success({title:this.$gettext("Cancel"),content:this.$gettext("Directory scan process canceled")}),d.getClamAV.request());case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),refreshList:(a=(0,l.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.refresh){e.next=3;break}return e.next=3,d.getClamAV.request();case 3:this.timeoutId=setTimeout(this.refreshList,this.refreshTimeout);case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}};t.Z=p},"./src/js/endpoints/clamav/index.ts":function(e,t,s){"use strict";s.r(t),s.d(t,{getClamAV:function(){return r},postClamAV:function(){return a},deleteClamAV:function(){return o}});var n=s("./src/js/api/endpoint/index.ts"),r=(0,n.GET)("/clamav"),a=(0,n.POST)("/clamav",{statusCodes:{409:"CLAMAV_PATH_NOT_FOUND",501:"CLAMAV_SCAN_LIMIT_ERROR"},errorMessages:{CLAMAV_PATH_NOT_FOUND:(0,n.$gettext)("ClamAV path was not found"),CLAMAV_SCAN_LIMIT_ERROR:(0,n.$gettext)("This path is already being scanned by ClamAV")}}),o=(0,n.DELETE)("/clamav/:pid",{statusCodes:{409:"CLAMAV_PROCESS_NOT_FOUND"},errorMessages:{CLAMAV_PROCESS_NOT_FOUND:(0,n.$gettext)("ClamAV process does not exist anymore")}})},"./src/js/pages/user/clamav/index.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return u}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/clamav/index.vue?vue&type=script&lang=js&"),r=n.Z,a=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),o=s("./src/js/pages/user/clamav/index.vue?vue&type=custom&index=0&blockType=route"),i=s.n(o),c=(0,a.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",[s("app-page-section",[s("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("\n            Scan directory to detect malware and other malicious threats.\n        ")]),e._v(" "),s("ui-form-element",{attrs:{underline:!1}},[s("input-radio",{attrs:{slot:"content",value:"home"},slot:"content",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[s("translate",[e._v("\n                    Home - Scan the home directory.\n                ")])],1)],1),e._v(" "),s("ui-form-element",{attrs:{underline:!1}},[s("input-radio",{attrs:{slot:"content",value:"domains"},slot:"content",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[s("translate",[e._v("\n                    Domains - Scan the domains directory.\n                ")])],1)],1),e._v(" "),s("ui-form-element",{attrs:{underline:!1}},[s("input-radio",{attrs:{slot:"content",value:"mail"},slot:"content",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[s("translate",[e._v("\n                    Mail - Scan all mail directories.\n                ")])],1)],1),e._v(" "),s("ui-form-element",[s("input-radio",{attrs:{slot:"title",value:"custom"},slot:"title",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[s("translate",[e._v("\n                    Custom - Scan the desired path. \n                ")])],1),e._v(" "),s("input-text",{attrs:{slot:"content",disabled:"custom"!==e.type,prefix:e.$state.session.homeDir+"/"},slot:"content",model:{value:e.query.path,callback:function(t){e.$set(e.query,"path",t)},expression:"query.path"}})],1),e._v(" "),s("ui-button",{attrs:{slot:"footer:buttons",theme:"primary","validate-group":"job-init"},on:{click:e.startScan},slot:"footer:buttons"},[s("translate",[e._v("Scan Path")])],1)],1),e._v(" "),e.clamavList.processes?s("app-page-section",[s("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("\n            List of currently active scans.\n        ")]),e._v(" "),s("ui-r-table",e._b({attrs:{"disable-pagination":""},scopedSlots:e._u([{key:"col:start_time",fn:function(t){var s=t.start_time;return[e._v("\n                "+e._s(e._f("date")(new Date(s)))+"\n            ")]}},{key:"row:actions",fn:function(t){var n=t.item;return s("ui-button-icon",{attrs:{theme:"danger",icon:"cancel",title:e.$gettext("Cancel")},on:{click:function(t){return e.deleteProcessBefore(n)}}})}}],null,!1,968175764)},"ui-r-table",{rows:e.clamavList.processes,columns:[{id:"pid",label:e.$gettext("PID")},{id:"path",label:e.$gettext("Path")},{id:"start_time",label:e.$gettext("Start time")}],verticalLayout:e.$_Client.isPhone,isCheckable:!1},!1))],1):e._e(),e._v(" "),s("app-page-section",[s("div",{attrs:{slot:"section:title"},slot:"section:title"},[s("translate",[e._v("\n                Read finished scan reports in the \n            ")]),e._v(" "),s("ui-link",{attrs:{path:"/user/messages"}},[s("translate",[e._v("Message Area")])],1)],1)]),e._v(" "),s("ui-dialog-delete-items",{attrs:{subject:e.$gettext("process")},on:{"click:confirm":function(t){return e.deleteProcessAfter()}}},[e._v("\n        "+e._s(e.currentItem.name)+"\n    ")])],1)}),[],!1,null,null,null);"function"==typeof i()&&i()(c);var u=c.exports},"./src/js/pages/user/clamav/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);