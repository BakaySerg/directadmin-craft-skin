(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[9487],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/_components/create-domain-pointer-dialog.vue?vue&type=script&lang=js&":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.array.iterator.js"),a("./node_modules/core-js/modules/es.object.to-string.js"),a("./node_modules/core-js/modules/es.string.iterator.js"),a("./node_modules/core-js/modules/es.weak-map.js"),a("./node_modules/core-js/modules/web.dom-collections.iterator.js"),a("./node_modules/core-js/modules/es.object.define-property.js"),a("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=a("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=o(a("./node_modules/@babel/runtime/regenerator/index.js")),r=o(a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var a=l(t);if(a&&a.has(e))return a.get(e);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=s?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,a&&a.set(e,o);return o}(a("./src/js/api/commands/user/domain-pointers.ts"));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(l=function(e){return e?a:t})(e)}var d,u={data:function(){return{from:"",alias:!0}},commands:{validateDomain:a("./src/js/api/commands/validation/index.js").validateDomain},methods:{createDomainPointer:(d=(0,r.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.$p6e.toA(this.from))!==this.from&&this.$notifications.info({title:this.$gettext("Source domain name punycoded"),content:this.$gettext("Source domain name has been automatically converted to punycode format. Punycode is used to encode internationalized domain names (IDN) by converting Unicode characters to ASCII.")}),e.next=4,i.createPointer({from:t,alias:this.alias});case 4:e.sent&&(this.$reset(),this.$emit("create"));case 6:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})}};t.Z=u},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/domain-pointers.vue?vue&type=script&lang=js&":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.array.iterator.js"),a("./node_modules/core-js/modules/es.object.to-string.js"),a("./node_modules/core-js/modules/es.string.iterator.js"),a("./node_modules/core-js/modules/es.weak-map.js"),a("./node_modules/core-js/modules/web.dom-collections.iterator.js"),a("./node_modules/core-js/modules/es.object.define-property.js"),a("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=a("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var a=i(t);if(a&&a.has(e))return a.get(e);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var l=s?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(o,r,l):o[r]=e[r]}o.default=e,a&&a.set(e,o);return o}(a("./src/js/api/commands/user/domain-pointers.ts")),r=o(a("./src/js/pages/user/_components/create-domain-pointer-dialog.vue"));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(i=function(e){return e?a:t})(e)}var l={preload:s.getPointers,components:{CreateDomainPointerDialog:r.default},commands:s,api:[{command:s.getPointers,bind:"pointers"}],data:function(){return{select:[]}},computed:{dnsControl:function(){return this.$_flags["user.dnsControl"]},limit:function(){return this.$_session.usage.domainPointers.limit},pointersCount:function(){return this.$api.pointers.rowsCount}},watch:{$domain:function(){s.getPointers()}},methods:{submitCommand:function(e){e({select:this.select}).then(this.$reloadApiTable)},deletePointers:function(){this.submitCommand(s.deletePointers)},setRemote:function(){this.submitCommand(s.setRemote)},setLocal:function(){this.submitCommand(s.setLocal)}}};t.Z=l},"./src/js/api/commands/validation/index.js":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.object.define-property.js");var o=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.validateUsername=t.validateSubdomain=t.validatePassword=t.validateMXValue=t.validateIPRangeList=t.validateForwarder=t.validateFTP=t.validateEmail=t.validateDomain=t.validateDatabase=t.validateDNSValue=t.validateDNSName=t.validateDBUser=void 0;var n=o(a("./src/js/api/command/index.js")),s=o(a("./node_modules/punycode/punycode.es6.js")),r=o(a("./src/js/api/commands/validation/$processors.ts")),i=n.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:n.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:r.default.isValid,message:r.default.getMessage}}),l=i.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});t.validateForwarder=l;var d=i.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});t.validateEmail=d;var u=i.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});t.validateFTP=u;var c=i.extend({params:{type:"dns"},domain:!0,schema:{record:n.default.REQUIRED_STRING}}),m=c.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:n.default.REQUIRED_STRING}});t.validateDNSValue=m;var p=m.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(e){return{value:"10",mx_value:e.value}}});t.validateMXValue=p;var v=c.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:n.default.REQUIRED_STRING,value:null}});t.validateDNSName=v;var f=i.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});t.validateDatabase=f;var _=i.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});t.validateDBUser=_;var b=i.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});t.validateUsername=b;var j=i.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});t.validateSubdomain=j;var g=i.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});t.validatePassword=g;var D=i.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(e){var t=e.value;return{value:s.default.toASCII(t)}}});t.validateDomain=D;var y=i.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});t.validateIPRangeList=y},"./src/js/api/commands/user/domain-pointers.ts":function(e,t,a){"use strict";a.r(t),a.d(t,{getAppPointers:function(){return r},getPointers:function(){return i},createPointer:function(){return l},deletePointers:function(){return d},setLocal:function(){return u},setRemote:function(){return c}});var o=a("./src/js/api/command/index.js"),n=a("./node_modules/ramda/es/index.js"),s=a("./src/js/api/commands/converters/index.ts"),r=n.pipe(n.prop("domain_pointers"),(0,s.toTable)((function(e){return{domain_pointer:e.domain_pointer,type:e.type,mail:"yes"===e.local_mail?"local":"remote"}}))),i=o.default.get({id:"DOMAIN_POINTERS",url:"/CMD_DOMAIN_POINTER",domain:!0,pagination:!0,mapResponse:r}),l=o.default.post({url:"/CMD_DOMAIN_POINTER",params:{action:"add"},domain:!0,schema:{from:o.default.REQUIRED_STRING,alias:o.default.REQUIRED_BOOL}}),d=o.default.select({url:"/CMD_DOMAIN_POINTER",params:{action:"delete"},domain:!0}),u=d.extend({params:{local_mail:!0}}),c=d.extend({params:{remote_mail:!0}})},"./src/js/api/commands/validation/$processors.ts":function(e,t,a){"use strict";a.r(t);var o=a("./src/js/api/commands/converters/index.ts");t.default={isValid:function(e){return void 0===e.error},getMessage:function(e){return(0,o.toAppHtml)(e.error||"")}}},"./src/js/pages/user/_components/create-domain-pointer-dialog.vue":function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return o.X},default:function(){return s}});var o=a("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/_components/create-domain-pointer-dialog.vue?vue&type=script&lang=js&"),n=o.Z,s=(0,a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ui-dialog",{attrs:{id:"CREATE_DOMAIN_POINTER_DIALOG",theme:"safe"}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Add New Domain Pointer\n    ")]),e._v(" "),a("template",{slot:"content"},[a("ui-form-element",{attrs:{group:"domainPointer",validators:{required:!0,api:e.$commands.validateDomain},vertical:""}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Source Domain\n            ")]),e._v(" "),a("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[e._v("\n                eg. sourcedomain.com\n            ")]),e._v(" "),a("input-text",{attrs:{slot:"content",prefix:"http://www."},slot:"content",model:{value:e.from,callback:function(t){e.from=t},expression:"from"}})],1),e._v(" "),a("ui-form-element",{attrs:{vertical:""}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Target Domain\n            ")]),e._v(" "),a("input-text",{attrs:{slot:"content",disabled:"",value:e.$domainUnicode},slot:"content"})],1),e._v(" "),a("ui-form-element",{attrs:{vertical:""}},[a("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.alias,callback:function(t){e.alias=t},expression:"alias"}},[a("translate",[e._v("Create as an Alias")])],1)],1)],1),e._v(" "),a("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"domainPointer"},on:{click:e.createDomainPointer},slot:"buttons"},[a("translate",[e._v("Create")])],1)],2)}),[],!1,null,null,null).exports},"./src/js/pages/user/domain-pointers.vue":function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return o.X},default:function(){return d}});var o=a("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/domain-pointers.vue?vue&type=script&lang=js&"),n=o.Z,s=a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),r=a("./src/js/pages/user/domain-pointers.vue?vue&type=custom&index=0&blockType=route"),i=a.n(r),l=(0,s.Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-page",{attrs:{actions:e.pointersCount<e.limit?[{handler:e.$dialog("CREATE_DOMAIN_POINTER_DIALOG").open,label:e.$gettext("Create Domain Pointer"),icon:"#plus-fill"}]:[]}},[a("template",{slot:"details"},[a("ui-infobar-item",{attrs:{title:e.$gettext("Details")}},[a("ui-infobar-stats",e._b({},"ui-infobar-stats",{title:e.$gettext("Pointers"),usage:e.pointersCount,limit:e.limit},!1))],1)],1),e._v(" "),a("ui-limited-button",{attrs:{slot:"header:buttons",theme:"safe",usage:e.pointersCount,limit:e.$_session.usage.domainPointers.limit},on:{click:function(t){e.$dialog("CREATE_DOMAIN_POINTER_DIALOG").open()}},slot:"header:buttons"},[a("translate",[e._v("Create Domain Pointer")]),e._v(" "),a("translate",{attrs:{slot:"limitText"},slot:"limitText"},[e._v("Pointers limit reached")])],1),e._v(" "),a("app-page-section",[a("ui-api-table",e._b({ref:"table",attrs:{editable:!1,"vertical-layout":e.$_Client.isPhone},on:{"action:del":function(t){e.$dialog("DELETE_DOMAIN_POINTERS").open()},"action:setLocal":e.setLocal,"action:setRemote":e.setRemote},scopedSlots:e._u([{key:"col:type",fn:function(t){var o=t.type;return a("ui-badge",{attrs:{theme:"primary",size:"small"}},[e._v("\n                "+e._s("alias"===o?e.$gettext("Alias"):e.$gettext("Pointer"))+"\n            ")])}},{key:"col:mail",fn:function(t){var a=t.mail;return[e._v("\n                "+e._s("local"===a?e.$gettext("Yes"):e.$gettext("No"))+"\n            ")]}},{key:"col:dns",fn:function(t){var o=t.domain_pointer;return e.dnsControl?a("ui-link",{attrs:{name:"user/dns",query:{pointer:o}}},[e._v("\n                "+e._s("user"===e.$state.app.user.level?e.$gettext("View"):e.$gettext("Manage"))+"\n            ")]):e._e()}}],null,!0),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getPointers,rowID:"domain_pointer",columns:{domain_pointer:{label:e.$gettext("Domain Pointer"),filter:"p6eUnicode"},type:e.$gettext("Type"),mail:e.$gettext("Local Mail"),dns:e.$gettext("DNS")},actions:{del:e.$gettext("Delete"),setLocal:e.$gettext("Set Local Mail"),setRemote:e.$gettext("Set Remote Mail")}},!1))],1),e._v(" "),a("create-domain-pointer-dialog",{on:{create:e.$reloadApiTable}}),e._v(" "),a("ui-dialog-delete-items",{attrs:{id:"DELETE_DOMAIN_POINTERS",subject:e.$ngettext("Domain Pointer","Domain Pointers",e.select.length)},on:{"click:confirm":e.deletePointers}})],2)}),[],!1,null,null,null);"function"==typeof i()&&i()(l);var d=l.exports},"./src/js/pages/user/domain-pointers.vue?vue&type=custom&index=0&blockType=route":function(){}}]);