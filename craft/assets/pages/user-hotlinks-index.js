(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[1416],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/hotlinks/index.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.symbol.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o("./node_modules/core-js/modules/es.object.define-properties.js"),o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.weak-map.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=s(o("./node_modules/@babel/runtime/regenerator/index.js")),l=s(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),i=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=s(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.array.join.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.set.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js"),o("./node_modules/core-js/modules/es.array.concat.js");var u=p(o("./src/js/api/commands/user/hotlinks.js")),d=p(o("./node_modules/ramda/src/index.js"));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(c=function(e){return e?o:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var o=c(t);if(o&&o.has(e))return o.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=r?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(s,l,i):s[l]=e[l]}return s.default=e,o&&o.set(e,s),s}function f(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?f(Object(o),!0).forEach((function(t){(0,i.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var j,b,h,_={commands:u,preload:u.getHotlinkOptions,data:function(){return{allowBlankReferer:!1,urls:[],files:"",redirectTo:"forbidden",url:"",checkedRows:[],newUrl:""}},api:[{command:u.getHotlinkOptions,bind:{"response.urls":"urls","response.options":"options"}}],computed:{select:function(){return this.checkedRows.map((function(e){return e.url}))},urlString:function(){return this.urls.map((function(e){return e.url})).join("\n")},requestData:function(){return{enabled:this.$api.options.hotlinksEnabled?"yes":"no",allow_blank_referer:this.allowBlankReferer?"yes":"no",urls:this.urlString,files:this.files,redirect:this.redirectTo,redirect_url:this.url}}},watch:{$domain:{handler:(h=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getHotlinkOptions();case 2:this.setHotlinkOptions();case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})}},created:function(){this.setHotlinkOptions()},methods:{loadOptions:(b=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getHotlinkOptions();case 2:this.urls=d.clone(this.$api.urls);case 3:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),deleteUrls:(j=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.deleteHotlinkUrls({select:this.select}).then(this.loadOptions);case 2:this.checkedRows=[];case 3:case"end":return e.stop()}}),e,this)}))),function(){return j.apply(this,arguments)}),changeHotlinksStatus:function(e){u.saveOptions(m(m({},this.requestData),{},{enabled:e?"yes":"no"})).then(this.loadOptions)},saveOptions:function(){u.saveOptions(this.requestData).then(this.loadOptions)},setHotlinkOptions:function(){this.urls=d.clone(this.$api.urls),this.files=this.$api.options.files.join(","),this.allowBlankReferer=this.$api.options.hotlinkAllowBlankReferer,this.url=this.$api.options.url,this.redirectTo=this.$api.options.redirectTo},addMyDomains:function(){var e=(0,l.default)(new Set([].concat((0,l.default)(this.urls.map((function(e){return e.url}))),(0,l.default)(this.$api.options.domains)))).join("\n");u.saveOptions(m(m({},this.requestData),{},{urls:e})).then(this.loadOptions)},addUrl:function(){this.urls.push({url:this.newUrl}),this.newUrl="",this.saveOptions()}}};t.Z=_},"./src/js/api/commands/user/hotlinks.js":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.symbol.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o("./node_modules/core-js/modules/es.object.define-properties.js"),o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/es.weak-map.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"__esModule",{value:!0}),t.saveOptions=t.getHotlinkOptions=t.deleteHotlinkUrls=void 0;var r=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js"));o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.array.includes.js");var l=s(o("./src/js/api/command/index.js")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var o=a(t);if(o&&o.has(e))return o.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=r?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(s,l,i):s[l]=e[l]}s.default=e,o&&o.set(e,s);return s}(o("./node_modules/ramda/src/index.js"));o("./src/js/api/commands/converters/index.ts");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(a=function(e){return e?o:t})(e)}function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(Object(o),!0).forEach((function(t){(0,r.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var c=l.default.get({id:"HOTLINK_OPTIONS",url:"/CMD_HOTLINK",params:{ipp:99999,page:1},domain:!0,mapResponse:{urls:i.pipe(i.prop("data"),i.omit("info"),i.values,i.filter(i.pipe(i.prop("url"),Boolean))),options:function(e){var t=e.options,o=function(e){return"checked"===t[e]};return{domains:e.options.MY_DOMAINS_LIST.split("\\n").filter(Boolean),hotlinkAllowBlankReferer:o("HOTLINK_ALLOW_BLANK_REFERER_CHECKED"),hotlinksEnabled:o("HOTLINK_ENALBED_CHECKED"),files:t.HOTLINK_PROTECT_FILES.split(","),redirectToForbidden:o("REDIRECT_TO_FORBIDDEN"),redirectToUrl:o("REDIRECT_TO_URL_CHECKED"),redirectTo:o("REDIRECT_TO_FORBIDDEN_CHECKED")?"forbidden":"url",url:t.REDIRECT_URL}}}});t.getHotlinkOptions=c;var p=l.default.select({url:"/CMD_HOTLINK",params:{action:"multiple",delete:!0},domain:!0});t.deleteHotlinkUrls=p;var f=l.default.post({url:"/CMD_HOTLINK",params:{action:"save"},domain:!0,schema:{enabled:d(d({},l.default.REQUIRED_STRING),{},{validator:function(e){return["yes","no"].includes(e)}}),allow_blank_referer:d(d({},l.default.REQUIRED_STRING),{},{validator:function(e){return["yes","no"].includes(e)}}),urls:l.default.REQUIRED_STRING,files:l.default.REQUIRED_STRING,redirect:d(d({},l.default.REQUIRED_STRING),{},{validator:function(e){return["forbidden","url"].includes(e)}}),redirect_url:l.default.OPTIONAL_STRING}});t.saveOptions=f},"./node_modules/core-js/modules/es.set.js":function(e,t,o){"use strict";o("./node_modules/core-js/internals/collection.js")("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),o("./node_modules/core-js/internals/collection-strong.js"))},"./src/js/pages/user/hotlinks/index.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return s.X},default:function(){return u}});var s=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/hotlinks/index.vue?vue&type=script&lang=js&"),n=s.Z,r=o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),l=o("./src/js/pages/user/hotlinks/index.vue?vue&type=custom&index=0&blockType=route"),i=o.n(l),a=(0,r.Z)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page",{attrs:{actions:[{label:e.$gettext("Enable Hotlinks Protection"),handler:function(){return e.changeHotlinksStatus(!0)},icon:"#settings",visible:!1===e.$api.options.hotlinksEnabled},{label:e.$gettext("Disable Hotlinks Protection"),handler:function(){return e.changeHotlinksStatus(!0)},icon:"#settings",visible:!0===e.$api.options.hotlinksEnabled},{label:e.$gettext("Add My Domains"),handler:e.addMyDomains,icon:"#plus-fill",visible:!0===e.$api.options.hotlinksEnabled}]}},[o("template",{slot:"header:buttons"},[e.$api.options.hotlinksEnabled?o("ui-button",{attrs:{theme:"danger",size:"big"},on:{click:function(t){return e.changeHotlinksStatus(!1)}}},[o("translate",[e._v("Disable Hotlinks Protection")])],1):o("ui-button",{key:"enableHotlinks",attrs:{theme:"safe",size:"big"},on:{click:function(t){return e.changeHotlinksStatus(!0)}}},[o("translate",[e._v("Enable Hotlinks Protection")])],1),e._v(" "),e.$api.options.hotlinksEnabled?o("ui-button",{attrs:{size:"big",theme:"primary"},on:{click:e.addMyDomains}},[o("translate",[e._v("Add My Domains")])],1):e._e()],1),e._v(" "),o("app-page-section",[o("ui-r-table",{attrs:{rows:e.urls,columns:[{id:"url",label:e.$gettext("URL")}],"is-sortable":"","is-checkable":"","disable-pagination":"","checked-rows":e.checkedRows,"vertical-layout":e.$_Client.isPhone},on:{"update:checkedRows":function(t){e.checkedRows=t},"update:checked-rows":function(t){e.checkedRows=t}}},[o("ui-table-action",{attrs:{slot:"table:actions"},on:{click:e.deleteUrls},slot:"table:actions"},[o("translate",[e._v("Delete")])],1)],1),e._v(" "),o("ui-input-group",{staticClass:"width:100%"},[o("input-text",{attrs:{slot:"input"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUrl.apply(null,arguments)}},slot:"input",model:{value:e.newUrl,callback:function(t){e.newUrl=t},expression:"newUrl"}}),e._v(" "),o("ui-button",{attrs:{slot:"additions:right",size:"normal",theme:"safe",disabled:!e.newUrl||"url"===e.redirectTo&&!e.url},on:{click:e.addUrl},slot:"additions:right"},[o("translate",[e._v("Add")])],1)],1),e._v(" "),o("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Protected file types\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.files,callback:function(t){e.files=t},expression:"files"}})],1),e._v(" "),o("ui-form-element",[o("span",{attrs:{slot:"title"},slot:"title"}),e._v(" "),o("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.allowBlankReferer,callback:function(t){e.allowBlankReferer=t},expression:"allowBlankReferer"}},[o("translate",[e._v("Allow Blank Referrer")])],1)],1),e._v(" "),o("ui-form-element",[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Redirect to\n            ")]),e._v(" "),o("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center"},expression:"{\n                    cross: 'center'\n                }"}],attrs:{slot:"content"},slot:"content"},[o("input-radio",{attrs:{value:"forbidden"},model:{value:e.redirectTo,callback:function(t){e.redirectTo=t},expression:"redirectTo"}},[o("translate",[e._v("403 Forbidden")])],1),e._v(" "),o("input-radio",{directives:[{name:"margin",rawName:"v-margin",value:[,,,1],expression:"[,,,1]"}],attrs:{value:"url"},model:{value:e.redirectTo,callback:function(t){e.redirectTo=t},expression:"redirectTo"}},[o("translate",[e._v("URL")])],1)],1)],1),e._v(" "),o("transition",{attrs:{name:"fade"}},["url"===e.redirectTo?o("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Redirect URL\n                ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1):e._e()],1),e._v(" "),o("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"hotlinkOptions"},on:{click:e.saveOptions},slot:"footer:buttons"},[o("translate",[e._v("Save")])],1)],1)],2)}),[],!1,null,null,null);"function"==typeof i()&&i()(a);var u=a.exports},"./src/js/pages/user/hotlinks/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);