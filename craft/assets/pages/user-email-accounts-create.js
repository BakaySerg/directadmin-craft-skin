(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[9451],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/email/accounts/create.vue?vue&type=script&lang=js&":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.object.define-property.js");var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var i=s(a("./node_modules/@babel/runtime/regenerator/index.js")),o=s(a("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));a("./node_modules/core-js/modules/es.number.constructor.js"),a("./node_modules/core-js/modules/es.array.concat.js");var n,r=a("./src/js/api/commands/user/email/accounts/index.js"),l=a("./src/js/api/commands/validation/index.js"),u={preload:r.getAccounts,commands:{validateEmail:l.validateEmail,validatePassword:l.validatePassword},api:[{command:r.getAccounts,bind:{"response.options.user_can_set_email_limit":"setLimit","response.options.GLOBAL_PER_EMAIL_LIMIT":"globalSendLimit","response.options.DEFAULT_POP_QUOTA":"defaultQuota","response.options.MAX_PER_EMAIL_SEND_LIMIT":"maxPerEmailSendLimit","response.options.user_email_quota_max":"emailQuotaMax"}},{command:l.validateEmail,bind:"emailValidation"}],data:function(){return{user:"",password:"",quota:0,limit:"",quotaUnlimited:!1,limitUnlimited:!0}},computed:{maxLimit:function(){return"-1"===this.$api.maxPerEmailSendLimit?this.$api.globalSendLimit:this.$api.maxPerEmailSendLimit},canSetUnlimited:function(){return"0"===this.maxLimit},showUnlimitedQuotaCheckbox:function(){return"0"===this.$api.emailQuotaMax||"-1"===this.$api.emailQuotaMax||void 0===this.$api.emailQuotaMax}},created:function(){this.quota=this.$api.defaultQuota,this.quotaUnlimited="0"===this.quota,this.limitUnlimited="0"===this.maxLimit},methods:{createAccount:function(){var e=this;(0,r.createAccount)({user:this.user,passwd:this.password,passwd2:this.password,quota:this.quota,limit:this.$api.setLimit?this.limit||this.maxLimit:null}).then((function(){return e.$router.back()}))},validateLimit:function(e){return"0"===this.maxLimit||Number(e||0)<=Number(this.maxLimit)},validateUser:(n=(0,o.default)(i.default.mark((function e(t){var a,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,(0,l.validateEmail)({value:"".concat(t,"@").concat(this.$domain)});case 4:return a=e.sent,s=a.valid,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)}),toggleLimit:function(){this.limitUnlimited=!this.limitUnlimited,this.limit=this.limitUnlimited?"0":""},toggleQuota:function(){this.quotaUnlimited=!this.quotaUnlimited,this.quota=this.quotaUnlimited?"0":this.$api.defaultQuota},validateQuota:function(e){return Number(e)<=100*Math.pow(2,20)}}};t.Z=u},"./src/js/api/commands/user/email/accounts/index.js":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.object.define-property.js");var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.webmailSSO=t.unsuspendAccounts=t.suspendAccounts=t.purgeAccounts=t.modifyAccount=t.getLoginsList=t.getAccounts=t.deleteAccounts=t.createAccount=t.changePassword=t.changeDKIMStatus=t.$processors=void 0;var i=s(a("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=s(a("./node_modules/@babel/runtime/helpers/typeof.js"));a("./node_modules/core-js/modules/es.array.filter.js"),a("./node_modules/core-js/modules/es.object.to-string.js"),a("./node_modules/core-js/modules/es.array.map.js"),a("./node_modules/core-js/modules/es.number.constructor.js"),a("./node_modules/core-js/modules/es.number.is-finite.js"),a("./node_modules/core-js/modules/es.array.flat-map.js"),a("./node_modules/core-js/modules/es.array.unscopables.flat-map.js"),a("./node_modules/core-js/modules/es.array.includes.js"),a("./node_modules/core-js/modules/es.string.includes.js"),a("./node_modules/core-js/modules/es.regexp.exec.js"),a("./node_modules/core-js/modules/es.string.split.js"),a("./node_modules/core-js/modules/es.string.replace.js");var n=s(a("./src/js/api/command/index.js")),r=a("./node_modules/monet/dist/monet.js"),l=a("./src/js/api/converters.js"),u=function(e){return r.Maybe.Some(e).map(Number).filter(Number.isFinite).orSome(1/0)},d={sent:function(e){return r.Maybe.fromNull(e).filter((function(e){return"object"===(0,o.default)(e)})).flatMap((function(e){var t=e.sent,a=e.send_limit;try{return r.Maybe.Some({usage:u(t),limit:u(a)})}catch(e){return r.Maybe.None()}})).orSome(!1)},lastChange:function(e){return r.Maybe.fromNull(e).map((function(e){var t=e.ip,a=e.when;return{ip:(0,r.Identity)(t).map(l.toAppString).map(l.toAppText).get(),when:(0,r.Identity)(a).map(l.toAppDate).get()}})).orSome(!1)}};t.$processors=d;var m=n.default.get({id:"EMAIL_ACCOUNTS",url:"/CMD_EMAIL_POP",domain:!0,pagination:!0,params:{bytes:!0},after:function(e){return e.flow(e.wrap("options"),e.moveProp({"options.emails":"emails","options.EMAIL_MESSAGE":"options.email_message"}),e.mapProps({emails:e.toTable(e.mapArray(e.flow(e.moveProp({"usage.last_login":"last_login","usage.last_password_change":"last_password_change"}),e.mapProps({login:function(e){return e.includes("@")?e.split("@")[0]:e},is_default:function(e,t){return!t.login.includes("@")},sent:d.sent,usage:e.mapValues(u),last_login:d.lastChange,last_password_change:d.lastChange})))),options:e.mapProps({DKIM:e.isEqual("1"),DKIM_ENABLED:e.isEqual("1"),block_cracking_unblock:e.convert.toAppNumber,clean_forwarders_on_email_delete:e.isEqual("1"),count_pop_usage:e.isEqual("1"),hide_outlook:e.isEqual("1"),pop_disk_usage_cache:e.isEqual("1"),pop_disk_usage_true_bytes:e.isEqual("1"),user_can_set_email_limit:e.isEqual("1"),purge_select:e.toSelect,when_select:e.toSelect,HAVE_ONE_CLICK_WEBMAIL_LOGIN:e.convert.toAppBoolean,system_user_to_virtual_passwd:e.isEqual("1")})}))}});t.getAccounts=m;var c=n.default.post({url:"/CMD_EMAIL_POP",params:{action:"delete"},domain:!0}),p=c.extend({params:{suspend:!0}});t.suspendAccounts=p;var _=c.extend({params:{unsuspend:!0}});t.unsuspendAccounts=_;var v=c.extend({params:{delete:!0},schema:{clean_forwarders:n.default.REQUIRED_BOOL}});t.deleteAccounts=v;var f=c.extend({params:{purge:!0},body:{file:n.default.REQUIRED_STRING,what:n.default.REQUIRED_STRING}});t.purgeAccounts=f;var b=n.default.post({url:"/CMD_EMAIL_POP",params:{action:"create"},domain:!0,schema:{user:n.default.USER,passwd2:n.default.PASSWORD,passwd:n.default.PASSWORD,quota:n.default.REQUIRED_STRING,limit:n.default.OPTIONAL_STRING},after:function(e){return e.mapProp("result",(function(e){return e.replace(/(\\n)+/g,"\n")}))}});t.createAccount=b;var E=n.default.post({url:"/CMD_EMAIL_POP",params:{action:"modify"},domain:!0,schema:{user:n.default.USER,newuser:n.default.USER,passwd2:n.default.OPTIONAL_STRING,passwd:n.default.OPTIONAL_STRING,quota:n.default.REQUIRED_STRING,limit:n.default.OPTIONAL_STRING}});t.modifyAccount=E;var A=n.default.post({url:"/CMD_CHANGE_EMAIL_PASSWORD",schema:{email:n.default.REQUIRED_STRING,oldpassword:n.default.REQUIRED_STRING,password1:n.default.REQUIRED_STRING,password2:n.default.REQUIRED_STRING}});t.changePassword=A;var h=n.default.post({url:"/CMD_EMAIL_POP",domain:!0,schema:{action:n.default.REQUIRED_STRING},before:function(e){var t=e.action;return(0,i.default)({action:"set_dkim"},t,!0)}});t.changeDKIMStatus=h;var g=n.default.post({url:"/CMD_WEBMAIL_LOGIN",notifySuccess:!1,schema:{email:n.default.REQUIRED_STRING}});t.webmailSSO=g;var j=n.default.get({id:"LOGINS_LIST",url:"/CMD_EMAIL_POP",domain:!0,response:[],params:{quick:!0},mapResponse:function(e){return e.emails}});t.getLoginsList=j},"./src/js/api/commands/validation/index.js":function(e,t,a){"use strict";a("./node_modules/core-js/modules/es.object.define-property.js");var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.validateUsername=t.validateSubdomain=t.validatePassword=t.validateMXValue=t.validateIPRangeList=t.validateForwarder=t.validateFTP=t.validateEmail=t.validateDomain=t.validateDatabase=t.validateDNSValue=t.validateDNSName=t.validateDBUser=void 0;var i=s(a("./src/js/api/command/index.js")),o=s(a("./node_modules/punycode/punycode.es6.js")),n=s(a("./src/js/api/commands/validation/$processors.ts")),r=i.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:i.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:n.default.isValid,message:n.default.getMessage}}),l=r.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});t.validateForwarder=l;var u=r.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});t.validateEmail=u;var d=r.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});t.validateFTP=d;var m=r.extend({params:{type:"dns"},domain:!0,schema:{record:i.default.REQUIRED_STRING}}),c=m.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:i.default.REQUIRED_STRING}});t.validateDNSValue=c;var p=c.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(e){return{value:"10",mx_value:e.value}}});t.validateMXValue=p;var _=m.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:i.default.REQUIRED_STRING,value:null}});t.validateDNSName=_;var v=r.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});t.validateDatabase=v;var f=r.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});t.validateDBUser=f;var b=r.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});t.validateUsername=b;var E=r.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});t.validateSubdomain=E;var A=r.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});t.validatePassword=A;var h=r.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(e){var t=e.value;return{value:o.default.toASCII(t)}}});t.validateDomain=h;var g=r.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});t.validateIPRangeList=g},"./node_modules/core-js/internals/number-is-finite.js":function(e,t,a){var s=a("./node_modules/core-js/internals/global.js").isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&s(e)}},"./node_modules/core-js/modules/es.number.is-finite.js":function(e,t,a){a("./node_modules/core-js/internals/export.js")({target:"Number",stat:!0},{isFinite:a("./node_modules/core-js/internals/number-is-finite.js")})},"./src/js/api/commands/validation/$processors.ts":function(e,t,a){"use strict";a.r(t);var s=a("./src/js/api/commands/converters/index.ts");t.default={isValid:function(e){return void 0===e.error},getMessage:function(e){return(0,s.toAppHtml)(e.error||"")}}},"./src/js/pages/user/email/accounts/create.vue":function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return u}});var s=a("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/email/accounts/create.vue?vue&type=script&lang=js&"),i=s.Z,o=a("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),n=a("./src/js/pages/user/email/accounts/create.vue?vue&type=custom&index=0&blockType=route"),r=a.n(n),l=(0,o.Z)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-page",[a("app-page-section",[a("ui-form-element",{attrs:{group:"account",validators:{required:!0,validateUser:e.validateUser}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Username\n            ")]),e._v(" "),a("input-text",{attrs:{slot:"content",suffix:"@"+e.$domainUnicode,vertical:e.$_Client.isPhone},slot:"content",model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),e._v(" "),a("span",{attrs:{slot:"error:validateUser"},slot:"error:validateUser"},[e._v("\n                "+e._s(e.$api.emailValidation.message)+"\n            ")])],1),e._v(" "),a("ui-form-element",{attrs:{group:"account",validators:{required:!0,api:e.$commands.validatePassword}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Password\n            ")]),e._v(" "),a("input-password",{attrs:{slot:"content","show-generator":""},slot:"content",model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),a("ui-form-element",{attrs:{group:"account",validators:{required:!0,validateQuota:e.validateQuota},underline:e.$api.setLimit}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                E-mail Quota (MB)\n            ")]),e._v(" "),a("input-text",{attrs:{slot:"content",disabled:e.quotaUnlimited,number:""},slot:"content",model:{value:e.quota,callback:function(t){e.quota=t},expression:"quota"}},[e.showUnlimitedQuotaCheckbox?a("ui-button",{attrs:{slot:"additions:right"},on:{click:e.toggleQuota},slot:"additions:right"},[a("input-checkbox",{attrs:{model:e.quotaUnlimited}},[a("translate",[e._v("Max")])],1)],1):e._e()],1),e._v(" "),a("translate",{attrs:{slot:"error:validateQuota"},slot:"error:validateQuota"},[e._v("\n                Quota can't be larger than 100TB\n            ")])],1),e._v(" "),e.$api.setLimit?a("ui-form-element",{attrs:{group:"account",validators:{validateLimit:e.validateLimit},underline:!1}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Send Limit\n            ")]),e._v(" "),a("translate",{attrs:{slot:"tooltip","translate-params":{limit:e.maxLimit}},slot:"tooltip"},[e._v("\n                Blank will default to %{ limit }\n            ")]),e._v(" "),a("input-text",{attrs:{slot:"content",number:"",placeholder:e.maxLimit,disabled:e.limitUnlimited},slot:"content",model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}},[a("ui-button",{attrs:{slot:"additions:right",disabled:!e.canSetUnlimited},on:{click:e.toggleLimit},slot:"additions:right"},[a("input-checkbox",{attrs:{model:e.limitUnlimited}},[a("translate",[e._v("Max")])],1)],1)],1),e._v(" "),a("translate",{attrs:{slot:"error:validateLimit","translate-params":{limit:e.maxLimit}},slot:"error:validateLimit"},[e._v("\n                Limit can't be larger than %{ limit }\n            ")])],1):e._e()],1),e._v(" "),a("ui-button",{attrs:{slot:"footer:buttons",theme:"primary",disabled:!e.password,"validate-group":"account"},on:{click:e.createAccount},slot:"footer:buttons"},[a("translate",[e._v("Create Account")])],1)],1)}),[],!1,null,null,null);"function"==typeof r()&&r()(l);var u=l.exports},"./src/js/pages/user/email/accounts/create.vue?vue&type=custom&index=0&blockType=route":function(){}}]);