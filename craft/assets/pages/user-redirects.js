(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[1819],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/redirects.vue?vue&type=script&lang=js&":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.weak-map.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),s=r("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,r("./node_modules/core-js/modules/es.regexp.constructor.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.regexp.to-string.js"),r("./node_modules/core-js/modules/es.string.starts-with.js");var n=o(r("./node_modules/@babel/runtime/regenerator/index.js")),a=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=n?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=e[a]}o.default=e,r&&r.set(e,o);return o}(r("./src/js/api/commands/user/redirects.js"));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}var d,c={preload:l.getRedirects,commands:l,data:function(){return{select:[],create:{from:"/",type:"301",to:"http://"}}},watch:{$domain:"$reloadApiTable"},methods:{createRedirect:function(){l.createRedirect(this.create).then(this.$reloadApiTable)},deleteRedirects:(d=(0,a.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.deleteRedirects(this.$get("select")).then(this.$reloadApiTable);case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),isURL:function(e){if(!e)return!0;var t=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i");return e.length<2083&&t.test(e)},validateFrom:function(e){return!e||e.startsWith("/")}}};t.Z=c},"./src/js/api/commands/user/redirects.js":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.object.define-property.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getRedirects=t.deleteRedirects=t.createRedirect=void 0,r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.promise.js");var s=o(r("./src/js/api/command/index.js")),n="/CMD_REDIRECT",a=s.default.get({id:"REDIRECTS",url:n,domain:!0,pagination:!0,after:function(e){return e.flow(e.processTableInfo("redirects"),e.moveProp("redirects","rows"),e.mapProps({rows:e.toArray}))}});t.getRedirects=a;var l=s.default.post({url:n,params:{action:"add"},domain:!0,schema:{from:s.default.REQUIRED_STRING,type:s.default.REQUIRED_STRING,to:s.default.REQUIRED_STRING}});t.createRedirect=l;var i=s.default.select({url:n,domain:!0,params:{action:"delete"}});t.deleteRedirects=i},"./src/js/pages/user/redirects.vue":function(e,t,r){"use strict";r.r(t),r.d(t,{__esModule:function(){return o.X},default:function(){return d}});var o=r("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/redirects.vue?vue&type=script&lang=js&"),s=o.Z,n=r("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=r("./src/js/pages/user/redirects.vue?vue&type=custom&index=0&blockType=route"),l=r.n(a),i=(0,n.Z)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("app-page",{attrs:{actions:[{handler:e.$dialog("CREATE_REDIRECT_DIALOG").open,label:e.$gettext("Create New Redirect"),icon:"#plus-fill"}]}},[r("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(t){e.$dialog("CREATE_REDIRECT_DIALOG").open()}},slot:"header:buttons"},[r("translate",[e._v("Create New Redirect")])],1),e._v(" "),r("app-page-section",[r("ui-api-table",e._b({on:{"action:del":function(t){e.$dialog("DELETE_REDIRECTS_DIALOG").open()}},scopedSlots:e._u([{key:"col:local_url_path",fn:function(t){var o=t.local_url_path;return r("ui-link",{attrs:{href:"//"+e.$domain+o}},[e._v("\n                "+e._s(o)+"\n            ")])}},{key:"col:redirect_url",fn:function(t){var o=t.redirect_url;return r("ui-link",{attrs:{href:o}},[e._v("\n                "+e._s(o)+"\n            ")])}},{key:"col:type",fn:function(t){var o=t.type;return r("span",{key:o},["301"===o?r("translate",[e._v("\n                    301 — Permanent\n                ")]):"302"===o?r("translate",[e._v("\n                    302 — Temporary\n                ")]):"303"===o?r("translate",[e._v("\n                    303 — Replaced\n                ")]):e._e()],1)}}]),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getRedirects,rowID:"local_url_path",columns:{local_url_path:e.$gettext("Local URL Path"),type:e.$gettext("Type"),redirect_url:e.$gettext("Redirect URL")},actions:{del:e.$gettext("Delete")},editable:!1,verticalLayout:e.$_Client.isPhone},!1))],1),e._v(" "),r("ui-dialog",{attrs:{id:"CREATE_REDIRECT_DIALOG",theme:"safe",size:"normal"}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Add New Redirect\n        ")]),e._v(" "),r("template",{slot:"content"},[r("ui-form-element",{attrs:{group:"redirect",validators:{required:!0,validateFrom:e.validateFrom},vertical:e.$_Client.isPhone}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Local URL Path\n                ")]),e._v(" "),r("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[e._v('\n                    e.g. "/redirect", "/"\n                ')]),e._v(" "),r("input-text",{attrs:{slot:"content",prefix:e.$domainUnicode},slot:"content",model:{value:e.create.from,callback:function(t){e.$set(e.create,"from",t)},expression:"create.from"}}),e._v(" "),r("translate",{attrs:{slot:"error:validateFrom"},slot:"error:validateFrom"},[e._v('\n                    Should start with a forward flash "/"\n                ')])],1),e._v(" "),r("ui-form-element",{attrs:{vertical:e.$_Client.isPhone}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Redirect Type\n                ")]),e._v(" "),r("input-select",{attrs:{slot:"content",options:{301:e.$gettext("301 — Permanent"),302:e.$gettext("302 — Temporary"),303:e.$gettext("303 — Replaced")},width:"46.3rem"},slot:"content",model:{value:e.create.type,callback:function(t){e.$set(e.create,"type",t)},expression:"create.type"}})],1),e._v(" "),r("ui-form-element",{attrs:{group:"redirect",validators:{required:!0,isURL:e.isURL},vertical:e.$_Client.isPhone}},[r("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Destination URL\n                ")]),e._v(" "),r("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[e._v('\n                    e.g. "http://www.redirected.com"\n                ')]),e._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.create.to,callback:function(t){e.$set(e.create,"to",t)},expression:"create.to"}}),e._v(" "),r("translate",{attrs:{slot:"error:isURL"},slot:"error:isURL"},[e._v("\n                    Should be valid URL\n                ")])],1)],1),e._v(" "),r("ui-button",{attrs:{slot:"buttons",theme:"primary","validate-group":"redirect"},on:{click:e.createRedirect},slot:"buttons"},[r("translate",[e._v("Create")])],1)],2),e._v(" "),r("ui-dialog-delete-items",{attrs:{id:"DELETE_REDIRECTS_DIALOG",subject:e.$ngettext("Redirect","Redirects",e.select.length)},on:{"click:confirm":e.deleteRedirects}})],1)}),[],!1,null,null,null);"function"==typeof l()&&l()(i);var d=i.exports},"./src/js/pages/user/redirects.vue?vue&type=custom&index=0&blockType=route":function(){}}]);