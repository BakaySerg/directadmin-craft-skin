(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[1942],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=script&lang=js&":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"X",{value:!0}),s.Z=void 0,t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js");var o=t("./node_modules/vue-codemirror/dist/vue-codemirror.js");t("./node_modules/codemirror/mode/javascript/javascript.js"),t("./node_modules/codemirror/mode/htmlmixed/htmlmixed.js"),t("./node_modules/codemirror/mode/css/css.js"),t("./node_modules/codemirror/mode/php/php.js"),t("./node_modules/codemirror/mode/perl/perl.js"),t("./node_modules/codemirror/mode/properties/properties.js"),t("./node_modules/codemirror/mode/xml/xml.js"),t("./node_modules/codemirror/mode/sql/sql.js");t("./src/js/modules/utils/index.js");var n,r=t("./src/js/vue/mixins/local/inputValidation.js"),l=t("./src/js/vue/helpers.js"),a=["text","html","javascript","css","php","perl","ini","xml","sql","mysql","json"],i={components:{codemirror:o.codemirror},mixins:[r.$inputValidation],validate:"value",props:{value:{type:String,required:!0,default:""},readOnly:{type:Boolean,required:!1,default:!1},mode:{type:String,required:!1,default:"text",validator:(n=a,function(e){return n.includes(e)})},disableModes:{type:Boolean,required:!1,default:!1},disableThemes:{type:Boolean,required:!1,default:!1}},data:function(){return{editorMode:this.mode}},staticData:{modes:a,themes:["default","base16-light","base16-dark","monokai","solarized"]},computed:{theme:(0,l.options)("code-editor/theme"),cmMode:function(){switch(this.editorMode){case"json":return{name:"javascript",json:!0};case"mysql":return"sql";case"ini":return"properties";default:return this.editorMode}}}};s.Z=i},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=script&lang=js&":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.symbol.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),t("./node_modules/core-js/modules/es.object.define-properties.js"),t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.weak-map.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=t("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(s,"X",{value:!0}),s.Z=void 0;var r=o(t("./node_modules/@babel/runtime/regenerator/index.js"));t("./node_modules/core-js/modules/es.string.starts-with.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.object.keys.js"),t("./node_modules/core-js/modules/es.regexp.flags.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.array.iterator.js"),t("./node_modules/core-js/modules/es.set.js"),t("./node_modules/core-js/modules/es.string.iterator.js"),t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.string.match.js");var l=o(t("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),a=o(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=o(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=function(e,s){if(!s&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=m(s);if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var a=r?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(o,l,a):o[l]=e[l]}o.default=e,t&&t.set(e,o);return o}(t("./src/js/api/commands/user/mod-security.js")),u=o(t("./src/js/components/local/inputs/input-text-editor.vue")),c=t("./src/js/store/index.js");function m(e){if("function"!=typeof WeakMap)return null;var s=new WeakMap,t=new WeakMap;return(m=function(e){return e?t:s})(e)}function p(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);s&&(o=o.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,o)}return t}var f,j,_,v,b,g,h={beforeRouteEnter:(g=(0,i.default)(r.default.mark((function e(s,t,o){var n,l,a,i,u;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.path.startsWith("/admin/")?null:(0,c.State)("app.domain"),l=s.params,a=l.domainProp,i=l.subdomainProp,u={domain:a||n,subdomain:i||null},e.next=5,d.getModSecurity(u);case 5:d.getLog(u),o();case 7:case"end":return e.stop()}}),e)}))),function(e,s,t){return g.apply(this,arguments)}),api:[{command:d.getModSecurity,bind:"data"},{command:d.getLog,bind:"log"},{command:d.searchDomains,bind:"domains"}],components:{InputTextEditor:u.default},props:{domainProp:{type:String,required:!1,default:function(){return this.$domain}},subdomainProp:{type:String,required:!1,default:""}},data:function(){return{flags:{rule:"On"},ids:[],newId:"",select:[],message:"",domain:this.domainProp,fullLog:!1,lines:"100",maxTime:"10",subdomain:this.subdomainProp}},computed:{userLevel:function(){return this.$route.path.startsWith("/user/")},domainParam:function(){return this.userLevel?this.$domain:this.$api.domains.includes(this.domain)?this.domain:null},subdomainParam:function(){return this.domainParam&&this.subdomain||null},log:function(){return this.$api.log.lines.map(this.getLogData)},logLoading:function(){return this.$state.commands.MODSECURITY_LOG.isLoading},haveSubdomains:function(){return Object.keys(this.$api.data.subdomain_select.options).length>0},subdomainOptions:function(){return function(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?p(Object(t),!0).forEach((function(s){(0,a.default)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}({"":this.$gettext("Main Domain...")},this.$api.data.subdomain_select.options)}},watch:{domainParam:"loadData",subdomainParam:"loadData"},created:function(){this.flags.rule=this.$api.data.flags.SecRuleEngine,this.ids=this.$api.data.SecRuleRemoveById.map((function(e){return{id:e}}))},methods:{loadLog:(b=(0,i.default)(r.default.mark((function e(){var s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getLog({domain:this.domainParam,subdomain:this.subdomainParam,lines:this.fullLog?null:this.lines||"2000",max_time:this.maxTime});case 2:return(s=e.sent).summary.aborted&&this.$notifications.error({title:"Timeout",content:this.$gettextInterpolate(this.$gettext("Loading was aborted due to %{ time }s timeout. <br/>%{returned} lines was returned of %{ requested } requested"),s.summary),extended:!0}),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),loadData:(v=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadLog(),e.next=3,d.getModSecurity({domain:this.domainParam,subdomain:this.subdomainParam});case 3:this.flags.rule=this.$api.data.flags.SecRuleEngine,this.ids=this.$api.data.SecRuleRemoveById.map((function(e){return{id:e}}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),showMessage:function(e){this.message=JSON.stringify(e,null,2),this.$dialog("MODSECURITY_MESSAGE_DIALOG").open()},addRule:(_=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.newId){e.next=8;break}return e.next=3,d.addSkip({id:this.newId,domain:this.domainParam,subdomain:this.subdomainParam});case 3:if(!(e.sent instanceof Error)){e.next=6;break}return e.abrupt("return");case 6:this.ids.push({id:this.newId}),this.newId="";case 8:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)}),removeRules:(j=(0,i.default)(r.default.mark((function e(){var s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.select.map((function(e){return e.id})),e.next=3,d.removeSkip({select:s,domain:this.domainParam,subdomain:this.subdomainParam});case 3:if(!(e.sent instanceof Error)){e.next=6;break}return e.abrupt("return");case 6:this.ids=this.ids.filter((function(e){var t=e.id;return!s.includes(t)})),this.select=[];case 8:case"end":return e.stop()}}),e,this)}))),function(){return j.apply(this,arguments)}),saveFlags:function(){d.saveFlags({SecRuleEngine:this.flags.rule,domain:this.domainParam,subdomain:this.subdomainParam})},getLogData:function(e){if(void 0===e.audit_data){var s=e.transaction.messages.map((function(e){return{message:e.message,rule:e.details.ruleId}}));return{item:e,time:e.transaction.time_stamp,host:e.transaction.request.headers.host||e.transaction.request.headers.Host,uri:e.transaction.request.uri,ip:e.transaction.client_ip,messages:s,rules:(0,l.default)(new Set(s.map((function(e){return e.rule})).filter(Boolean)))}}var t=e.audit_data.messages.map((function(e){var s=e.match(/.*\[id "(\d*)".*$/);return s?{message:e,rule:s.pop()}:{message:e,rule:""}}));return{item:e,time:e.transaction.time,host:e.request.headers.Host,uri:e.request.request_line,ip:e.transaction.remote_address,messages:t,rules:(0,l.default)(new Set(t.map((function(e){return e.rule})).filter(Boolean)))}},skipRule:(f=(0,i.default)(r.default.mark((function e(s){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.addSkip({id:String(s),domain:this.domainParam,subdomain:this.subdomainParam});case 2:if(!(e.sent instanceof Error)){e.next=5;break}return e.abrupt("return");case 5:this.ids.push({id:s});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)}),searchDomains:function(){d.searchDomains({search:this.domain})}}};s.Z=h},"./src/js/api/commands/user/mod-security.js":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.object.keys.js"),t("./node_modules/core-js/modules/es.symbol.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),t("./node_modules/core-js/modules/es.object.define-properties.js"),t("./node_modules/core-js/modules/es.object.define-property.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.searchDomains=s.saveFlags=s.removeSkip=s.getModSecurity=s.getLog=s.addSkip=void 0,t("./node_modules/core-js/modules/es.object.values.js");var n=o(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),r=o(t("./src/js/api/command/index.js"));function l(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);s&&(o=o.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?l(Object(t),!0).forEach((function(s){(0,n.default)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}var i="/CMD_MODSECURITY",d=r.default.get({url:i,id:"MOD_SECURITY",domain:!0,after:function(e){return e.mapProp("subdomain_select",e.toSelect)}});s.getModSecurity=d;var u=r.default.post({url:i,domain:!0,schema:{id:r.default.REQUIRED_STRING},before:function(e){return{id:null,SecRuleRemoveById:e.id,add:!0,action:"select"}}});s.addSkip=u;var c=r.default.select({url:i,domain:!0,params:{delete:!0,action:"select"}});s.removeSkip=c;var m=r.default.post({url:i,params:{action:"save"},domain:!0,schema:{SecRuleEngine:r.default.REQUIRED_STRING,SecRuleRemoveById:r.default.OPTIONAL_STRING}});s.saveFlags=m;var p=r.default.get({url:i,id:"MODSECURITY_LOG",params:{action:"log",lines:"100"},schema:{domain:r.default.OPTIONAL_STRING,max_time:a(a({},r.default.OPTIONAL_STRING),{},{default:"15"})},response:[],mapResponse:{lines:function(e){return Object.values(e.logs)},summary:function(e){var s=e.summary;return{time:s.max_time,returned:s.returned_lines,requested:s.requested_lines,aborted:"yes"===s.time_abort}}}});s.getLog=p;var f=r.default.get({id:"SEARCH_DOMAINS",url:"/CMD_AJAX_SEARCH",schema:{search:r.default.REQUIRED_STRING},params:{search_domains:"1",search_users:"0",search_resellers:"0",search_admins:"0",search_email:"0",search_ftp:"0",search_db:"0"},response:[],mapResponse:function(e){return Object.values(e.domains||{})}});s.searchDomains=f},"./node_modules/core-js/modules/es.set.js":function(e,s,t){"use strict";t("./node_modules/core-js/internals/collection.js")("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),t("./node_modules/core-js/internals/collection-strong.js"))},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=style&index=0&lang=scss&":function(){},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=style&index=0&lang=scss&":function(){},"./src/js/components/local/inputs/input-text-editor.vue":function(e,s,t){"use strict";t.r(s),t.d(s,{__esModule:function(){return o.X},default:function(){return r}});var o=t("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=script&lang=js&"),n=o.Z,r=(t("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=style&index=0&lang=scss&"),(0,t("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(n,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"input-text-editor"},[e.$slots.header?t("div",{staticClass:"input-text-editor-header"},[e._t("header")],2):e._e(),e._v(" "),t("codemirror",{attrs:{value:e.value,options:{lineNumbers:!0,readOnly:e.readOnly,mode:e.cmMode,theme:e.theme}},on:{input:function(s){return e.$emit("input",s)}}}),e._v(" "),e.disableModes&&e.disableThemes?e._e():t("div",{staticClass:"input-text-editor-bottom-bar"},[e.disableModes?e._e():t("input-select",{staticClass:"input-text-editor-bottom-bar-select",attrs:{options:e.modes},model:{value:e.editorMode,callback:function(s){e.editorMode=s},expression:"editorMode"}},[t("ui-button",{attrs:{slot:"additions:left",disabled:""},slot:"additions:left"},[t("translate",[e._v("Mode: ")])],1)],1),e._v(" "),e.disableThemes?e._e():t("input-select",{staticClass:"input-text-editor-bottom-bar-select --wide",attrs:{options:e.themes},model:{value:e.theme,callback:function(s){e.theme=s},expression:"theme"}},[t("ui-button",{attrs:{slot:"additions:left",disabled:""},slot:"additions:left"},[t("translate",[e._v("Theme: ")])],1)],1)],1)],1)}),[],!1,null,null,null).exports)},"./src/js/pages/user/mod-security/index.vue":function(e,s,t){"use strict";t.r(s),t.d(s,{__esModule:function(){return o.X},default:function(){return d}});var o=t("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=script&lang=js&"),n=o.Z,r=(t("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=style&index=0&lang=scss&"),t("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),l=t("./src/js/pages/user/mod-security/index.vue?vue&type=custom&index=0&blockType=route"),a=t.n(l),i=(0,r.Z)(n,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("app-page",[e.userLevel?t("template",{slot:"page:title"},[e.subdomainParam?t("translate",{attrs:{"translate-params":{domain:e.subdomain+"."+e.domainParam}}},[e._v("\n            Modsecurity: %{ domain }\n        ")]):t("translate",{attrs:{"translate-params":{domain:e.domainParam}}},[e._v("\n            Modsecurity: %{ domain }\n        ")])],1):e._e(),e._v(" "),e.userLevel?e._e():t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Domain\n        ")]),e._v(" "),t("input-autocomplete",{attrs:{slot:"content",values:e.$api.domains},on:{input:e.searchDomains},slot:"content",model:{value:e.domain,callback:function(s){e.domain=s},expression:"domain"}})],1),e._v(" "),e.domainParam&&e.haveSubdomains?t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Subdomain\n        ")]),e._v(" "),t("input-select",{attrs:{slot:"content",options:e.subdomainOptions},slot:"content",model:{value:e.subdomain,callback:function(s){e.subdomain=s},expression:"subdomain"}})],1):e._e(),e._v(" "),t("ui-tabs",{attrs:{tabs:[{id:"config",label:e.$gettext("Status & Disabled Rules")},{id:"log",label:e.$gettext("Log")}]}},[t("app-page-section",{key:"flags",attrs:{slot:"tab:config"},slot:"tab:config"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("translate",{attrs:{tag:"th"}},[e._v("\n                            ModSecurity Status\n                        ")]),e._v(" "),t("translate",{attrs:{tag:"th"}},[e._v("\n                            Setting\n                        ")])],1)]),e._v(" "),t("tbody",[t("tr",[t("td",[t("translate",[e._v("SecRuleEngine")])],1),e._v(" "),t("td",[t("input-radio",{attrs:{value:"On"},model:{value:e.flags.rule,callback:function(s){e.$set(e.flags,"rule",s)},expression:"flags.rule"}},[t("translate",[e._v("On")])],1),e._v(" "),t("input-radio",{attrs:{value:"Off"},model:{value:e.flags.rule,callback:function(s){e.$set(e.flags,"rule",s)},expression:"flags.rule"}},[t("translate",[e._v("Off")])],1)],1)])])]),e._v(" "),t("ui-button",{attrs:{slot:"footer:buttons",theme:"safe"},on:{click:e.saveFlags},slot:"footer:buttons"},[t("translate",[e._v("Save")])],1)],1),e._v(" "),t("app-page-section",{key:"rules",attrs:{slot:"tab:config"},slot:"tab:config"},[t("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("\n                Disabled Rules\n            ")]),e._v(" "),e.ids.length?t("ui-r-table",{attrs:{rows:e.ids,columns:[{id:"id",label:e.$gettext("ModSecurity Disabled Rules")}],"checked-rows":e.select},on:{"update:checkedRows":function(s){e.select=s},"update:checked-rows":function(s){e.select=s}}},[t("ui-table-action",{attrs:{slot:"table:actions"},on:{click:e.removeRules},slot:"table:actions"},[t("translate",[e._v("Delete")])],1)],1):e._e(),e._v(" "),t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    ID\n                ")]),e._v(" "),t("input-text",{attrs:{slot:"content",placeholder:e.$gettext("1234 or 1234-1239")},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.addRule.apply(null,arguments)}},slot:"content",model:{value:e.newId,callback:function(s){e.newId=s},expression:"newId"}})],1),e._v(" "),t("ui-button",{attrs:{slot:"footer:buttons",theme:"safe"},on:{click:e.addRule},slot:"footer:buttons"},[t("translate",[e._v("Disable Rule")])],1)],1),e._v(" "),t("app-page-section",{key:"log",attrs:{slot:"tab:log"},slot:"tab:log"},[e.logLoading?t("ui-center",{attrs:{height:"10rem"}},[t("ui-loader-icon",{attrs:{size:32}})],1):[t("app-page-section",[t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            Lines Count\n                        ")]),e._v(" "),t("input-text",{attrs:{slot:"content",number:"",disabled:e.fullLog},slot:"content",model:{value:e.lines,callback:function(s){e.lines=s},expression:"lines"}},[t("input-checkbox-button",{attrs:{slot:"additions:left"},slot:"additions:left",model:{value:e.fullLog,callback:function(s){e.fullLog=s},expression:"fullLog"}},[t("translate",[e._v("Full Log (slow for large logfiles)")])],1)],1)],1),e._v(" "),t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            Max Time\n                        ")]),e._v(" "),t("input-text",{attrs:{slot:"content",number:""},slot:"content",model:{value:e.maxTime,callback:function(s){e.maxTime=s},expression:"maxTime"}})],1),e._v(" "),t("ui-button",{attrs:{slot:"footer:buttons",theme:"safe",disabled:!(e.lines||e.fullLog)},on:{click:e.loadLog},slot:"footer:buttons"},[t("translate",[e._v("Load Log")])],1)],1),e._v(" "),t("app-page-section",[e.log.length?t("ui-table",{staticClass:"log-table",attrs:{items:e.log}},[t("ui-column",{attrs:{id:"time",label:e.$gettext("Date"),fit:""}}),e._v(" "),t("ui-column",{attrs:{id:"host",label:e.$gettext("Domain"),fit:""}}),e._v(" "),t("ui-column",{attrs:{id:"uri",label:e.$gettext("Request Line")}}),e._v(" "),t("ui-column",{attrs:{id:"ip",label:e.$gettext("Client IP"),fit:""}}),e._v(" "),t("ui-column",{attrs:{id:"rule-id",label:e.$gettext("Rule ID")},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.messages,(function(s){return t("li",{key:s.message,staticStyle:{"list-style-type":"none"}},[t("ui-tooltip",{attrs:{theme:"primary"},scopedSlots:e._u([{key:"trigger",fn:function(){return[e._v("\n                                            "+e._s(s.rule||e.$gettext("Unknown"))+"\n                                        ")]},proxy:!0},{key:"default",fn:function(){return[e._v("\n                                            "+e._s(s.message)+"\n                                        ")]},proxy:!0}],null,!0)})],1)}))}}],null,!1,2349431814)}),e._v(" "),t("ui-column",{attrs:{id:"actions",fit:""},scopedSlots:e._u([{key:"default",fn:function(s){var o=s.item,n=s.rules;return[t("ui-actions",[t("ui-link",{on:{click:function(s){return e.showMessage(o)}}},[t("translate",[e._v("View Log Item")])],1),e._v(" "),n.length?[n.length>1?e._l(n,(function(s){return t("ui-link",{key:"skip-rule-"+s,on:{click:function(t){return e.skipRule(s)}}},[t("translate",{attrs:{"translate-params":{rule:s}}},[e._v("\n                                                    Skip Rule: %{ rule }\n                                                ")])],1)})):t("ui-link",{on:{click:function(s){return e.skipRule(n[0])}}},[t("translate",[e._v("Skip Rule")])],1)]:e._e()],2)]}}],null,!1,1263592793)})],1):t("translate",[e._v("\n                        No data to show\n                    ")])],1)]],2)],1),e._v(" "),t("ui-dialog",{attrs:{id:"MODSECURITY_MESSAGE_DIALOG",size:"normal"},on:{"dialog:close":function(s){e.message=""}}},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Message Details\n        ")]),e._v(" "),t("input-text-editor",{attrs:{slot:"content",value:e.message,mode:"json","disable-modes":"","read-only":""},slot:"content"})],1)],2)}),[],!1,null,null,null);"function"==typeof a()&&a()(i);var d=i.exports},"./src/js/pages/user/mod-security/index.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=style&index=0&lang=scss&":function(e,s,t){var o=t("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/components/local/inputs/input-text-editor.vue?vue&type=style&index=0&lang=scss&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,t("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("7a6c41ca",o,!0,{})},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=style&index=0&lang=scss&":function(e,s,t){var o=t("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/mod-security/index.vue?vue&type=style&index=0&lang=scss&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,t("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("157a7d48",o,!0,{})}}]);