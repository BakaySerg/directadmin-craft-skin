(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[4597],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/_dialogs/assign-ip-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,s("./node_modules/core-js/modules/es.number.constructor.js");var n={api:[{command:s("./src/js/api/commands/admin/ip-manager/index.js").getIps,bind:{"response.creators":"creators"}}],props:{ipCount:{type:Number,required:!0}},data:function(){return{reseller:""}},methods:{submit:function(){this.$emit("assign",this.reseller)}}};t.Z=n},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/_dialogs/device-ips-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n={props:{device:{type:String,required:!0},ips:{type:Array,required:!1,default:function(){return[]}}}};t.Z=n},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/index.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),r=s("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var o=n(s("./node_modules/@babel/runtime/regenerator/index.js")),i=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js"));s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.array.reduce.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.object.entries.js"),s("./node_modules/core-js/modules/es.regexp.flags.js"),s("./node_modules/core-js/modules/es.array.find.js");var u=g(s("./src/js/api/commands/admin/ip-manager/index.js")),c=g(s("./src/js/api/commands/reseller/ip-config.js")),d=g(s("./node_modules/ramda/src/index.js")),p=n(s("./src/js/pages/admin/ip-manager/_dialogs/add-ip-dialog.vue")),m=n(s("./src/js/pages/admin/ip-manager/_dialogs/assign-ip-dialog.vue")),f=n(s("./src/js/pages/admin/ip-manager/_dialogs/device-ips-dialog.vue"));function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(v=function(e){return e?s:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var s=v(t);if(s&&s.has(e))return s.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(n,i,l):n[i]=e[i]}return n.default=e,s&&s.set(e,n),n}function b(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){(0,l.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var j,h,x,I,y,k={preload:u.getIps,commands:u,api:[{command:u.getIps,bind:"data"}],components:{AddIpDialog:p.default,AssignIpDialog:m.default,DeviceIpsDialog:f.default},data:function(){return{select:[],device:"",remove:"all"}},computed:{rows:function(){return this.$api.data.rows},selectedRows:function(){var e=this;return this.rows.filter((function(t){return e.select.includes(t.ip)}))},selectedRowsResellers:function(){return this.selectedRows.reduce((function(e,t){return t.resellers?t.resellers.forEach((function(t){e[t]=t})):e[t.reseller]=t.reseller,e}),{all:this.$gettext("All Resellers")})},enableAssign:function(){return 1===this.selectedRows.length&&"server"!==this.selectedRows[0].status},enableRemove:function(){return this.selectedRows.every((function(e){return e.reseller}))},enableDelete:function(){return this.selectedRows.every((function(e){return!e.reseller&&"free"===e.status}))},enableGlobal:function(){return{set:this.selectedRows.some((function(e){return!e.global})),disabled:this.selectedRows.some((function(e){return"server"===e.status}))}},ifaMessages:function(){return this.$api.data.device_ips.ifa_flags},devices:function(){var e=this;return d.map(d.pipe(d.toPairs,d.map((function(e){var t=(0,a.default)(e,2);return _({ip:t[0]},t[1])})),d.map((function(t){return _(_({},t),{},{flags:(s=t.ifa_flags,n=Number(s),isFinite(n)?Object.entries(e.ifaMessages).reduce((function(e,t){var s=Number(t[0]);return isFinite(s)&&n&s&&e.push(t[1]),e}),[]):[]),active:e.rows.some((function(e){return e.ip===t.ip}))});var s,n}))))(this.$api.data.device_ips.devices)},ipToDevice:function(){return d.pipe(d.map(d.keys),d.toPairs,d.reduce((function(e,t){return d.forEach((function(s){e[s]=t[0]}),t[1]),e}),{}))(this.$api.data.device_ips.devices)},ipPool:function(){return Object.entries(this.devices).reduce((function(e,t){var s=(0,a.default)(t,2),n=s[0];return s[1].forEach((function(t,s){var r=t.ip,o=t.netmask,i=t.active,l=t.flags,a=t.ifa_flags,u=Boolean(8&Number(a));e.push({device:n,ip:r,netmask:o,flags:l,loopback:u,active:i,first:0===s})})),e}),[])}},methods:{rowsMapper:function(e){var t=this.ipToDevice[e.ip]||null,s=t?this.devices[t].find((function(t){return t.ip===e.ip})).flags:[];return _(_({},e),{},{device:t,flags:s})},openDeviceModal:function(e){this.device=e,this.$dialog("DEVICE_IPS_DIALOG").open()},reloadTable:function(){this.$reloadApiTable(),this.select=[]},assignIp:function(e){u.assignReseller({select:this.select,reseller:e}).then(this.reloadTable)},removeIpReseller:(y=(0,i.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.removeReseller({select:this.select,reseller:"all"===this.remove?null:this.remove});case 2:this.reloadTable(),this.remove="all";case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)}),clearIpNamespace:function(){u.clearNamespace({select:this.select}).then(this.reloadTable)},deleteIps:function(){u.deleteIps({select:this.select}).then(this.reloadTable)},addIp:function(e){return u.addIp(e).then(this.reloadTable)},setGlobal:function(){u.setGlobal({select:this.select,global:this.enableGlobal.set}).then(this.reloadTable)},addIpFromDevice:(I=(0,i.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.addIp({ip:t.ip,netmask:t.netmask,add_to_device:!1});case 2:u.getIps(),this.$dialog("DEVICE_IPS_DIALOG").close();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)}),removeIpFromDevice:(x=(0,i.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.deleteIps({select:[t.ip]});case 2:u.getIps(),this.$dialog("DEVICE_IPS_DIALOG").close();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)}),share:(h=(0,i.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.share({select:this.select});case 2:this.reloadTable();case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)}),free:(j=(0,i.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.free({select:this.select});case 2:this.reloadTable();case 3:case"end":return e.stop()}}),e,this)}))),function(){return j.apply(this,arguments)})}};t.Z=k},"./src/js/pages/admin/ip-manager/_dialogs/assign-ip-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return o}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/_dialogs/assign-ip-dialog.vue?vue&type=script&lang=js&"),r=n.Z,o=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"ASSIGN_IP_DIALOG",theme:"safe"}},[s("translate",{attrs:{slot:"title","translate-n":e.ipCount,"translate-plural":"Assign IPs"},slot:"title"},[e._v("\n        Assign IP\n    ")]),e._v(" "),s("ui-form-element",{attrs:{slot:"content",group:"assignIp",validators:{required:!0}},slot:"content"},[s("translate",{attrs:{slot:"title","translate-n":e.ipCount,"translate-plural":"Assign IPs to:"},slot:"title"},[e._v("\n            Assign IP to:\n        ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.$api.creators},slot:"content",model:{value:e.reseller,callback:function(t){e.reseller=t},expression:"reseller"}})],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons","validate-group":"assignIp",theme:"safe"},on:{click:e.submit},slot:"buttons"},[s("translate",[e._v("Assign")])],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/ip-manager/_dialogs/device-ips-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return o}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/_dialogs/device-ips-dialog.vue?vue&type=script&lang=js&"),r=n.Z,o=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"DEVICE_IPS_DIALOG",size:"normal","no-close-btn":""}},[s("translate",{attrs:{slot:"title","translate-params":{device:e.device}},slot:"title"},[e._v("\n        Device: %{ device }\n    ")]),e._v(" "),s("ui-r-table",{attrs:{slot:"content",columns:[{id:"ip",label:e.$gettext("IP")},{id:"netmask",label:e.$gettext("Netmask")},{id:"active",label:e.$gettext("Active")}],rows:e.ips,"disable-pagination":"","is-checkable":!1,"hide-before-controls":""},slot:"content",scopedSlots:e._u([{key:"col:active",fn:function(t){var n=t.item;return s("ui-badge",{attrs:{theme:n.active?"safe":"danger"}},[e._v("\n            "+e._s(n.active?e.$gettext("Yes"):e.$gettext("No"))+"\n        ")])}},{key:"col:ip",fn:function(t){var n=t.item;return s("ui-tooltip",{},[s("span",{attrs:{slot:"trigger"},domProps:{textContent:e._s(n.ip)},slot:"trigger"}),e._v(" "),s("ul",e._l(n.flags,(function(t){return s("li",{key:t,domProps:{textContent:e._s(t)}})})),0)])}},{key:"row:actions",fn:function(t){var n=t.item;return s("ui-actions",{},[n.active?s("ui-link",{on:{click:function(t){return e.$emit("ip:remove",n)}}},[s("translate",[e._v("Remove IP")])],1):s("ui-link",{on:{click:function(t){return e.$emit("ip:add",n)}}},[s("translate",[e._v("Add IP")])],1)],1)}}])})],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/ip-manager/index.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return u}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/ip-manager/index.vue?vue&type=script&lang=js&"),r=n.Z,o=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),i=s("./src/js/pages/admin/ip-manager/index.vue?vue&type=custom&index=0&blockType=route"),l=s.n(i),a=(0,o.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:[{handler:e.$dialog("ADD_IP_DIALOG").open,label:e.$gettext("Add IP"),icon:"#plus-fill"}]}},[s("template",{slot:"header:buttons"},[s("ui-button",{attrs:{theme:"primary"},on:{click:function(t){e.$dialog("ADD_IP_DIALOG").open()}}},[s("translate",[e._v("Add IP")])],1)],1),e._v(" "),s("app-page-section",[s("ui-tabs",{attrs:{tabs:[{id:"ips",label:e.$gettext("IPs")},{id:"pool",label:e.$gettext("Devices")}]}},[s("ui-api-table",e._b({attrs:{slot:"tab:ips","equal-width-layout":""},on:{"action:assign":function(t){e.$dialog("ASSIGN_IP_DIALOG").open()},"action:remove":function(t){e.$dialog("DELETE_IP_FROM_RESELLER").open()},"action:clear":e.clearIpNamespace,"action:global":e.setGlobal,"action:share":e.share,"action:free":e.free,"action:del":function(t){e.$dialog("DELETE_ITEMS_DIALOG").open()}},slot:"tab:ips",scopedSlots:e._u([{key:"col:ip",fn:function(t){var n=t.ip,r=t.global,o=t.flags;return[s("ui-link",{attrs:{name:"admin/ip-manager/details",params:{ip:n}}},[e._v("\n                        "+e._s(n)+"\n                        "),o.length>0?s("ui-tooltip",[s("ul",e._l(o,(function(t){return s("li",{key:t,domProps:{textContent:e._s(t)}})})),0)]):e._e()],1),e._v(" "),r?s("ui-badge",{directives:[{name:"margin",rawName:"v-margin:left",value:1,expression:"1",arg:"left"}],attrs:{theme:"safe",icon:!1}},[s("translate",[e._v("Global")])],1):e._e()]}},{key:"col:device",fn:function(t){return[t.device?s("ui-link",{on:{click:function(s){return e.openDeviceModal(t.device)}}},[e._v("\n                        "+e._s(t.device)+"\n                    ")]):e._e()]}},{key:"col:resellers",fn:function(t){var n=t.resellers,r=t.status,o=t.reseller;return["server"===r?s("span"):[e._v("\n                        "+e._s(n?n.join(", "):o)+"\n                    ")]]}}]),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getIps,endpoint:"GET_IPS",rowID:"ip",columns:{ip:e.$gettext("IP"),status:e.$gettext("Status"),device:e.$gettext("Device"),resellers:e.$gettext("Reseller(s)"),users:e.$gettext("Users"),nameserver:{label:e.$gettext("Name Server"),filter:"p6eUnicode"},netmask:e.$gettext("Netmask")},actions:{assign:{label:e.$gettext("Assign"),disabled:!e.enableAssign},remove:{label:e.$gettext("Remove from reseller"),disabled:!e.enableRemove},clear:e.$gettext("Clear NS"),global:{label:e.enableGlobal.set?e.$gettext("Set Global"):e.$gettext("Un-Set Global"),disabled:e.enableGlobal.disabled},share:{label:e.$gettext("Share"),disabled:!1===e.enableRemove},free:{label:e.$gettext("Free"),disabled:!1===e.enableRemove},del:{label:e.$gettext("Delete"),disabled:!e.enableDelete}},verticalLayout:e.$_Client.isPhone,rowsMapper:e.rowsMapper},!1)),e._v(" "),s("ui-r-table",{attrs:{slot:"tab:pool",rows:e.ipPool,columns:[{id:"device",label:e.$gettext("Device")},{id:"ip",label:e.$gettext("IP")},{id:"netmask",label:e.$gettext("Netmask")},{id:"active",label:e.$gettext("Active")}],"hide-before-controls":"","is-checkable":!1},slot:"tab:pool",scopedSlots:e._u([{key:"col:device",fn:function(t){var n=t.item;return[n.first?s("span",{staticClass:"txt:bold"},[e._v("\n                        "+e._s(n.device)+"\n                        "),n.flags.length>0?s("ui-tooltip",[s("ul",e._l(n.flags,(function(t){return s("li",{key:t,domProps:{textContent:e._s(t)}})})),0)]):e._e()],1):s("span")]}},{key:"col:active",fn:function(t){var n=t.item;return s("ui-badge",{attrs:{theme:n.active?"safe":"danger"}},[e._v("\n                    "+e._s(n.active?e.$gettext("Yes"):e.$gettext("No"))+"\n                ")])}},{key:"row:actions",fn:function(t){var n=t.item;return!1===n.loopback?s("ui-actions",{},[!1===n.active?s("ui-link",{on:{click:function(t){return e.addIpFromDevice(n)}}},[s("translate",[e._v("Add IP")])],1):s("ui-link",{on:{click:function(t){return e.removeIpFromDevice(n)}}},[s("translate",[e._v("Remove IP")])],1)],1):e._e()}}],null,!0)})],1)],1),e._v(" "),s("assign-ip-dialog",{attrs:{"ip-count":e.select.length},on:{assign:e.assignIp}}),e._v(" "),s("add-ip-dialog",{on:{submit:e.addIp}}),e._v(" "),s("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("IP Address","IP Addresses",e.select.length)},on:{"click:confirm":e.deleteIps}}),e._v(" "),s("ui-dialog",{attrs:{id:"DELETE_IP_FROM_RESELLER"}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Delete IP from Reseller\n        ")]),e._v(" "),s("ui-form-element",{attrs:{slot:"content",vertical:""},slot:"content"},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Select Reseller\n            ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.selectedRowsResellers},slot:"content",model:{value:e.remove,callback:function(t){e.remove=t},expression:"remove"}})],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"danger"},on:{click:e.removeIpReseller},slot:"buttons"},[s("translate",[e._v("Remove IP")])],1)],1),e._v(" "),s("device-ips-dialog",{attrs:{device:e.device,ips:e.devices[e.device]},on:{"ip:add":e.addIpFromDevice,"ip:remove":e.removeIpFromDevice}})],2)}),[],!1,null,null,null);"function"==typeof l()&&l()(a);var u=a.exports},"./src/js/pages/admin/ip-manager/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);