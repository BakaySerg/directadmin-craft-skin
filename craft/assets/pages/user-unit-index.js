(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[5858],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/edit-route.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js");var n=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=n(o("./node_modules/@babel/runtime/regenerator/index.js"));o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.function.name.js"),o("./node_modules/core-js/modules/es.array.slice.js"),o("./node_modules/core-js/modules/es.array.join.js"),o("./node_modules/core-js/modules/es.array.concat.js");var r,a,i=n(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=n(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),l=n(o("./node_modules/@babel/runtime/helpers/toArray.js")),c=o("./src/js/api/commands/user/unit/index.js"),d={components:{RouteEditor:n(o("./src/js/pages/user/unit/_components/route-editor.vue")).default},props:{name:{type:String,required:!0}},data:function(){return{loading:!1,json:"[]",valid:!1}},computed:{location:function(){var e=this.name.split("/"),t=(0,l.default)(e),o=(t[0],t.slice(1));return[""].concat((0,u.default)(o)).join("/")}},methods:{onOpen:(a=(0,i.default)(s.default.mark((function e(){var t;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,(0,c.getRoute)({name:this.name});case 3:t=e.sent,this.json=JSON.stringify(t.route,null,2),this.loading=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),onClose:function(){this.json="[]"},saveRoute:(r=(0,i.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.setRoute)({routes:this.json,location:this.location});case 2:if(!(e.sent instanceof Error)){e.next=5;break}return e.abrupt("return");case 5:this.$emit("done");case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}};t.Z=d},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/rename-route.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js");var n=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,o("./node_modules/core-js/modules/es.string.ends-with.js"),o("./node_modules/core-js/modules/es.array.concat.js");var s,r=n(o("./node_modules/@babel/runtime/regenerator/index.js")),a=n(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o("./src/js/api/commands/user/unit/index.js"),u={props:{oldLocation:{type:String,required:!0,default:""}},data:function(){return{location:""}},methods:{onOpen:function(){this.location=this.oldLocation},changeLocation:(s=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.appendSlash(),e.next=3,(0,i.renameRoute)({old_route:this.oldLocation,new_route:this.location});case 3:this.$emit("done");case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),appendSlash:function(){!1===this.location.endsWith("/")&&(this.location=this.location.concat("/"))}}};t.Z=u},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/route-tab.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js");var n=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=n(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),r=n(o("./node_modules/@babel/runtime/helpers/toArray.js"));o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.array.slice.js"),o("./node_modules/core-js/modules/es.array.join.js"),o("./node_modules/core-js/modules/es.array.concat.js");var a=o("./src/js/api/commands/user/unit/index.js"),i=n(o("./src/js/pages/user/unit/_components/rename-route.vue")),u=n(o("./src/js/pages/user/unit/_components/edit-route.vue")),l={api:a.getUnits,components:{RenameRouteDialog:i.default,EditRouteDialog:u.default},data:function(){return{checkedRows:[],selectedLocation:""}},computed:{locations:function(){return this.$api.routes.map((function(e){return{location:e}}))}},methods:{loadData:function(){this.checkedRows=[],this.selectedLocation="",(0,a.getUnits)()},getLocationFromName:function(e){var t=e.split("/"),o=(0,r.default)(t),n=(o[0],o.slice(1));return[""].concat((0,s.default)(n)).join("/")},deleteLocations:function(){var e=this.checkedRows.map((function(e){return e.location}));(0,a.deleteRoutes)({select:e}).then(this.loadData)},changeLocation:function(e){var t=this;this.selectedLocation=e,this.$nextTick((function(){t.$dialog("RENAME_ROUTE").open()}))},editRoute:function(e){this.selectedLocation=e,this.$dialog("EDIT_ROUTE").open()},renameRoute:function(e){this.selectedLocation=e,this.$dialog("RENAME_ROUTE").open()}}};t.Z=l},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/index.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.symbol.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o("./node_modules/core-js/modules/es.object.define-properties.js"),o("./node_modules/core-js/modules/es.object.define-property.js");var n=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=n(o("./node_modules/@babel/runtime/regenerator/index.js")),r=n(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=n(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.function.name.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.regexp.to-string.js"),o("./node_modules/core-js/modules/es.object.values.js");var i=o("./src/js/api/commands/user/unit/index.js"),u=n(o("./src/js/pages/user/unit/_components/route-tab.vue")),l=n(o("./src/js/pages/user/unit/_components/create-route.vue"));function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){(0,r.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var p,m,f,v=i.modifyApp.extend({notifySuccess:!1,notifyError:!1}),j={preload:i.getUnits,api:i.getUnits,components:{RouteTab:u.default,CreateRouteDialog:l.default},data:function(){return{selectedApps:[],newRoute:{app:"",force:!1}}},computed:{tabs:function(){return[{id:"apps",label:this.$gettext("Applications")},{id:"routes",label:this.$gettext("Routes")}]},types:function(){return{external:this.$gettext("Node.js"),php:this.$gettext("PHP"),"php 7.3":this.$gettext("PHP 7.3"),python:this.$gettext("Python"),java:this.$gettext("Java"),perl:this.$gettext("Perl"),ruby:this.$gettext("Ruby")}},routes:function(){return this.$api.routes.map((function(e){return{route:e}}))},select:function(){return this.selectedApps.map((function(e){return e.name}))}},watch:{$domain:function(e){(0,i.getUnits)({domain:e})}},methods:{getUnits:i.getUnits,deleteApps:(f=(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.deleteApps)({select:this.select});case 2:this.selectedApps=[],(0,i.getUnits)();case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)}),createRoute:(m=(0,a.default)(s.default.mark((function e(){var t,o,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:"",o=n.length>1&&void 0!==n[1]&&n[1],this.newRoute.app=t,this.newRoute.force=o,this.$dialog("CREATE_ROUTE_DIALOG").open();case 5:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),restartApp:(p=(0,a.default)(s.default.mark((function e(t,o){var n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d(d({},o),{},{environment:d(d({},o.environment||{}),{},{APPGEN:Date.now().toString()})}),e.next=3,v({name:t,json:JSON.stringify(n,null,2)});case 3:this.$notifications.success({title:"Success"});case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)}),getPHPRoot:function(e){if(e.targets){var t=Object.values(e.targets);if(1===t.length)return t[0].root;var o=t.length,n=t[0].root,s=o-1;return this.$gettextInterpolate(this.$ngettext("%{root} + %{n} more target","%{root} + %{n} more targets",s),{n:s,root:n})}return e.root}}};t.Z=j},"./src/js/pages/user/unit/_components/edit-route.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return n.X},default:function(){return r}});var n=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/edit-route.vue?vue&type=script&lang=js&"),s=n.Z,r=(0,o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(s,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ui-dialog",{attrs:{id:"EDIT_ROUTE",theme:"primary",size:"normal","no-auto-close":""},on:{"dialog:open":e.onOpen,"dialog:close":e.onClose}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Edit Route\n    ")]),e._v(" "),o("template",{slot:"content"},[e.loading?o("ui-center",{attrs:{height:"10rem"}},[o("ui-loader-icon",{attrs:{size:32}})],1):o("route-editor",{on:{"update:valid":function(t){e.valid=t}},model:{value:e.json,callback:function(t){e.json=t},expression:"json"}})],1),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"safe",disabled:!e.valid},on:{click:e.saveRoute},slot:"buttons"},[o("translate",[e._v("Save")])],1)],2)}),[],!1,null,null,null).exports},"./src/js/pages/user/unit/_components/rename-route.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return n.X},default:function(){return r}});var n=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/rename-route.vue?vue&type=script&lang=js&"),s=n.Z,r=(0,o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(s,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ui-dialog",{attrs:{id:"RENAME_ROUTE",theme:"safe"},on:{"dialog:open":e.onOpen}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Change Location\n    ")]),e._v(" "),o("template",{slot:"content"},[o("ui-form-element",{attrs:{vertical:""}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Old Location\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content",value:e.oldLocation,disabled:""},slot:"content"})],1),e._v(" "),o("ui-form-element",{attrs:{vertical:"",validators:{required:!0},group:"rename-location"}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                New Location\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},on:{blur:e.appendSlash},slot:"content",model:{value:e.location,callback:function(t){e.location=t},expression:"location"}})],1)],1),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"rename-location"},on:{click:e.changeLocation},slot:"buttons"},[o("translate",[e._v("Change")])],1)],2)}),[],!1,null,null,null).exports},"./src/js/pages/user/unit/_components/route-tab.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return n.X},default:function(){return r}});var n=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/_components/route-tab.vue?vue&type=script&lang=js&"),s=n.Z,r=(0,o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(s,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page-section",[o("ui-r-table",{attrs:{columns:[{id:"location",label:e.$gettext("Location")}],rows:e.locations,"checked-rows":e.checkedRows},on:{"update:checkedRows":function(t){e.checkedRows=t},"update:checked-rows":function(t){e.checkedRows=t}},scopedSlots:e._u([{key:"col:location",fn:function(t){var n=t.location;return o("div",{directives:[{name:"flex",rawName:"v-flex",value:{main:"between"},expression:"{ main: 'between' }"}]},[o("ui-link",{on:{click:function(t){return e.editRoute(n)}}},[o("ui-icon",{directives:[{name:"margin",rawName:"v-margin:right",value:"5px",expression:"'5px'",arg:"right"}],attrs:{id:"pencil",size:"small",color:"primary"}}),e._v("\n                "+e._s(n)+"\n            ")],1),e._v(" "),o("ui-actions",[o("ui-link",{on:{click:function(t){return e.editRoute(n)}}},[o("translate",[e._v("Edit")])],1),e._v(" "),o("ui-link",{on:{click:function(t){return e.renameRoute(n)}}},[o("translate",[e._v("Rename")])],1)],1)],1)}}])},[o("ui-table-action",{attrs:{slot:"table:actions"},on:{click:e.deleteLocations},slot:"table:actions"},[o("translate",[e._v("Delete")])],1)],1),e._v(" "),o("rename-route-dialog",{attrs:{"old-location":e.selectedLocation},on:{done:e.loadData}}),e._v(" "),o("edit-route-dialog",{attrs:{name:e.selectedLocation},on:{done:e.loadData}})],1)}),[],!1,null,null,null).exports},"./src/js/pages/user/unit/index.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return n.X},default:function(){return l}});var n=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/unit/index.vue?vue&type=script&lang=js&"),s=n.Z,r=o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=o("./src/js/pages/user/unit/index.vue?vue&type=custom&index=0&blockType=route"),i=o.n(a),u=(0,r.Z)(s,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page",{attrs:{id:"unit",actions:[{label:e.$gettext("Create Application"),icon:"#plus-fill",name:"user/unit/create"},{label:e.$gettext("Create Route"),handler:e.createRoute,icon:"#plus-fill"}]}},[o("ui-button-link",{attrs:{slot:"header:buttons",theme:"primary",name:"user/unit/create"},slot:"header:buttons"},[o("translate",[e._v("Create Application")])],1),e._v(" "),o("ui-button",{attrs:{slot:"header:buttons",theme:"safe"},on:{click:function(t){return e.createRoute()}},slot:"header:buttons"},[o("translate",[e._v("Create Route")])],1),e._v(" "),o("app-page-section",[o("ui-tabs",e._b({},"ui-tabs",{tabs:e.tabs},!1),[o("div",{attrs:{slot:"tab:apps"},slot:"tab:apps"},[o("ui-r-table",{attrs:{"checked-rows":e.selectedApps,columns:[{id:"name",label:this.$gettext("Name")},{id:"type",label:this.$gettext("Type")},{id:"wd",label:this.$gettext("Associated Directory")},{id:"restart",label:this.$gettext(" ")}],rows:e.$api.apps},on:{"update:checkedRows":function(t){e.selectedApps=t},"update:checked-rows":function(t){e.selectedApps=t}},scopedSlots:e._u([{key:"col:name",fn:function(t){var n=t.name;return o("ui-link",{staticClass:"txt:uppercase txt:bold",attrs:{name:"user/unit/modify",params:{id:n}}},[o("ui-icon",{directives:[{name:"margin",rawName:"v-margin:right",value:"5px",expression:"'5px'",arg:"right"}],attrs:{id:"pencil",size:"small",theme:"primary"}}),e._v("\n                        "+e._s(n)+"\n                    ")],1)}},{key:"col:type",fn:function(t){var o=t.type;return[e._v("\n                        "+e._s(e.types[o])+"\n                    ")]}},{key:"col:wd",fn:function(t){var o=t.app;return["python"===o.type?[e._v("\n                            "+e._s(o.path?o.path.join(", "):"")+"\n                        ")]:"php"===o.type?[e._v("\n                            "+e._s(e.getPHPRoot(o))+"\n                        ")]:[e._v("\n                            "+e._s(o.working_directory)+"\n                        ")]]}},{key:"col:restart",fn:function(t){var n=t.name,s=t.app;return o("ui-actions",{},[o("ui-link",{on:{click:function(t){return e.restartApp(n,s)}}},[o("translate",[e._v("Restart Application")])],1),e._v(" "),o("ui-link",{on:{click:function(t){return e.createRoute(n)}}},[o("translate",[e._v("Create Route")])],1)],1)}}])},[o("ui-table-action",{attrs:{slot:"table:actions"},on:{click:e.deleteApps},slot:"table:actions"},[o("translate",[e._v("Delete")])],1)],1)],1),e._v(" "),o("route-tab",{attrs:{slot:"tab:routes"},slot:"tab:routes"})],1),e._v(" "),o("create-route-dialog",{attrs:{"app-name":e.newRoute.app,"force-app-name":e.newRoute.force},on:{done:e.getUnits}})],1)],1)}),[],!1,null,null,null);"function"==typeof i()&&i()(u);var l=u.exports},"./src/js/pages/user/unit/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);