(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{1870:function(t,e,a){"use strict";a.r(e);var r=a(4068),o=a(2799);for(var i in o)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a(3800);var n=a(0),s=a(3802),l=a.n(s),u=Object(n.a)(o.default,r.a,r.b,!1,null,"1853bbb4",null);"function"==typeof l.a&&l()(u),e.default=u.exports},1884:function(t,e,a){"use strict";var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.validateIPRangeList=e.validateDomain=e.validatePassword=e.validateSubdomain=e.validateUsername=e.validateDBUser=e.validateDatabase=e.validateDNSName=e.validateMXValue=e.validateDNSValue=e.validateFTP=e.validateEmail=e.validateForwarder=void 0;var o=r(a(78)),i=r(a(98)),n=r(a(1885)),s=o.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:o.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:n.default.isValid,message:n.default.getMessage}}),l=s.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});e.validateForwarder=l;var u=s.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});e.validateEmail=u;var d=s.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});e.validateFTP=d;var c=s.extend({params:{type:"dns"},domain:!0,schema:{record:o.default.REQUIRED_STRING}}),m=c.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:o.default.REQUIRED_STRING}});e.validateDNSValue=m;var p=m.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(t){return{value:"10",mx_value:t.value}}});e.validateMXValue=p;var v=c.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:o.default.REQUIRED_STRING,value:null}});e.validateDNSName=v;var f=s.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});e.validateDatabase=f;var b=s.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});e.validateDBUser=b;var _=s.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});e.validateUsername=_;var h=s.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});e.validateSubdomain=h;var D=s.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});e.validatePassword=D;var S=s.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(t){var e=t.value;return{value:i.default.toASCII(e)}}});e.validateDomain=S;var g=s.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});e.validateIPRangeList=g},1885:function(t,e,a){"use strict";a.r(e);var r=a(97);e.default={isValid:function(t){return void 0===t.error},getMessage:function(t){return Object(r.toAppHtml)(t.error||"")}}},1931:function(t,e,a){"use strict";a(10),a(5),a(6),a(8),a(11);var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.getPhpDocrootOptions=e.phpOverride=e.docrootOverride=e.getSubdomainLog=e.deleteSubdomains=e.createSubdomain=e.getSubdomains=void 0,a(7),a(84);var o=r(a(2)),i=r(a(78));function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}var s=i.default.get({id:"GET_SUBDOMAINS",url:"/CMD_SUBDOMAIN",schema:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){(0,o.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({domain:i.default.DOMAIN},i.default.PAGINATION),after:function(t){return t.flow(t.moveProp("subdomains","rows"),t.moveProp("allow_subdomain_docroot_override","docroot"),t.processTableInfo("rows"),t.mapProps({awstats:function(t){return"0"!==t},webalizer:t.isEqual("1"),docroot:t.isEqual("1"),has_php_selector:t.isEqual("yes"),rows:t.flow(t.toArray,t.mapArray(t.moveProp("subdomain_docroot_override","docroot")),t.mapArrayProps({bandwidth:t.convert.toAppNumber,stats:t.mapProps({webalizer_only:t.convert.toAppBoolean}),docroot:function(e){if(e&&Object.keys(e).length){if(void 0!==e.php1_select){var a=t.toSelect(e.php1_select),r=a.options,o=a.value;return{public_html:e.public_html,private_html:e.private_html,php_labels:r,php1_select:o}}return e}return!1}}))}))}});e.getSubdomains=s;var l=i.default.post({url:"/CMD_SUBDOMAIN",params:{action:"create"},schema:{domain:i.default.DOMAIN,subdomain:i.default.REQUIRED_STRING}});e.createSubdomain=l;var u=i.default.select({url:"/CMD_SUBDOMAIN",params:{action:"delete"},domain:!0,body:{contents:i.default.REQUIRED_BOOL}});e.deleteSubdomains=u;var d=i.default.get({id:"GET_SUBDOMAIN_LOG",url:"/CMD_SHOW_LOG",params:{json:null},accept:"text/plain",schema:{domain:i.default.DOMAIN,type:i.default.REQUIRED_STRING,subdomain:i.default.REQUIRED_STRING,lines:i.default.OPTIONAL_STRING},after:function(t){return t.flow(t.convert.toLines,(function(t){return t.slice(0,-1)}))}});e.getSubdomainLog=d;var c=i.default.post({url:"/CMD_SUBDOMAIN",params:{action:"document_root_override"},domain:!0,schema:{subdomain:i.default.REQUIRED_STRING,private_html:i.default.OPTIONAL_STRING,public_html:i.default.OPTIONAL_STRING}});e.docrootOverride=c;var m=i.default.post({url:"/CMD_SUBDOMAIN",domain:!0,params:{action:"php_selector"},schema:{subdomain:i.default.REQUIRED_STRING,php1_select:i.default.REQUIRED_STRING}});e.phpOverride=m;var p=i.default.get({url:"/CMD_SUBDOMAIN",id:"SUBDOMAIN_DATA",domain:!0,params:{action:"show_docroot_override"},schema:{subdomain:i.default.REQUIRED_STRING},after:function(t){return t.flow(t.project({has_php_selector:"has_php_selector",http:"public_html",https:"private_html",php:"php1_select"}),t.mapProps({php:t.toSelect,has_php_selector:t.isEqual("yes")}))}});e.getPhpDocrootOptions=p},2799:function(t,e,a){"use strict";a.r(e);var r=a(2800),o=a.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e.default=o.a},2800:function(t,e,a){"use strict";var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(a(36)),i=r(a(37));a(17),a(49);var n,s=a(1931),l=a(1884),u=r(a(3798)),d={preload:s.getSubdomains,commands:{getSubdomains:s.getSubdomains,validateSubdomain:l.validateSubdomain},components:{DocrootOverrideDialog:u.default},api:[{command:s.getSubdomains,bind:"subdomains"}],data:function(){return{newSubdomain:"",removeDir:!1,select:[],docrootOverride:{sub:"",data:{public_html:"",private_html:""}}}},computed:{awstats:function(){return this.$api.subdomains.awstats},webalizer:function(){return this.$api.subdomains.webalizer},rowsCount:function(){return this.$api.subdomains.rowsCount},docrootOverrideEnabled:function(){return this.$api.subdomains.docroot},subdomainUsage:function(){var t=Number(this.$state.app.tokens.NUSERSUBDOMAINSMAX);return{usage:this.rowsCount,limit:isFinite(t)?t:1/0}}},watch:{$domain:function(){(0,s.getSubdomains)(),this.select=[]}},methods:{getSubdomains:s.getSubdomains,deleteSubdomains:function(){(0,s.deleteSubdomains)({select:this.select,contents:this.removeDir}).then(this.$reset).then(s.getSubdomains)},createSubdomain:(n=(0,i.default)(o.default.mark((function t(){var e;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this.$p6e.toA(this.newSubdomain))!==this.newSubdomain&&this.$notifications.info({title:this.$gettext("Subdomain name punycoded"),content:this.$gettext("Subdomain name has been automatically converted to punycode format. Punycode is used to encode internationalized domain names (IDN) by converting Unicode characters to ASCII.")}),t.next=4,(0,s.createSubdomain)({subdomain:e});case 4:(0,s.getSubdomains)(),this.$reset();case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),openDocrootDialog:function(t,e){Object.assign(this.docrootOverride,{sub:t,data:e}),this.$dialog("DOCUMENT_ROOT_OVERRIDE_DIALOG").open()}}};e.default=d},2801:function(t,e,a){"use strict";a.r(e);var r=a(2802),o=a.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e.default=o.a},2802:function(t,e,a){"use strict";a(16),a(14),a(23),a(25),a(18),a(6);var r=a(1),o=a(19);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(a(36)),n=r(a(37));a(21),a(40),a(12),a(15),a(3799);var s=a(942),l=a(1931),u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var a=d(e);if(a&&a.has(t))return a.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if("default"!==n&&Object.prototype.hasOwnProperty.call(t,n)){var s=i?Object.getOwnPropertyDescriptor(t,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=t[n]}r.default=t,a&&a.set(t,r);return r}(a(9));function d(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,a=new WeakMap;return(d=function(t){return t?a:e})(t)}var c,m,p={props:{sub:{type:String,required:!0,default:""},data:{type:Object,required:!0,default:function(){return{private_html:"",public_html:""}}}},data:function(){return{overridePrivateHtml:!1,privateHtml:"",overridePublicHtml:!1,publicHtml:"",dirs:[]}},methods:{initData:function(){this.publicHtml=(this.data.public_html||"").replace("/domains/",""),this.privateHtml=(this.data.private_html||"").replace("/domains/",""),this.overridePublicHtml=Boolean(this.data.public_html),this.overridePrivateHtml=Boolean(this.data.private_html),this.loadDirs()},loadDirs:(m=(0,n.default)(i.default.mark((function t(){var e;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.getFolderTree)({path:"/domains",action:"tree"});case 2:e=t.sent,this.dirs=u.pipe(u.map(u.prop("path")),u.filter(u.startsWith("/domains/")))(e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)}),validateDir:function(t){return!t||this.dirs.includes("/domains/".concat(t))},submit:(c=(0,n.default)(i.default.mark((function t(){var e;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={subdomain:this.sub,public_html:this.overridePublicHtml?"/domains/".concat(this.publicHtml):this.publicHtml?"":null,private_html:this.overridePrivateHtml?"/domains/".concat(this.privateHtml):this.privateHtml?"":null},t.next=3,(0,l.docrootOverride)(e);case 3:this.$emit("update");case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})}};e.default=p},3158:function(t,e,a){var r=a(3801);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,a(4).default)("413d2874",r,!0,{})},3798:function(t,e,a){"use strict";a.r(e);var r=a(4200),o=a(2801);for(var i in o)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(i);var n=a(0),s=Object(n.a)(o.default,r.a,r.b,!1,null,null,null);e.default=s.exports},3799:function(t,e,a){"use strict";var r=a(29),o=a(734);r({target:"String",proto:!0,forced:a(735)("sub")},{sub:function(){return o(this,"sub","","")}})},3800:function(t,e,a){"use strict";a(3158)},3801:function(t,e,a){},3802:function(t,e){},4068:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-page",{attrs:{actions:t.subdomainUsage.usage<t.subdomainUsage.limit?[{label:t.$gettext("Add Subdomain"),handler:t.$dialog("ADD_SUBDOMAIN_DIALOG").open,icon:"#plus-fill"}]:[]}},[a("template",{slot:"details"},[a("ui-infobar-item",{attrs:{title:t.$gettext("Details")}},[a("ui-infobar-stats",t._b({attrs:{title:t.$gettext("Subdomains")}},"ui-infobar-stats",t.subdomainUsage,!1))],1)],1),t._v(" "),a("ui-tokens-conditional-button",{attrs:{slot:"header:buttons",theme:"safe",token:"NUSERSUBDOMAINSMAX",usage:t.rowsCount},on:{click:function(e){t.$dialog("ADD_SUBDOMAIN_DIALOG").open()}},slot:"header:buttons"},[a("translate",[t._v("Add Subdomain")]),t._v(" "),a("translate",{attrs:{slot:"limitText"},slot:"limitText"},[t._v("\n            Sub-Domains Limit Reached\n        ")])],1),t._v(" "),a("app-page-section",[a("ui-api-table",t._b({on:{"action:delete":function(e){t.$dialog("DELETE_ITEMS_DIALOG").open()}},scopedSlots:t._u([{key:"col:subdomain_name",fn:function(e){var a=e.subdomain_name;return[t._v("\n                "+t._s(t.$p6e.toU(a))+"."+t._s(t.$domainUnicode)+"\n            ")]}},{key:"col:docroot",fn:function(e){var r=e.docroot,o=e.subdomain_name;return a("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center",main:"start"},expression:"{ cross: 'center', main: 'start' }"}]},[!1===r?a("ui-badge",{key:"default-docroot",attrs:{theme:"safe"}},[a("translate",[t._v("Default")])],1):a("ui-tooltip",{attrs:{theme:"danger"}},[a("ui-badge",{key:"custom-docroot",attrs:{slot:"trigger",theme:"danger"},slot:"trigger"},[a("translate",[t._v("Custom")])],1),t._v(" "),a("table",{staticClass:"docroot-table"},[r.public_html?a("tr",[a("td",{staticClass:"txt:bold",attrs:{width:"40"}},[t._v("\n                                http:\n                            ")]),t._v(" "),a("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(r.public_html||t.$gettext("default"))+"\n                            ")])]):t._e(),t._v(" "),r.private_html?a("tr",[a("td",{staticClass:"txt:bold"},[t._v("\n                                https:\n                            ")]),t._v(" "),a("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(r.private_html||t.$gettext("default"))+"\n                            ")])]):t._e(),t._v(" "),r.php1_select?a("tr",[a("td",{staticClass:"txt:bold"},[t._v("\n                                php:\n                            ")]),t._v(" "),a("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(r.php_labels[r.php1_select])+"\n                            ")])]):t._e()])],1),t._v(" "),a("ui-button-icon",{directives:[{name:"margin",rawName:"v-margin:left",value:1,expression:"1",arg:"left"}],attrs:{icon:"pencil",title:t.$gettext("Change"),theme:"primary"},on:{click:function(e){return t.$router.push({name:"user/subdomains/docroot",params:{subdomain:o}})}}})],1)}},{key:"row:actions",fn:function(e){var r=e.item;return a("ui-actions",{},[a("ui-link",{attrs:{name:"user/subdomains/stats",params:{subdomain:r.subdomain_name}}},[a("translate",[t._v("Stats")])],1),t._v(" "),a("ui-link",{attrs:{name:"user/subdomains/logs",params:{subdomain:r.subdomain_name,type:"usage"}}},[a("translate",[t._v("Usage Log")])],1),t._v(" "),a("ui-link",{attrs:{name:"user/subdomains/logs",params:{subdomain:r.subdomain_name,type:"error"}}},[a("translate",[t._v("Error Log")])],1),t._v(" "),t.$_cmd("CMD_MODSECURITY")?a("ui-link",{attrs:{name:"user/mod-security",params:{subdomainProp:r.subdomain_name,domainProp:t.$domain}}},[a("translate",[t._v("ModSecurity")])],1):t._e()],1)}}]),model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{command:t.$commands.getSubdomains,rowID:"subdomain_name",columns:{subdomain_name:{label:t.$gettext("Subdomain Name"),grow:!0},bandwidth:{label:t.$gettext("Bandwidth"),filter:["humanReadableSize"]},docroot:{label:t.$gettext("Docroot"),hide:!t.docrootOverrideEnabled}},actions:{delete:t.$gettext("Delete")},updateOn:["CREATE_SUBDOMAIN","DELETE_SUBDOMAINS"],verticalLayout:t.$_Client.isPhone},!1))],1),t._v(" "),a("ui-dialog",{attrs:{id:"ADD_SUBDOMAIN_DIALOG"}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n            Add New Subdomain\n        ")]),t._v(" "),a("ui-form-element",{attrs:{slot:"content",vertical:"",group:"createSubdomain",validators:{required:!0,api:t.$commands.validateSubdomain}},slot:"content"},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Subdomain:\n            ")]),t._v(" "),a("input-text",{attrs:{slot:"content",suffix:"."+t.$p6e.toU(t.$domain)},slot:"content",model:{value:t.newSubdomain,callback:function(e){t.newSubdomain=e},expression:"newSubdomain"}})],1),t._v(" "),a("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"createSubdomain"},on:{click:t.createSubdomain},slot:"buttons"},[a("translate",[t._v("Add Subdomain")])],1)],1),t._v(" "),a("ui-dialog-delete-items",{attrs:{subject:t.$ngettext("subdomain","subdomains",t.select.length)},on:{"click:confirm":t.deleteSubdomains}},[a("input-checkbox",{model:{value:t.removeDir,callback:function(e){t.removeDir=e},expression:"removeDir"}},[a("translate",[t._v("Remove Directory Content")])],1)],1),t._v(" "),t.docrootOverrideEnabled?a("docroot-override-dialog",t._b({on:{update:t.getSubdomains}},"docroot-override-dialog",t.docrootOverride,!1)):t._e()],2)},o=[]},4200:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ui-dialog",{attrs:{id:"DOCUMENT_ROOT_OVERRIDE_DIALOG",size:"small"},on:{"dialog:open":t.initData}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n        Document Root Override\n    ")]),t._v(" "),a("div",{attrs:{slot:"content"},slot:"content"},[a("ui-form-element",{attrs:{vertical:""}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Subdomain\n            ")]),t._v(" "),a("input-text",{attrs:{slot:"content",value:"sub."+t.$domainUnicode,disabled:""},slot:"content"})],1),t._v(" "),a("ui-form-element",{attrs:{group:"docroot-override",validators:{required:!0,validateDir:t.validateDir},vertical:""}},[a("input-checkbox",{attrs:{slot:"title"},slot:"title",model:{value:t.overridePublicHtml,callback:function(e){t.overridePublicHtml=e},expression:"overridePublicHtml"}},[a("translate",[t._v("Override public HTML document root")])],1),t._v(" "),t.overridePublicHtml?a("input-autocomplete",{attrs:{slot:"content",prefix:"/domains/",values:t.dirs},slot:"content",model:{value:t.publicHtml,callback:function(e){t.publicHtml=e},expression:"publicHtml"}}):t._e(),t._v(" "),a("translate",{attrs:{slot:"error:validateDir"},slot:"error:validateDir"},[t._v("\n                Folder does not exist\n            ")])],1),t._v(" "),a("ui-form-element",{attrs:{group:"docroot-override",validators:{required:!0,validateDir:t.validateDir},vertical:""}},[a("input-checkbox",{attrs:{slot:"title"},slot:"title",model:{value:t.overridePrivateHtml,callback:function(e){t.overridePrivateHtml=e},expression:"overridePrivateHtml"}},[a("translate",[t._v("Override private HTML document root")])],1),t._v(" "),t.overridePrivateHtml?a("input-text",{attrs:{slot:"content",prefix:"/domains/"},slot:"content",model:{value:t.privateHtml,callback:function(e){t.privateHtml=e},expression:"privateHtml"}}):t._e(),t._v(" "),a("translate",{attrs:{slot:"error:validateDir"},slot:"error:validateDir"},[t._v("\n                Folder does not exist\n            ")])],1)],1),t._v(" "),a("ui-button",{attrs:{slot:"buttons",theme:"primary","validate-group":"docroot-override"},on:{click:t.submit},slot:"buttons"},[a("translate",[t._v("Save")])],1)],1)},o=[]}}]);