(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{1860:function(t,e,n){"use strict";n.r(e);var s=n(4058),i=n(2745);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);var o=n(0),l=n(3764),u=n.n(l),r=Object(o.a)(i.default,s.a,s.b,!1,null,null,null);"function"==typeof u.a&&u()(r),e.default=r.exports},2745:function(t,e,n){"use strict";n.r(e);var s=n(2746),i=n.n(s);for(var a in s)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e.default=i.a},2746:function(t,e,n){"use strict";n(16),n(14),n(23),n(25),n(18),n(6);var s=n(1),i=n(19);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(n(36)),o=s(n(37));n(49);var l=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=r(e);if(n&&n.has(t))return n.get(t);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var l=a?Object.getOwnPropertyDescriptor(t,o):null;l&&(l.get||l.set)?Object.defineProperty(s,o,l):s[o]=t[o]}s.default=t,n&&n.set(t,s);return s}(n(3150)),u=s(n(3761));function r(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(r=function(t){return t?n:e})(t)}var c,d,_={preload:l.getSettings,api:l.getSettings,commands:l,components:{AddSecurityQuestionDialog:u.default},data:function(){return{activeQuestion:{},newAnswer:"",select:[],settings:{security_questions:!1,api_with_password:!1,notify_on_all_question_failures:!1,max_attempts:"5"}}},computed:{table:function(){return this.$api.table},questions:function(){return this.$api.questions}},created:function(){Object.assign(this.settings,this.$api.settings)},methods:{handleQuestionEdit:function(t){this.activeQuestion=t,this.$dialog("EDIT_QUESTION_DIALOG").open()},handleAnswerSave:(d=(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.updateQuestion({select:[this.activeQuestion.id],value:this.newAnswer});case 2:t.sent&&(this.$reloadApiTable(),this.activeQuestion={},this.newAnswer="");case 4:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)}),enable:function(){this.settings.security_questions=!0,this.saveSettings()},disable:function(){this.settings.security_questions=!1,this.saveSettings()},saveSettings:function(){l.updateSettings({action:"settings",version:"1",security_questions:this.settings.security_questions||null,api_with_password:this.settings.api_with_password||null,notify_on_all_question_failures:this.settings.notify_on_all_question_failures||null,save:"Save"}).then(l.getSettings)},deleteCheckedQuestions:(c=(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.deleteQuestions(this.$get("select")).then(this.$reloadApiTable);case 1:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})}};e.default=_},2747:function(t,e,n){"use strict";n.r(e);var s=n(2748),i=n.n(s);for(var a in s)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e.default=i.a},2748:function(t,e,n){"use strict";var s=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,a=s(n(36)),o=s(n(37)),l=n(3150),u={data:function(){return{type:"included",question:"",value:""}},api:[{command:l.getSettings,bind:{"response.questions":"questions"}}],watch:{type:function(){this.question=""}},methods:{addQuestion:(i=(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,l.addQuestion)({type:this.type,question:this.question,value:this.value}).then(l.getSettings),this.$emit("update");case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})}};e.default=u},3150:function(t,e,n){"use strict";var s=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.submitAnswer=e.updateQuestion=e.deleteQuestions=e.addQuestion=e.updateSettings=e.getSettings=void 0;var i=s(n(78)),a="/CMD_SECURITY_QUESTIONS",o=i.default.get({id:"SECURITY_SETTINGS",url:a,after:function(t){return t.flow(t.project({questions:"new_questions","table.rows":"questions","settings.api_with_password":"SECURITY_QUESTIONS_ON_API_CHECKED","settings.notify_on_all_question_failures":"NOTIFY_ON_ALL_FAILURES_CHECKED","settings.security_questions":"SECURITY_QUESTIONS_CHECKED","settings.max_attempts":"MAX_ATTEMPTS"}),t.mapProps({table:t.flow(t.processTableInfo("rows"),t.mapProp("rows",t.flow(t.toArray,t.mapArrayProps({q:t.convert.toAppString})))),settings:t.mapProps({notify_on_all_question_failures:t.isEqual("checked"),api_with_password:t.isEqual("checked"),security_questions:t.isEqual("checked")})}))}});e.getSettings=o;var l=i.default.post({url:a,params:{action:"settings",version:"1",save:"Save",json:null},schema:{security_questions:i.default.OPTIONAL_BOOL,api_with_password:i.default.OPTIONAL_BOOL,notify_on_all_question_failures:i.default.OPTIONAL_BOOL,max_attempts:i.default.OPTIONAL_STRING}});e.updateSettings=l;var u=i.default.post({url:a,params:{action:"add"},schema:{type:i.default.REQUIRED_STRING,question:i.default.OPTIONAL_STRING,value:i.default.REQUIRED_STRING},before:function(t){var e=t.type,n=t.question;return{custom_question:"custom"===e?n:null,question:"custom"===e?null:n}}});e.addQuestion=u;var r=i.default.select({url:a,params:{delete:!0}});e.deleteQuestions=r;var c=i.default.select({url:a,params:{set:!0},schema:{value:i.default.REQUIRED_STRING}});e.updateQuestion=c;var d=i.default.post({url:"/CMD_ASK_SECURITY_QUESTION",params:{action:"submit",referer:window.location.href},schema:{answer:i.default.REQUIRED_STRING}});e.submitAnswer=d},3151:function(t,e,n){var s=n(3763);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("15311472",s,!0,{})},3761:function(t,e,n){"use strict";n.r(e);var s=n(4186),i=n(2747);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n(3762);var o=n(0),l=Object(o.a)(i.default,s.a,s.b,!1,null,"94b6c176",null);e.default=l.exports},3762:function(t,e,n){"use strict";n(3151)},3763:function(t,e,n){},3764:function(t,e){},4058:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return i}));var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",{attrs:{actions:[{label:t.$gettext("Enable"),handler:t.enable,icon:"#console",visible:!1===t.$api.settings.security_questions&&0!==t.table.rows.length},{label:t.$gettext("Disable"),handler:t.disable,icon:"#console",visible:!0===t.$api.settings.security_questions},{label:t.$gettext("Add New Security Question"),handler:t.$dialog("ADD_SECURITY_QUESTION_DIALOG").open,icon:"#plus-fill"},{label:t.$gettext("Security Questions options"),handler:t.$dialog("SECURITY_QUESTIONS_SETTINGS_DIALOG").open,icon:"#settings"}]}},[n("template",{slot:"details"},[!1===t.$api.settings.security_questions?n("ui-infobar-item",{attrs:{title:t.$gettext("Details")}},[n("translate",{staticClass:"txt:bold"},[t._v("\n                This feature is not turned on.\n            ")]),t._v(" "),0===t.table.rows.length?n("translate",{attrs:{tag:"p"}},[t._v("\n                Add one or more Security Question, and then enable it in the options at the bottom of the page.\n            ")]):t._e()],1):t._e()],1),t._v(" "),t.$api.settings.security_questions||"standard2021"===t.$_layout?t._e():n("app-page-section",[n("translate",{staticClass:"txt:bold",attrs:{tag:"p"}},[t._v("\n            This feature is not turned on.\n        ")]),t._v(" "),t.table.rows.length?t._e():n("translate",{attrs:{tag:"p"}},[t._v("\n            Add one or more Security Question, and then enable it in the options at the bottom of the page.\n        ")])],1),t._v(" "),t.table.rows.length?n("template",{slot:"header:buttons"},[t.$api.settings.security_questions?n("ui-button",{key:"disable-button",attrs:{theme:"danger"},on:{click:t.disable}},[n("translate",[t._v("Disable")])],1):n("ui-button",{key:"enable-button",attrs:{theme:"safe"},on:{click:t.enable}},[n("translate",[t._v("Enable")])],1)],1):t._e(),t._v(" "),n("app-page-section",[n("ui-api-table",t._b({on:{"action:del":t.deleteCheckedQuestions},scopedSlots:t._u([{key:"row:actions",fn:function(e){var s=e.item;return n("ui-link",{staticClass:"wrap:nowrap",on:{click:function(e){return t.handleQuestionEdit(s)}}},[n("ui-icon",{attrs:{id:"pencil",size:"medium"}}),t._v(" "),t.$_Client.isPhone?t._e():n("translate",[t._v("\n                    Change Answer\n                ")])],1)}}]),model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{command:t.$commands.getSettings,property:"table",rowID:"id",columns:{id:t.$gettext("ID"),q:{label:t.$gettext("Security Question"),grow:!0}},actions:{del:t.$gettext("Delete")},verticalLayout:t.$_Client.isPhone},!1))],1),t._v(" "),"standard2021"!==t.$_layout?n("template",{slot:"bottom:links"},[n("ui-link",{attrs:{bullet:""},on:{click:function(e){t.$dialog("ADD_SECURITY_QUESTION_DIALOG").open()}}},[n("translate",[t._v("Add New Security Question")])],1),t._v(" "),n("ui-link",{attrs:{bullet:""},on:{click:function(e){t.$dialog("SECURITY_QUESTIONS_SETTINGS_DIALOG").open()}}},[n("translate",[t._v("Security Questions options")])],1)],1):t._e(),t._v(" "),n("add-security-question-dialog",{on:{update:function(e){t.select=[]}}}),t._v(" "),n("ui-dialog",{attrs:{id:"EDIT_QUESTION_DIALOG",theme:"safe"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n            Edit question\n        ")]),t._v(" "),n("ui-form-element",{attrs:{slot:"content",vertical:""},slot:"content"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                New answer:\n            ")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.newAnswer,callback:function(e){t.newAnswer=e},expression:"newAnswer"}})],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe",disabled:!t.newAnswer},on:{click:t.handleAnswerSave},slot:"buttons"},[n("translate",[t._v("Save")])],1)],1),t._v(" "),n("ui-dialog",{attrs:{id:"SECURITY_QUESTIONS_SETTINGS_DIALOG",theme:"primary",size:"normal"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n            Security Questions options\n        ")]),t._v(" "),n("template",{slot:"content"},[n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.settings.api_with_password,callback:function(e){t.$set(t.settings,"api_with_password",e)},expression:"settings.api_with_password"}},[n("translate",[t._v("Allow API logins with the current User/password. Login Keys and Session Keys are always allowed.")])],1)],1),t._v(" "),n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.settings.notify_on_all_question_failures,callback:function(e){t.$set(t.settings,"notify_on_all_question_failures",e)},expression:"settings.notify_on_all_question_failures"}},[n("translate",{attrs:{"translate-params":{count:t.settings.max_attempts}}},[t._v("\n                        Notify me on all failed question attempts. Disabling this option will still notify you after %{ count } failed attempts.\n                    ")])],1)],1)],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe"},on:{click:t.saveSettings},slot:"buttons"},[n("translate",[t._v("Save")])],1)],2)],2)},i=[]},4186:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return i}));var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{id:"ADD_SECURITY_QUESTION_DIALOG",size:"normal"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Add Security Question")]),t._v(" "),n("ui-tabs",{attrs:{slot:"content",radio:"",tabs:[{id:"included",label:t.$gettext("Included")},{id:"custom",label:t.$gettext("Custom")}],selected:t.type},on:{"update:selected":function(e){t.type=e}},slot:"content"},[n("ui-form-element",{attrs:{slot:"tab:included",group:"securityQuestion",validators:{required:!0},underline:!1},slot:"tab:included"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Question")]),t._v(" "),n("input-select",{attrs:{slot:"content",options:t.$api.questions},slot:"content",model:{value:t.question,callback:function(e){t.question=e},expression:"question"}})],1),t._v(" "),n("ui-form-element",{attrs:{slot:"tab:custom",group:"securityQuestion",validators:{required:!0},underline:!1},slot:"tab:custom"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Question")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.question,callback:function(e){t.question=e},expression:"question"}})],1)],1),t._v(" "),n("ui-form-element",{attrs:{slot:"content",group:"securityQuestion",validators:{required:!0,maxLength:64},underline:!1},slot:"content"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Answer")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe",validateGroup:"securityQuestion"},on:{click:t.addQuestion},slot:"buttons"},[n("translate",[t._v("Add")])],1)],1)},i=[]}}]);