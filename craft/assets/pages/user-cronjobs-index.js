(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[4853],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.symbol.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o("./node_modules/core-js/modules/es.object.define-properties.js"),o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/es.weak-map.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=o("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var l=s(o("./node_modules/@babel/runtime/regenerator/index.js")),a=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),r=s(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));o("./node_modules/core-js/modules/es.array.map.js");var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var o=u(t);if(o&&o.has(e))return o.get(e);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var r=l?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(s,a,r):s[a]=e[a]}s.default=e,o&&o.set(e,s);return s}(o("./src/js/api/commands/user/cronjobs.ts"));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(u=function(e){return e?o:t})(e)}function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){(0,a.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var m,p,b,_={preload:function(){return i.getCronjobs()},api:[{command:i.getCronjobs,bind:"cronjobs"}],data:function(){return{checkedRows:[],editableRow:{},email:""}},computed:{checkedJobs:function(){return this.checkedRows.map((function(e){return e.id}))}},created:function(){this.email=this.$api.cronjobs.email},methods:{loadData:function(){i.getCronjobs()},deleteJobs:(b=(0,r.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.deleteCronjobs({select:this.checkedJobs});case 2:e.sent&&(this.checkedRows=[],this.clearEditable(),this.loadData());case 4:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),saveEmail:(p=(0,r.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.saveEmail({email:this.email}),this.$dialog("SEND_TO_EMAIL").close();case 2:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),setEditable:function(e){this.editableRow=c({},e),this.$dialog("EDIT_CRON_JOB").open()},clearEditable:function(){this.editableRow={},this.$dialog("EDIT_CRON_JOB").close()},updateJob:(m=(0,r.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("@reboot"!==this.editableRow.minute){e.next=5;break}return e.next=3,i.updateCronjobReboot(this.editableRow);case 3:e.next=7;break;case 5:return e.next=7,i.updateCronjob(c(c({},this.editableRow),{},{dayofmonth:this.editableRow.day_of_month,dayofweek:this.editableRow.day_of_week}));case 7:this.clearEditable(),this.loadData();case 9:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})}};t.Z=_},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=style&index=0&lang=scss&":function(){},"./src/js/api/commands/user/cronjobs.ts":function(e,t,o){"use strict";o.r(t),o.d(t,{getCronjobs:function(){return a},deleteCronjobs:function(){return r},createCronjob:function(){return i},updateCronjobReboot:function(){return d},updateCronjob:function(){return c},saveEmail:function(){return m},getPhpBinPath:function(){return p}});var s=o("./src/js/api/command/index.js"),n=o("./node_modules/ramda/es/index.js"),l="/CMD_CRON_JOBS",a=s.default.get({url:l,id:"CRON_JOBS",params:{ipp:"99999",page:"1"},mapResponse:{email:n.prop("MAILTO"),rows:n.pipe(n.prop("crons"),n.omit(["info"]),n.values)}}),r=s.default.select({url:l,params:{action:"delete",delete:!0}}),i=s.default.post({url:l,params:{action:"create"},schema:{reboot:s.default.REQUIRED_BOOL,minute:s.default.REQUIRED_STRING,hour:s.default.REQUIRED_STRING,dayofmonth:s.default.REQUIRED_STRING,month:s.default.REQUIRED_STRING,dayofweek:s.default.REQUIRED_STRING}}),u=s.default.post({url:l,params:{save:!0},schema:{id:s.default.REQUIRED_STRING,command:s.default.REQUIRED_STRING}}),d=u.extend({url:l,params:{reboot:!0}}),c=u.extend({url:l,schema:{minute:s.default.REQUIRED_STRING,hour:s.default.REQUIRED_STRING,dayofmonth:s.default.REQUIRED_STRING,month:s.default.REQUIRED_STRING,dayofweek:s.default.REQUIRED_STRING}}),m=s.default.post({url:l,params:{action:"saveemail"},schema:{email:s.default.REQUIRED_STRING}}),p=s.default.get({url:l,id:"CRON_PHP_BIN_PATH",response:!1,mapResponse:function(e){return"1"===e.set_php_bin_path_in_crons}})},"./src/js/pages/user/cronjobs/index.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return s.X},default:function(){return u}});var s=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=script&lang=js&"),n=s.Z,l=(o("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=style&index=0&lang=scss&"),o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),a=o("./src/js/pages/user/cronjobs/index.vue?vue&type=custom&index=0&blockType=route"),r=o.n(a),i=(0,l.Z)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page",{attrs:{actions:[{name:"user/cronjobs/create",label:e.$gettext("Create Cron Job"),icon:"#plus-fill",theme:"primary"},{handler:e.$dialog("SEND_TO_EMAIL").open,label:e.$gettext("Send all Cron output to e-mail"),icon:"#email-manager"}]}},[o("template",{slot:"header:buttons"},[o("ui-button-link",{attrs:{theme:"primary",name:"user/cronjobs/create"}},[o("translate",[e._v("Create Cron job")])],1)],1),e._v(" "),o("app-page-section",[o("ui-r-table",e._b({staticClass:"cronjobs",attrs:{"rows-count":e.$api.cronjobs.rows.length,"checked-rows":e.checkedRows,columns:[{id:"minute",label:e.$gettext("Minute")},{id:"hour",label:e.$gettext("Hour")},{id:"day_of_month",label:e.$gettext("Day of Month")},{id:"month",label:e.$gettext("Month")},{id:"day_of_week",label:e.$gettext("Day of Week")},{id:"command",label:e.$gettext("Command"),grow:!0}],editable:!1,"vertical-layout":e.$_Client.isPhone,"disable-pagination":""},on:{"update:checkedRows":function(t){e.checkedRows=t},"update:checked-rows":function(t){e.checkedRows=t}},scopedSlots:e._u([{key:"row:actions",fn:function(t){var s=t.item;return[o("ui-button-icon",{attrs:{icon:"pencil",title:e.$gettext("Edit")},on:{click:function(t){return e.setEditable(s)}}})]}},{key:"col:command",fn:function(t){var s=t.command;return[o("span",{staticClass:"wrap",domProps:{textContent:e._s(s)}})]}}])},"ui-r-table",e.$api.cronjobs,!1),[o("template",{slot:"table:actions"},[o("ui-table-action",{on:{click:function(t){e.$dialog("DELETE_ITEMS_DIALOG").open()}}},[o("translate",[e._v("Delete")])],1)],1)],2)],1),e._v(" "),o("template",{slot:"bottom:links"},["standard2021"!==e.$_layout?o("ui-link",{attrs:{bullet:""},on:{click:function(t){e.$dialog("SEND_TO_EMAIL").open()}}},[o("translate",[e._v("Send all Cron output to e-mail")])],1):e._e()],1),e._v(" "),o("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("Cron job","Cron jobs",e.checkedJobs.length)},on:{"click:confirm":e.deleteJobs}}),e._v(" "),o("ui-dialog",{attrs:{id:"SEND_TO_EMAIL"}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Set E-mail\n        ")]),e._v(" "),o("ui-form-element",{attrs:{slot:"content",vertical:""},slot:"content"},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                E-mail\n            ")]),e._v(" "),o("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[e._v("\n                Valid values are an E-mail address, your DA username: admin,\n                or a blank field to prevent any e-mail.\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveEmail.apply(null,arguments)}},slot:"content",model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"safe"},on:{click:e.saveEmail},slot:"buttons"},[o("translate",[e._v("Save")])],1)],1),e._v(" "),o("ui-dialog",{attrs:{id:"EDIT_CRON_JOB",theme:"safe",size:"normal"}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Edit Cron Job\n        ")]),e._v(" "),o("template",{slot:"content"},["@reboot"!==e.editableRow.minute?[o("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}}},[o("template",{slot:"title"},[o("translate",[e._v("\n                            Minute\n                        ")]),e._v(" "),o("ui-tooltip",[o("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[o("translate",[e._v("\n                                    Valid Cron time values are the numbers\n                                    indicated and *.\n                                ")]),e._v(" "),o("translate",[e._v("\n                                    You can specify exact times using commas\n                                    to separate them. e.g. 1,2,3 (minutes\n                                    1,2 and 3)\n                                ")]),e._v(" "),o("translate",[e._v("\n                                    You can specify spans using a dash. e.g.\n                                    5-7 (minutes 5 to 7)\n                                ")]),e._v(" "),o("translate",[e._v("\n                                    You can specify intervals using a star\n                                    and a forward slash. e.g. */2 (every 2nd\n                                    minute)\n                                ")]),e._v(" "),o("translate",[e._v("\n                                    You can combine them to create a more\n                                    precise schedule. e.g. 1,5,11-15,30-59/2\n                                    (minutes 1, 5, 11 to 15 and every 2nd\n                                    minute between 30 and 59)\n                                ")]),e._v(" "),o("translate",[e._v("\n                                    Note that there are no spaces\n                                ")])],1)])],1),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.editableRow.minute,callback:function(t){e.$set(e.editableRow,"minute",t)},expression:"editableRow.minute"}}),e._v(" "),o("translate",{attrs:{slot:"error:between"},slot:"error:between"},[e._v("\n                        Minute should be a number between 0 and 59 or *\n                    ")])],2),e._v(" "),o("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Hour\n                    ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.editableRow.hour,callback:function(t){e.$set(e.editableRow,"hour",t)},expression:"editableRow.hour"}}),e._v(" "),o("translate",{attrs:{slot:"error:between"},slot:"error:between"},[e._v("\n                        Hour should be a number between 0 and 23 or *\n                    ")])],1),e._v(" "),o("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Day of Month\n                    ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.editableRow.day_of_month,callback:function(t){e.$set(e.editableRow,"day_of_month",t)},expression:"editableRow.day_of_month"}})],1),e._v(" "),o("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Month\n                    ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.editableRow.month,callback:function(t){e.$set(e.editableRow,"month",t)},expression:"editableRow.month"}})],1),e._v(" "),o("ui-form-element",{attrs:{vertical:""}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Day of Week\n                    ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.editableRow.day_of_week,callback:function(t){e.$set(e.editableRow,"day_of_week",t)},expression:"editableRow.day_of_week"}})],1)]:e._e(),e._v(" "),o("ui-form-element",{attrs:{vertical:""}},[o("template",{slot:"title"},[o("translate",[e._v("Command")]),e._v(" "),o("ui-tooltip",[o("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[o("translate",[e._v("\n                                To access a specific URL periodically use a command like:\n                            ")]),e._v("\n                            curl -L -s https://example.com/cron.php\n                        ")],1)])],1),e._v(" "),o("input-textarea",{attrs:{slot:"content",type:"text"},slot:"content",model:{value:e.editableRow.command,callback:function(t){e.$set(e.editableRow,"command",t)},expression:"editableRow.command"}})],2)],2),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"primary","validate-group":"modifyCronJob"},on:{click:e.updateJob},slot:"buttons"},[o("translate",[e._v("Save")])],1)],2)],2)}),[],!1,null,null,null);"function"==typeof r()&&r()(i);var u=i.exports},"./src/js/pages/user/cronjobs/index.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=style&index=0&lang=scss&":function(e,t,o){var s=o("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/cronjobs/index.vue?vue&type=style&index=0&lang=scss&");s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,o("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("476ac541",s,!0,{})}}]);