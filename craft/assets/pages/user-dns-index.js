(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[3831],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_dialogs/override-ttl-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var o,r=n(s("./node_modules/@babel/runtime/regenerator/index.js")),i=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),a=s("./src/js/api/commands/dns/index.js"),l={data:function(){return{select:"default",value:"14400"}},api:[{command:a.getRecords,bind:"dns"}],computed:{ttl:function(){return this.$api.dns.ttl}},methods:{initData:function(){this.value=this.ttl.value,this.select=this.ttl.overridden?"custom":"default"},updateTTLOptions:(o=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.updateTTL)({ttl_select:this.select,ttl:this.value});case 2:this.$emit("update");case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})}};t.Z=l},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/index.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.promise.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.array.map.js");var o=s("./src/js/store/index.js"),r=s("./src/js/api/commands/dns/index.js"),i=s("./src/js/api/commands/user/domain-pointers.ts"),a=n(s("./src/js/components/local/dns/records-table.vue")),l=n(s("./src/js/pages/user/dns/_dialogs/override-ttl-dialog.vue")),d={name:"DnsRecords",preload:function(e){var t=[];t.push((0,r.getRecords)({ptr:e.pointer||null}));var s=o.Store.getters["session/allowedCommands"].includes("/CMD_DOMAIN_POINTER"),n=o.Store.getters["session/userUsageFlags"].domainPointers;return s&&n&&t.push((0,i.getPointers)({ipp:99999})),Promise.all(t)},api:[{command:r.getRecords,bind:"dns"},{command:i.getPointers,bind:"pointers"}],commands:{getRecords:r.getRecords},components:{DnsRecordsTable:a.default,OverrideTtlDialog:l.default},computed:{dnssecAllowed:function(){return"user"===this.$state.app.user.level?this.$api.dns.options.user_dnssec_control:this.$api.dns.options.dnssec},pointer:function(){return this.$route.query.pointer||null},pointers:function(){return 0===Object.keys(this.$api.pointers).length?[]:this.$api.pointers.rows.map((function(e){return e.domain_pointer}))},enableTtlEdit:function(){return!this.$api.dns.ttl.overriden&&this.$api.dns.options.dns_ttl},haveAffectPointers:function(){return this.$_session.usage.autoresponders.usage&&!this.pointer},loggedAs:function(){return this.$state.session.realUsername!==this.$state.session.effectiveUsername},haveNS:function(){return this.loggedAs?"0"!==this.$api.dns.options.dns_ns:"2"===this.$api.dns.options.dns_ns},havePTR:function(){return this.loggedAs?"0"!==this.$api.dns.options.dns_ptr:"2"===this.$api.dns.options.dns_ptr}},methods:{loadRecords:function(){(0,r.getRecords)({ptr:this.pointer})}}};t.Z=d},"./src/js/api/commands/user/domain-pointers.ts":function(e,t,s){"use strict";s.r(t),s.d(t,{getAppPointers:function(){return i},getPointers:function(){return a},createPointer:function(){return l},deletePointers:function(){return d},setLocal:function(){return u},setRemote:function(){return c}});var n=s("./src/js/api/command/index.js"),o=s("./node_modules/ramda/es/index.js"),r=s("./src/js/api/commands/converters/index.ts"),i=o.pipe(o.prop("domain_pointers"),(0,r.toTable)((function(e){return{domain_pointer:e.domain_pointer,type:e.type,mail:"yes"===e.local_mail?"local":"remote"}}))),a=n.default.get({id:"DOMAIN_POINTERS",url:"/CMD_DOMAIN_POINTER",domain:!0,pagination:!0,mapResponse:i}),l=n.default.post({url:"/CMD_DOMAIN_POINTER",params:{action:"add"},domain:!0,schema:{from:n.default.REQUIRED_STRING,alias:n.default.REQUIRED_BOOL}}),d=n.default.select({url:"/CMD_DOMAIN_POINTER",params:{action:"delete"},domain:!0}),u=d.extend({params:{local_mail:!0}}),c=d.extend({params:{remote_mail:!0}})},"./src/js/pages/user/dns/_dialogs/override-ttl-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return r}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_dialogs/override-ttl-dialog.vue?vue&type=script&lang=js&"),o=n.Z,r=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"OVERRIDE_TTL_DIALOG",theme:"primary"},on:{"dialog:open":e.initData}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Override TTL\n    ")]),e._v(" "),s("ui-form-element",{attrs:{slot:"content",vertical:""},slot:"content"},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            TTL Value\n        ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:{default:e.$gettext("Default"),custom:e.$gettext("Custom")}},slot:"content",model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},[s("input-text",{attrs:{slot:"additions:right",number:"",disabled:"default"===e.select,value:"default"===e.select?e.ttl.default:e.value},on:{input:function(t){e.value=t}},slot:"additions:right"})],1)],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"primary"},on:{click:e.updateTTLOptions},slot:"buttons"},[s("translate",[e._v("Save")])],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/user/dns/index.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return d}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/index.vue?vue&type=script&lang=js&"),o=n.Z,r=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),i=s("./src/js/pages/user/dns/index.vue?vue&type=custom&index=0&blockType=route"),a=s.n(i),l=(0,r.Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:e.$api.dns.ttl.alllow?[{label:e.$gettext("Override TTL Value"),handler:e.$dialog("OVERRIDE_TTL_DIALOG").open,icon:"#plus-fill"}]:[]}},[e.$api.dns.ttl.allow?s("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(t){e.$dialog("OVERRIDE_TTL_DIALOG").open()}},slot:"header:buttons"},[s("translate",[e._v("Override TTL Value")])],1):e._e(),e._v(" "),s("app-page-section",[s("dns-records-table",e._b({attrs:{records:e.$api.dns.records,domain:e.$domain,pointer:e.pointer,pointers:e.pointers,"disable-t-t-l-input":!e.enableTtlEdit,"enable-t-t-l":e.$api.dns.options.dns_ttl,dns_ns:e.haveNS,dns_ptr:e.havePTR,"affect-pointers-default":e.$api.dns.affectPointersDefault,"has-affect-pointers":e.haveAffectPointers},on:{"rows:update":e.loadRecords}},"dns-records-table",e.$api.dns.options,!1))],1),e._v(" "),s("template",{slot:"bottom:links"},[e.pointer?e._e():s("ui-link",{attrs:{name:"user/dns/mx-records",bullet:""}},[s("translate",[e._v("Modify MX Records")])],1),e._v(" "),e.dnssecAllowed?s("ui-link",{attrs:{name:"user/dns/security",query:e.pointer?{pointer:e.pointer}:{},bullet:""}},[s("translate",[e._v("DNSSEC")])],1):e._e()],1),e._v(" "),s("override-ttl-dialog",{on:{update:e.loadRecords}})],2)}),[],!1,null,null,null);"function"==typeof a()&&a()(l);var d=l.exports},"./src/js/pages/user/dns/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);