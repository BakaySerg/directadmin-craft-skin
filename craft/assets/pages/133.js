(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{1788:function(t,e,r){"use strict";r.r(e);var n=r(3987),a=r(2390);for(var o in a)["default"].indexOf(o)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(o);var s=r(0),i=r(3465),u=r.n(i),c=Object(s.a)(a.default,n.a,n.b,!1,null,null,null);"function"==typeof u.a&&u()(c),e.default=c.exports},1886:function(t,e,r){"use strict";r.r(e),r.d(e,"preload",(function(){return w})),r.d(e,"GET",(function(){return E})),r.d(e,"POST",(function(){return x})),r.d(e,"PUT",(function(){return S})),r.d(e,"PATCH",(function(){return A})),r.d(e,"DELETE",(function(){return D})),r.d(e,"$gettext",(function(){return k}));var n=r(30),a=r.n(n),o=r(28),s=r(9),i=r(1893),u=r(1894),c=r(13),l=new a.a,p={401:"UNAUTHORIZED",404:"ENDPOINT_NOT_FOUND",405:"METHOD_NOT_ALLOWED"},f={BAD_REQUEST:l.$gettext("Bad Request: %{ message }"),UNAUTHORIZED:l.$gettext("Unauthorized"),ACCESS_DENIED:l.$gettext("Access Denied"),INTERNAL_ERROR:l.$gettext("Server Error: %{ message }"),METHOD_NOT_ALLOWED:l.$gettext("Method Not Allowed"),ENDPOINT_NOT_FOUND:l.$gettext("Endpoint Not Found")},d=function(t,e,r){void 0===r&&(r={});var n=l.$gettextInterpolate(e,r||{});return{status:t,message:n,type:r.type,data:s.omit(["type"],r),notify:function(){return o.Store.dispatch("notifications/NOTIFY",{theme:"danger",title:l.$gettext("Error"),content:n,route:o.Store.state.app.route.path||"/",time:new Date})}}},m=function(t,e,r,n){return new(r||(r=Promise))((function(a,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function i(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,i)}u((n=n.apply(t,e||[])).next())}))},h=function(t,e){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},v={data:{},statusCodes:{},errorMessages:{}},y=function(t,e,r){void 0===r&&(r={});var n=function(t,e){return(t+"_"+e.slice(5).replace(/\//,"_").replace(/\:/,"")).toUpperCase()}(t,e);r=s.mergeDeepRight(v,r);var a=Object(u.registerEndpoint)(n,r.data);return{endpoint:a,request:function(s){return m(void 0,void 0,void 0,(function(){var u,m,v;return h(this,(function(h){switch(h.label){case 0:return o.Store&&o.Store.state.commands.blockingRequest?[4,o.Store.state.commands.blockingRequest]:[3,2];case 1:h.sent(),h.label=2;case 2:a.params=s||{},a.state={isLoading:!0},h.label=3;case 3:return h.trys.push([3,5,,6]),[4,Object(i.request)({endpointID:n,url:e,method:t},a.params)];case 4:return u=h.sent(),"get"===t&&(a.data=u.data),a.state={isOk:!0,isDone:!0,isLoading:!1,error:null},[2,{state:"success",data:u.data,error:null}];case 5:return m=h.sent(),401===(v=function(t,e,r){var n;void 0===e&&(e={}),void 0===r&&(r={});var a=Object.assign(e,p),o=Object.assign(r,f);if(t.response){if(t.response.data&&t.response.data.type)if(void 0!==o[(s=t.response.data).type])return d(t.response.status,o[s.type],s);if(a[t.response.status]){var s={type:a[t.response.status]};t.response.data=s;var i=a[t.response.status];if(i&&o[i])return d(t.response.status,o[i],{type:i})}}else if(t.request)return c.emitter.emit("request:networkerror"),d(-1,l.$gettext("Network Error: Server is unreachable"),{type:"NETWORK_UNREACHABLE"});return d((null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.status)||-1,l.$gettext("Unknown Error"),{type:"UNKNOWN_ERROR"})}(m,r.statusCodes,r.errorMessages)).status&&window.location.reload(),a.state={isOk:!1,isDone:!0,isLoading:!1,error:v},[2,{state:"error",error:v,data:null}];case 6:return[2]}}))}))}}},b=function(t,e,r){void 0===r&&(r={});var n=y(t,e,r),a=n.endpoint,o=n.request;return Object.freeze({get params(){return a.params},get state(){return a.state},request:o})},g=function(t,e,r,n){return new(r||(r=Promise))((function(a,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function i(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,i)}u((n=n.apply(t,e||[])).next())}))},_=function(t,e){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},O=function(t,e){return t.notify(),e(!1)},w=function(t,e){return void 0===e&&(e=O),function(r,n,a){return g(void 0,void 0,void 0,(function(){var o,s,i;return _(this,(function(u){switch(u.label){case 0:return[4,Promise.all(t.map((function(t){return t(r,n)})))];case 1:return o=u.sent(),void 0!==(s=o.find((function(t){return"error"===t.state})))?(i=s.error,[2,e(i,a)]):(a(),[2])}}))}))}},E=function(t,e){return function(t,e,r){void 0===r&&(r={});var n=y(t,e,r),a=n.endpoint,o=n.request;return Object.freeze({get data(){return a.data},set data(t){a.data=t},get params(){return a.params},get state(){return a.state},request:o,bindData:function(t){return function(){return t?t(a.data):a.data}}})}("get",t,e)},x=function(t,e){return b("post",t,e)},S=function(t,e){return b("put",t,e)},A=function(t,e){return b("patch",t,e)},D=function(t,e){return b("delete",t,e)},k=(new a.a).$gettext},1893:function(t,e,r){"use strict";r(16),r(14),r(23),r(25),r(18),r(6);var n=r(1),a=r(19);Object.defineProperty(e,"__esModule",{value:!0}),e.request=void 0;var o=n(r(36)),s=n(r(37));r(12),r(15),r(21),r(40),r(84);var i=n(r(505)),u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var r=p(e);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var i=o?Object.getOwnPropertyDescriptor(t,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=t[s]}n.default=t,r&&r.set(t,n);return n}(r(9)),c=r(31),l=r(28);function p(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(p=function(t){return t?r:e})(t)}var f=i.default.create({baseURL:"/api"});f.interceptors.request.use(u.mergeDeepRight({timeout:0,headers:{Accept:"application/json","Content-Type":"application/json",Pragma:"no-cache"}}));var d,m=function(t,e){if(t.includes(":")){var r=[];return{url:t.replace(/:[a-z]*/g,(function(t){if(":domain"===t&&!e.domain)return l.Store.state.app.domain;t=t.slice(1);var n=e[t];if(void 0===n)throw new Error("EndpointParamError: ".concat(t," is not defined"));return r.push(t),n})),urlParams:r}}return{url:t,urlParams:[]}},h=(d=(0,s.default)(o.default.mark((function t(e,r){var n,a,s,i,l,p,d;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e.url){t.next=2;break}throw new Error("Unsupported URL format");case 2:return n=m(e.url,r),a=n.url,s=n.urlParams,i={endpointID:e.endpointID,url:a,method:e.method},l=u.omit(s,r),!1===u.isEmpty(l)&&(p="get"===e.method?"params":"data",i[p]=l),t.prev=6,t.next=9,f.request(i);case 9:return t.abrupt("return",t.sent);case 12:throw t.prev=12,t.t0=t.catch(6),c.ENV.DEV&&(console.group(),console.dir(i),d=i.params||i.data,console.table({"Endpoint ID":i.endpointID,Url:i.url,Method:i.method,"Request Data":JSON.stringify(d),"Response Status Code":t.t0.response.status,"Response Data":JSON.stringify(t.t0.response.data)}),console.groupEnd()),t.t0;case 16:case"end":return t.stop()}}),t,null,[[6,12]])}))),function(t,e){return d.apply(this,arguments)});e.request=h},1894:function(t,e,r){"use strict";r(16),r(14),r(23),r(25),r(18),r(6);var n=r(19);Object.defineProperty(e,"__esModule",{value:!0}),e.registerEndpoint=void 0,r(49);var a=r(28),o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var r=s(e);if(r&&r.has(t))return r.get(t);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var u=o?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=t[i]}a.default=t,r&&r.set(t,a);return a}(r(9));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(s=function(t){return t?r:e})(t)}e.registerEndpoint=function(t,e){return a.Store.commit("endpoints/REGISTER_ENDPOINT",{id:t,data:e}),{get data(){return o.clone(a.Store.state.endpoints[t].data)},set data(e){a.Store.commit("endpoints/SET_DATA",{id:t,data:e})},get state(){return a.Store.state.endpoints[t].state},set state(e){a.Store.commit("endpoints/SET_STATE",{id:t,state:Object.assign({},{isLoading:!1,isOk:!1,isError:!1,error:null},e)})},get params(){return o.clone(a.Store.state.endpoints[t].params)},set params(e){a.Store.commit("endpoints/SET_PARAMS",{id:t,params:e})}}}},2390:function(t,e,r){"use strict";r.r(e);var n=r(2391),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(o);e.default=a.a},2391:function(t,e,r){"use strict";var n=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r(8);var a,o,s,i,u,c=n(r(36)),l=n(r(37)),p=r(3464),f={beforeRouteEnter:(0,r(1886).preload)([function(){return p.getClamAV.request()}]),data:function(){return{currentItem:{},query:{path:""},type:"home",refreshTimeout:3e4,refresh:!0}},computed:{clamavList:p.getClamAV.bindData()},mounted:function(){this.refreshList()},beforeDestroy:function(){clearTimeout(this.timeoutId)},methods:{startScan:(u=(0,l.default)(c.default.mark((function t(){var e,r=this;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=["Maildir","imap"],t.t0=this.type,t.next="home"===t.t0?4:"domains"===t.t0?6:"mail"===t.t0?8:"custom"===t.t0?10:13;break;case 4:return this.createScan(""),t.abrupt("break",13);case 6:return this.createScan("domains"),t.abrupt("break",13);case 8:return e.forEach((function(t){r.createScan(t)})),t.abrupt("break",13);case 10:return this.createScan(this.query.path),this.query.path="",t.abrupt("break",13);case 13:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)}),createScan:(i=(0,l.default)(c.default.mark((function t(e){var r,n;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.postClamAV.request({path:e});case 2:r=t.sent,(n=r.error)?n.notify():(this.$notifications.success({title:this.$gettext("Start"),content:this.$gettext("Directory scan process started")}),p.getClamAV.request());case 5:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)}),deleteProcessBefore:(s=(0,l.default)(c.default.mark((function t(e){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.currentItem=e,this.$dialog("DELETE_ITEMS_DIALOG").open();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)}),deleteProcessAfter:(o=(0,l.default)(c.default.mark((function t(){var e,r;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.deleteClamAV.request({pid:this.currentItem.pid});case 2:e=t.sent,(r=e.error)?"CLAMAV_PROCESS_NOT_FOUND"==r.type?this.$notifications.success({title:this.$gettext("Cancel"),content:r.message}):r.notify():(this.$notifications.success({title:this.$gettext("Cancel"),content:this.$gettext("Directory scan process canceled")}),p.getClamAV.request());case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),refreshList:(a=(0,l.default)(c.default.mark((function t(){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.refresh){t.next=3;break}return t.next=3,p.getClamAV.request();case 3:this.timeoutId=setTimeout(this.refreshList,this.refreshTimeout);case 4:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})}};e.default=f},3464:function(t,e,r){"use strict";r.r(e),r.d(e,"getClamAV",(function(){return a})),r.d(e,"postClamAV",(function(){return o})),r.d(e,"deleteClamAV",(function(){return s}));var n=r(1886),a=Object(n.GET)("/clamav"),o=Object(n.POST)("/clamav",{statusCodes:{409:"CLAMAV_PATH_NOT_FOUND",501:"CLAMAV_SCAN_LIMIT_ERROR"},errorMessages:{CLAMAV_PATH_NOT_FOUND:Object(n.$gettext)("ClamAV path was not found"),CLAMAV_SCAN_LIMIT_ERROR:Object(n.$gettext)("This path is already being scanned by ClamAV")}}),s=Object(n.DELETE)("/clamav/:pid",{statusCodes:{409:"CLAMAV_PROCESS_NOT_FOUND"},errorMessages:{CLAMAV_PROCESS_NOT_FOUND:Object(n.$gettext)("ClamAV process does not exist anymore")}})},3465:function(t,e){},3987:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return a}));var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("app-page",[r("app-page-section",[r("translate",{attrs:{slot:"section:title"},slot:"section:title"},[t._v("\n            Scan directory to detect malware and other malicious threats.\n        ")]),t._v(" "),r("ui-form-element",{attrs:{underline:!1}},[r("input-radio",{attrs:{slot:"content",value:"home"},slot:"content",model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[r("translate",[t._v("\n                    Home - Scan the home directory.\n                ")])],1)],1),t._v(" "),r("ui-form-element",{attrs:{underline:!1}},[r("input-radio",{attrs:{slot:"content",value:"domains"},slot:"content",model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[r("translate",[t._v("\n                    Domains - Scan the domains directory.\n                ")])],1)],1),t._v(" "),r("ui-form-element",{attrs:{underline:!1}},[r("input-radio",{attrs:{slot:"content",value:"mail"},slot:"content",model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[r("translate",[t._v("\n                    Mail - Scan all mail directories.\n                ")])],1)],1),t._v(" "),r("ui-form-element",[r("input-radio",{attrs:{slot:"title",value:"custom"},slot:"title",model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[r("translate",[t._v("\n                    Custom - Scan the desired path. \n                ")])],1),t._v(" "),r("input-text",{attrs:{slot:"content",disabled:"custom"!==t.type,prefix:t.$state.app.tokens.HOME_DIR+"/"},slot:"content",model:{value:t.query.path,callback:function(e){t.$set(t.query,"path",e)},expression:"query.path"}})],1),t._v(" "),r("ui-button",{attrs:{slot:"footer:buttons",theme:"primary","validate-group":"job-init"},on:{click:t.startScan},slot:"footer:buttons"},[r("translate",[t._v("Scan Path")])],1)],1),t._v(" "),t.clamavList.processes?r("app-page-section",[r("translate",{attrs:{slot:"section:title"},slot:"section:title"},[t._v("\n            List of currently active scans.\n        ")]),t._v(" "),r("ui-r-table",t._b({attrs:{"disable-pagination":""},scopedSlots:t._u([{key:"col:start_time",fn:function(e){var r=e.start_time;return[t._v("\n                "+t._s(t._f("date")(new Date(r)))+"\n            ")]}},{key:"row:actions",fn:function(e){var n=e.item;return r("ui-button-icon",{attrs:{theme:"danger",icon:"cancel",title:t.$gettext("Cancel")},on:{click:function(e){return t.deleteProcessBefore(n)}}})}}],null,!1,968175764)},"ui-r-table",{rows:t.clamavList.processes,columns:[{id:"pid",label:t.$gettext("PID")},{id:"path",label:t.$gettext("Path")},{id:"start_time",label:t.$gettext("Start time")}],verticalLayout:t.$_Client.isPhone,isCheckable:!1},!1))],1):t._e(),t._v(" "),r("app-page-section",[r("div",{attrs:{slot:"section:title"},slot:"section:title"},[r("translate",[t._v("\n                Read finished scan reports in the \n            ")]),t._v(" "),r("ui-link",{attrs:{path:"/user/messages"}},[r("translate",[t._v("Message Area")])],1)],1)]),t._v(" "),r("ui-dialog-delete-items",{attrs:{subject:t.$gettext("process")},on:{"click:confirm":function(e){return t.deleteProcessAfter()}}},[t._v("\n        "+t._s(t.currentItem.name)+"\n    ")])],1)},a=[]}}]);