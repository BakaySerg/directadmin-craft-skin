(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{1761:function(t,e,r){"use strict";r.r(e);var s=r(3960),o=r(2269);for(var n in o)["default"].indexOf(n)<0&&function(t){r.d(e,t,(function(){return o[t]}))}(n);r(3363);var a=r(0),i=r(3365),l=r.n(i),p=Object(a.a)(o.default,s.a,s.b,!1,null,"3ca175f8",null);"function"==typeof l.a&&l()(p),e.default=p.exports},1924:function(t,e,r){"use strict";r(7),r(10),r(6),r(8),r(11);var s=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.updateCron=e.getCron=e.restoreBackup=e.getRestoreFiles=e.scheduleBackup=e.getRestoreOptions=e.getScheduleOptions=e.getSettings=e.updateSettings=e.deleteCrons=e.duplicateCrons=e.getEncryptionStatus=e.hasResellerCrons=e.getCrons=void 0;var o=s(r(2));r(86),r(21),r(40),r(50),r(57),r(27),r(5);var n=s(r(78));function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){(0,o.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var l="/CMD_USER_BACKUP",p=n.default.get({id:"USER_BACKUPS",url:l,after:function(t){return t.flow((function(t){return{rows:t.crons,location:t.files_location}}),t.processTableInfo("rows"),t.mapProps({rows:t.flow(t.toArray,t.mapArrayProps({where:t.flow(t.moveProp("encryption_password","encrypted"),t.mapProps({encrypted:t.flow(t.setDefault("0"),t.isEqual("1")),path:function(t){return t.replace("<span class='green_lock'>&#128274;</span>","").trim()}}))}))}))}});e.getCrons=p;var u=n.default.get({id:"HAS_USER_BACKUPS",url:l,response:!1,mapResponse:function(t){return 0!==t.crons.length}});e.hasResellerCrons=u;var c=n.default.get({id:"BACKUP_ENCRYPTION_STATUS",url:l,after:function(t){return t.flow(t.project({enabled:"settings.allow_backup_encryption",password:"settings.encryption_password"}),t.mapProp("enabled",t.convert.toAppBoolean))}});e.getEncryptionStatus=c;var f=n.default.select({url:l,params:{duplicate:!0}});e.duplicateCrons=f;var d=n.default.select({url:l,params:{delete:!0}});e.deleteCrons=d;var _=n.default.post({url:l,params:{action:"setting"},schema:{message:n.default.REQUIRED_BOOL,local_ns:n.default.REQUIRED_BOOL,restore_spf:n.default.REQUIRED_BOOL}});e.updateSettings=_;var h=n.default.get({id:"USER_BACKUP_SETTINGS",url:l,after:function(t){return t.flow(t.project({local_ns:"settings.local_ns",message:"settings.message",restore_spf:"settings.restore_spf"}),t.mapValues(t.convert.toAppBoolean))}});e.getSettings=h;var v=n.default.get({id:"USER_BACKUP_SCHEDULE_OPTIONS",url:l,after:function(t){return t.flow(t.project({settings:"settings","settings.append":"append_to_path",where:"where",users:"users",location:"files_location"}),t.mapProps({users:t.flow(t.deleteProp("info"),t.toArray,t.mapArray(t.getProp("user"))),settings:t.flow(t.project({ip:"ftp_ip",password:"ftp_password",path:"ftp_path",port:"ftp_port",secure:"ftp_secure",username:"ftp_username",append:"append"}),t.mapProps({secure:t.convert.toAppBoolean,append:function(t){var e=Object.values(t),r=e.find((function(t){return t.selected})),s=e.reduce((function(t,e){return i(i({},t),{},(0,o.default)({},e.value,e.text))}),{});return{value:r.value,options:s}}}))}))}});e.getScheduleOptions=v;var m=n.default.get({id:"USER_BACKUP_RESTORE_OPTIONS",url:l,after:function(t){return t.flow(t.project({settings:"settings",where:"where",location:"files_location",ips:"ip_list",files:"files"}),t.mapProps({files:t.flow(t.deleteProp("info"),t.toArray),settings:t.flow(t.getProps(["ftp_ip","ftp_password","ftp_path","ftp_port","ftp_secure","ftp_username"]),t.mapProps({ftp_secure:t.convert.toAppBoolean})),ips:function(t){var e=Object.values(t),r=e.find((function(t){return t.selected})),s=e.reduce((function(t,e){return i(i({},t),{},(0,o.default)({},e.value,e.text))}),{});return{value:r.value,options:s}}}))}});e.getRestoreOptions=m;var O=n.default.post({url:l,params:{action:"create",form_version:"3"},schema:{who:n.default.REQUIRED_STRING,select:{type:Array,required:!1},skip_suspended:n.default.OPTIONAL_BOOL,when:n.default.REQUIRED_STRING,minute:n.default.OPTIONAL_STRING,hour:n.default.OPTIONAL_STRING,dayofmonth:n.default.OPTIONAL_STRING,month:n.default.OPTIONAL_STRING,dayofweek:n.default.OPTIONAL_STRING,where:n.default.REQUIRED_STRING,ftp_ip:n.default.OPTIONAL_STRING,ftp_username:n.default.OPTIONAL_STRING,ftp_password:n.default.OPTIONAL_STRING,ftp_path:n.default.OPTIONAL_STRING,ftp_port:n.default.OPTIONAL_STRING,ftp_secure:n.default.OPTIONAL_STRING,append_to_path:n.default.OPTIONAL_STRING,custom_append:n.default.OPTIONAL_STRING,encryption_password:n.default.OPTIONAL_STRING}});e.scheduleBackup=O;var I=n.default.get({url:l,id:"USER_BACKUP_RESTORE_FILES",params:{action:"update_files"},schema:{where:n.default.REQUIRED_STRING,ftp_ip:n.default.OPTIONAL_STRING,ftp_username:n.default.OPTIONAL_STRING,ftp_password:n.default.OPTIONAL_STRING,ftp_path:n.default.OPTIONAL_STRING,ftp_port:n.default.OPTIONAL_STRING,ftp_secure:n.default.OPTIONAL_STRING},after:function(t){return t.flow(t.getProp("files"),t.deleteProp("info"),t.toArray)}});e.getRestoreFiles=I;var w=n.default.post({url:l,params:{action:"restore"},schema:{where:n.default.REQUIRED_STRING,ftp_ip:n.default.OPTIONAL_STRING,ftp_username:n.default.OPTIONAL_STRING,ftp_password:n.default.OPTIONAL_STRING,ftp_path:n.default.OPTIONAL_STRING,ftp_port:n.default.OPTIONAL_STRING,ftp_secure:n.default.OPTIONAL_STRING,ip_choice:n.default.REQUIRED_STRING,ip:n.default.OPTIONAL_STRING,select:{type:Array,required:!0},encryption_password:n.default.OPTIONAL_STRING}});e.restoreBackup=w;var P=n.default.post({url:"/CMD_USER_BACKUP_MODIFY",id:"USER_BACKUP_CRON",schema:{id:n.default.REQUIRED_STRING},notifySuccess:!1,notifyError:!0,after:function(t){return t.flow(t.moveProp({append_to_path:"append","settings.where":"where"}),t.mapProps({settings:t.mapProp("ftp_secure",t.convert.toAppBoolean),who:t.mapProps({skip_suspended:t.convert.toAppBoolean,users:t.flow(t.deleteProp("info"),t.toArray,t.mapArray(t.getProp("user"))),select:t.feedWith(1,t.flow(t.getProp("users"),t.deleteProp("info"),t.filter(t.flow(t.getProp("checkbox"),t.isEqual("checked"))),t.mapValues(t.getProp("user")),t.toArray))}),append:t.flow(t.mapProps({options:t.feedWith(1,t.transformObject((function(t){var e=t.value,r=t.text;return(0,o.default)({},e,r)}))),value:t.feedWith(1,t.flow(t.find(t.getProp("selected")),t.getProp("value")))}),t.getProps(["value","options"])),custom_append:t.feedWith(1,t.getProp("append.custom_append"))}))}});e.getCron=P;var R=n.default.post({url:l,params:{action:"modify",when:"cron",form_version:"3"},schema:{id:n.default.REQUIRED_STRING,who:n.default.REQUIRED_STRING,select:{type:Array,required:!1},skip_suspended:n.default.OPTIONAL_BOOL,minute:n.default.REQUIRED_STRING,hour:n.default.REQUIRED_STRING,dayofmonth:n.default.REQUIRED_STRING,month:n.default.REQUIRED_STRING,dayofweek:n.default.REQUIRED_STRING,where:n.default.REQUIRED_STRING,ftp_ip:n.default.OPTIONAL_STRING,ftp_username:n.default.OPTIONAL_STRING,ftp_password:n.default.OPTIONAL_STRING,ftp_path:n.default.OPTIONAL_STRING,ftp_port:n.default.OPTIONAL_STRING,ftp_secure:n.default.OPTIONAL_STRING,append_to_path:n.default.REQUIRED_STRING,custom_append:n.default.OPTIONAL_STRING}});e.updateCron=R},2269:function(t,e,r){"use strict";r.r(e);var s=r(2270),o=r.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){r.d(e,t,(function(){return s[t]}))}(n);e.default=o.a},2270:function(t,e,r){"use strict";r(7),r(10),r(5),r(6),r(8),r(11);var s=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(r(36)),n=s(r(37)),a=s(r(2)),i=r(1924),l=r(58);function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){(0,a.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var c,f={preload:[i.getRestoreOptions,i.getEncryptionStatus],api:[{command:i.getRestoreOptions,bind:"options"},{command:i.getEncryptionStatus,bind:"encryption"},{command:i.getRestoreFiles,bind:{isDone:"filesLoaded",response:"files"}}],mixins:[(0,l.$bindTab)({defaultTab:"where",param:"step"})],data:function(){return{where:"local",ftp_ip:"",ftp_username:"",ftp_password:"",ftp_path:"",ftp_port:"",ftp_secure:"",ip_choice:"select",ip:"",select:[],decrypt:!1,password:""}},computed:{validWhere:function(){return"local"===this.where||!!this.ftp_ip&&!!this.ftp_username&&!!this.ftp_password&&!!this.ftp_path&&!!this.ftp_port},validFiles:function(){return!(!this.select.length||this.decrypt&&!this.password)},options:function(){return this.$api.options},files:function(){return this.$api.filesLoaded?this.$api.files:this.$api.options.files},encryptionEnabled:function(){return this.$api.encryption.enabled},ftpData:function(){return"local"===this.where?{}:{ftp_ip:this.ftp_ip,ftp_username:this.ftp_username,ftp_password:this.ftp_password,ftp_path:this.ftp_path,ftp_port:this.ftp_port,ftp_secure:this.ftp_secure?"ftps":"no"}},requestData:function(){var t=this.$get(["where","ip_choice","select"]),e="file"===this.ip_choice?{}:this.$get(["ip"]);return u(u(u(u({},t),this.ftpData),e),{},{encryption_password:this.password})}},watch:{step:function(t,e){"where"===e&&"ftp"===this.where&&this.reloadFiles()}},created:function(){this.ip=this.options.ips.value,this.ftp_ip=this.options.settings.ftp_ip,this.ftp_username=this.options.settings.ftp_username,this.ftp_password=this.options.settings.ftp_password,this.ftp_path=this.options.settings.ftp_path,this.ftp_port=this.options.settings.ftp_port,this.ftp_ip=this.options.settings.ftp_ip,this.ftp_secure=this.options.settings.ftp_secure},methods:{reloadFiles:function(){(0,i.getRestoreFiles)(u({where:this.where},this.ftpData))},restoreBackup:(c=(0,n.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,i.restoreBackup)(this.requestData);case 2:t.sent&&this.$router.push({name:"reseller/backups"});case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})}};e.default=f},3061:function(t,e,r){var s=r(3364);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,r(4).default)("066599f6",s,!0,{})},3363:function(t,e,r){"use strict";r(3061)},3364:function(t,e,r){},3365:function(t,e){},3960:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o}));var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("app-page",{attrs:{id:"restore-reseller-backup"}},[r("app-page-section",[r("ui-steps",{attrs:{steps:[{id:"where",label:t.$gettext("Step 1: From Where"),desc:t.$gettext("Select directory for restore."),completed:t.validWhere},{id:"ip_choice",label:t.$gettext("Step 2: Select IP"),desc:t.$gettext(" Select IP address used for restore.")},{id:"files",label:t.$gettext("Step 3: Select File(s)"),desc:t.$gettext("Select backup files to restore."),completed:t.validFiles}],current:t.step,"hide-buttons":""},on:{"update:current":function(e){t.step=e}}},["where"===t.step&&"ftp"===t.where?r("ui-button",{key:"reload",attrs:{slot:"buttons",theme:"primary"},on:{click:t.reloadFiles},slot:"buttons"},[r("translate",[t._v("Reload Files")])],1):t._e(),t._v(" "),r("div",{key:"where",attrs:{slot:"step:where"},slot:"step:where"},[r("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:t.$_Client.isPhone}},[r("translate",{attrs:{slot:"title","translate-params":t.options},slot:"title"},[t._v("\n                        Local: %{ location }\n                    ")]),t._v(" "),r("input-radio",{attrs:{slot:"content",value:"local"},slot:"content",model:{value:t.where,callback:function(e){t.where=e},expression:"where"}})],1),t._v(" "),r("ui-form-element",{attrs:{underline:"ftp"===t.where,"vertical-on-phone":!1,reverse:t.$_Client.isPhone}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                        FTP\n                    ")]),t._v(" "),r("input-radio",{attrs:{slot:"content",value:"ftp"},slot:"content",model:{value:t.where,callback:function(e){t.where=e},expression:"where"}})],1),t._v(" "),r("transition",{attrs:{name:"fade"}},["ftp"===t.where?r("ui-form-element",{attrs:{underline:!1}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                            FTP Settings\n                        ")]),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    IP\n                                ")]),t._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.ftp_ip,callback:function(e){t.ftp_ip=e},expression:"ftp_ip"}})],1),t._v(" "),r("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    Username\n                                ")]),t._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.ftp_username,callback:function(e){t.ftp_username=e},expression:"ftp_username"}})],1),t._v(" "),r("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    Password\n                                ")]),t._v(" "),r("input-password",{attrs:{slot:"content"},slot:"content",model:{value:t.ftp_password,callback:function(e){t.ftp_password=e},expression:"ftp_password"}})],1),t._v(" "),r("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    Remote Path\n                                ")]),t._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.ftp_path,callback:function(e){t.ftp_path=e},expression:"ftp_path"}})],1),t._v(" "),r("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    Port\n                                ")]),t._v(" "),r("input-text",{attrs:{slot:"content",number:""},slot:"content",model:{value:t.ftp_port,callback:function(e){t.ftp_port=e},expression:"ftp_port"}})],1),t._v(" "),r("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:t.$_Client.isPhone,vertical:!1}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                    Secure FTP\n                                ")]),t._v(" "),r("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.ftp_secure,callback:function(e){t.ftp_secure=e},expression:"ftp_secure"}})],1)],1)],1):t._e()],1)],1),t._v(" "),r("div",{key:"ip_choice",attrs:{slot:"step:ip_choice"},slot:"step:ip_choice"},[r("ui-form-element",{attrs:{underline:"select"===t.ip_choice}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                        Use the IP stored in the backup\n                    ")]),t._v(" "),r("ui-grid",{attrs:{slot:"content",column:t.$_Client.isPhone,cross:t.$_Client.isPhone?"start":"center"},slot:"content"},[r("input-radio",{attrs:{value:"file"},model:{value:t.ip_choice,callback:function(e){t.ip_choice=e},expression:"ip_choice"}},[r("translate",[t._v("stored in the backup")])],1),t._v(" "),r("input-radio",{attrs:{value:"select"},model:{value:t.ip_choice,callback:function(e){t.ip_choice=e},expression:"ip_choice"}},[r("translate",[t._v("from the list")])],1)],1)],1),t._v(" "),r("transition",{attrs:{name:"fade"}},["select"===t.ip_choice?r("ui-form-element",{attrs:{underline:!1}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                            IP Address\n                        ")]),t._v(" "),r("input-select",{directives:[{name:"margin",rawName:"v-margin",value:[0,1],expression:"[0, 1]"}],attrs:{slot:"content",options:t.options.ips.options},slot:"content",model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}})],1):t._e()],1),t._v(" "),r("ul",[r("li",[r("translate",[t._v("\n                            Note that you must set the IP to be shared if you want to add multiple users to it. If you select a non-shared IP, you can only restore 1 user to it.\n                        ")])],1),t._v(" "),r("li",[r("translate",[t._v("\n                            If the user already exists, this setting will have no effect.\n                        ")])],1)])],1),t._v(" "),r("div",{key:"files",attrs:{slot:"step:files"},slot:"step:files"},[r("ui-form-element",[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                        Location\n                    ")]),t._v(" "),r("input-text",{attrs:{slot:"content",disabled:"",value:t.options.location},slot:"content"})],1),t._v(" "),r("ui-form-element",{attrs:{underline:t.encryptionEnabled}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                        Files\n                    ")]),t._v("[]\n                    "),r("input-select-multiple",{attrs:{slot:"content",options:t.files.map((function(t){return t.file}))},slot:"content",model:{value:t.select,callback:function(e){t.select=e},expression:"select"}})],1),t._v(" "),t.encryptionEnabled?[r("ui-form-element",{attrs:{underline:!!t.decrypt,"vertical-on-phone":!1,reverse:t.$_Client.isPhone}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                            Backup Decryption\n                        ")]),t._v(" "),r("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.decrypt,callback:function(e){t.decrypt=e},expression:"decrypt"}})],1),t._v(" "),r("transition",{attrs:{name:"fadeBounce"}},[t.decrypt?r("ui-form-element",{attrs:{group:"restoreBackupFiles",validators:{required:!0},underline:!1}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                                Password\n                            ")]),t._v(" "),r("input-password",{attrs:{slot:"content"},slot:"content",model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1):t._e()],1)]:t._e()],2),t._v(" "),"files"===t.step?r("ui-button",{key:"restore",attrs:{slot:"buttons",theme:"primary",disabled:!t.validFiles||!t.validWhere},on:{click:t.restoreBackup},slot:"buttons"},[r("translate",[t._v("Restore")])],1):t._e()],1)],1)],1)},o=[]}}]);