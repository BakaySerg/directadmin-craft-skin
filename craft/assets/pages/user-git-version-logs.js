(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[2823],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=script&lang=js&":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.object.define-property.js");var n=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"X",{value:!0}),s.Z=void 0,t("./node_modules/core-js/modules/es.array.reduce.js"),t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.array.slice.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.object.keys.js"),t("./node_modules/core-js/modules/es.regexp.to-string.js"),t("./node_modules/core-js/modules/es.parse-int.js");var r,o,u,i,a,l=n(t("./node_modules/@babel/runtime/regenerator/index.js")),d=n(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=t("./src/js/store/index.js"),p=t("./src/js/endpoints/git-version/index.ts"),m={beforeRouteEnter:(a=(0,d.default)(l.default.mark((function e(s,t,n){var r,o,u,i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,c.State)("app.domain"),o=s.params.uuid,u=s.params.branch,i=s.params.skip,e.next=6,p.getLogs.request({uuid:o,branch:u,skip:i,domain:r});case 6:return e.next=8,p.getInfo.request({uuid:o});case 8:n(!0);case 9:case"end":return e.stop()}}),e)}))),function(e,s,t){return a.apply(this,arguments)}),props:{uuid:{type:String,required:!0},branch:{type:String,required:!0},skip:{type:String,required:!0}},data:function(){return{currentBranch:this.branch,query:{from:""}}},computed:{gitInfo:p.getInfo.bindData(),gitLogs:p.getLogs.bindData(),dateGroups:function(){var e=this.gitLogs.commits.reduce((function(e,s){var t=new Date(s.time),n=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),o=t.getFullYear()+"-"+n+"-"+r;return e[o]||(e[o]=[]),e[o].push(s),e}),{});return Object.keys(e).map((function(s){return{date:s,commits:e[s]}}))}},watch:{$route:function(e,s){s.params.skip!=e.params.skip&&s.params.branch==e.params.branch&&(this.skip=e.params.skip,this.request(e.params.uuid,e.params.branch,e.params.skip)),s.params.branch!=e.params.branch&&this.request(e.params.uuid,e.params.branch,e.params.skip)},uuid:function(){this.request()}},methods:{getBack:(i=(0,d.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$router.push({name:"user/git-version/info",params:{uuid:this.uuid}});case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),requestOlder:(u=(0,d.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:(parseInt(this.skip)+10).toString()}});case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),requestNewer:(o=(0,d.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:parseInt(this.skip)-10>=0?(parseInt(this.skip)-10).toString():"0"}});case 1:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),request:(r=(0,d.default)(l.default.mark((function e(s,t,n){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getLogs.request({uuid:s,branch:t,skip:n.toString()});case 2:this.uuid=s,this.branch=t,this.currentBranch=t,this.skip=n;case 6:case"end":return e.stop()}}),e,this)}))),function(e,s,t){return r.apply(this,arguments)}),changeBranch:function(){this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:"0"}})},showLogDiff:function(e){this.$router.push({name:"user/git-version/diff",params:{commit:e,uuid:this.gitInfo.uuid}})}}};s.Z=m},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=style&index=0&lang=scss&":function(){},"./src/js/endpoints/git-version/index.ts":function(e,s,t){"use strict";t.r(s),t.d(s,{deleteRepo:function(){return c},getCommit:function(){return f},getGit:function(){return i},getInfo:function(){return p},getLogs:function(){return m},helpers:function(){return n},postDeploy:function(){return u},postFetch:function(){return l},postInit:function(){return a},postWebhook:function(){return d},putModify:function(){return g}});var n={};t.r(n),t.d(n,{getDefaultBranch:function(){return o}});var r=t("./src/js/api/endpoint/index.ts"),o=function(e){return 0===e.length?"":["main","master"].find((function(s){return e.includes(s)}))||e[0]},u=(0,r.POST)("/git/uuid/:uuid/deploy",{statusCodes:{409:"GIT_DEPLOY_BRANCH_NOT_SET",410:"GIT_DEPLOY_DIR_NOT_SET"},errorMessages:{GIT_DEPLOY_BRANCH_NOT_SET:(0,r.$gettext)("Git deploy branch is not set"),GIT_DEPLOY_DIR_NOT_SET:(0,r.$gettext)("Git deploy directory is not set")}}),i=(0,r.GET)("/git/domain/:domain"),a=(0,r.POST)("/git/domain/:domain",{statusCodes:{409:"GIT_DIRECTORY_EXISTS"},errorMessages:{GIT_DIRECTORY_EXISTS:(0,r.$gettext)("Git directory exists %{ directory }")}}),l=(0,r.POST)("/git/uuid/:uuid/fetch"),d=(0,r.POST)("/git/uuid/:uuid/webhook"),c=(0,r.DELETE)("/git/uuid/:uuid"),p=(0,r.GET)("/git/uuid/:uuid"),m=(0,r.GET)("/git/uuid/:uuid/branch/:branch"),g=(0,r.PUT)("/git/uuid/:uuid"),f=(0,r.GET)("/git/uuid/:uuid/commit/:commit")},"./src/js/pages/user/git-version/logs.vue":function(e,s,t){"use strict";t.r(s),t.d(s,{__esModule:function(){return n.X},default:function(){return l}});var n=t("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=script&lang=js&"),r=n.Z,o=(t("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=style&index=0&lang=scss&"),t("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),u=t("./src/js/pages/user/git-version/logs.vue?vue&type=custom&index=0&blockType=route"),i=t.n(u),a=(0,o.Z)(r,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("app-page",{attrs:{id:"git-logs-page",actions:[{label:e.$gettext("Back to Repository"),visible:!0,icon:"#anchor",handler:function(){return e.getBack()}}]}},[t("template",{slot:"page:title"},[t("translate",[e._v("Repository")]),e._v("\n        : "+e._s(e.gitInfo.name)+"\n    ")],1),e._v(" "),t("app-page-section",{on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.request.apply(null,arguments)}}},[t("ui-form-element",[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Branch\n            ")]),e._v(" "),t("input-select",{attrs:{slot:"content",options:e.gitInfo.branches},on:{change:e.changeBranch},slot:"content",model:{value:e.currentBranch,callback:function(s){e.currentBranch=s},expression:"currentBranch"}})],1)],1),e._v(" "),e._l(e.dateGroups,(function(s){return t("div",{key:s.date},[t("app-page-section",{attrs:{id:"log-table"}},[t("ui-r-table",e._b({attrs:{"hide-before-controls":"","disable-pagination":""},scopedSlots:e._u([{key:"col:time",fn:function(s){var t=s.time;return[e._v("\n                    "+e._s(("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2))+"\n                ")]}},{key:"col:message",fn:function(s){var n=s.item;return t("ui-link",{attrs:{name:"user/git-version/diff",params:{commit:n.hash,uuid:e.gitInfo.uuid,branch:e.currentBranch}}},[t("div",{staticStyle:{"font-weight":"bold"}},[e._v("\n                        "+e._s(n.message.split("\n")[0].substr(0,70))+"\n                        "+e._s(n.message.split("\n")[0].length>70?"...":"")+"\n                    ")]),e._v("\n                    "+e._s(n.author.name)+"\n                ")])}},{key:"row:actions",fn:function(s){var n=s.item;return t("ui-link",{staticStyle:{"font-family":"monospace"},attrs:{title:e.$gettext("Show Details")},on:{click:function(s){return e.showLogDiff(n.hash)}}},[e._v("\n                    "+e._s(n.hash.substr(0,7))+"\n                ")])}}],null,!0)},"ui-r-table",{rows:s.commits,columns:[{id:"message",label:"Commits on "+s.date}],verticalLayout:e.$_Client.isPhone,isCheckable:!1,isSortable:!1},!1))],1)],1)})),e._v(" "),t("app-page-section",{on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.request.apply(null,arguments)}}},[t("ui-button",{directives:[{name:"show",rawName:"v-show",value:e.gitLogs.more_newer,expression:"gitLogs.more_newer"}],attrs:{slot:"footer:buttons",theme:"primary"},on:{click:function(s){return s.preventDefault(),e.requestNewer()}},slot:"footer:buttons"},[t("translate",[e._v("Newer")])],1),e._v(" "),t("ui-button",{attrs:{slot:"footer:buttons",disabled:!e.gitLogs.more_older,theme:"primary"},on:{click:function(s){return s.preventDefault(),e.requestOlder()}},slot:"footer:buttons"},[t("translate",[e._v("Older")])],1)],1)],2)}),[],!1,null,null,null);"function"==typeof i()&&i()(a);var l=a.exports},"./src/js/pages/user/git-version/logs.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=style&index=0&lang=scss&":function(e,s,t){var n=t("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/logs.vue?vue&type=style&index=0&lang=scss&");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,t("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("25c78444",n,!0,{})}}]);