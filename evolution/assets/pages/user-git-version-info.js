(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[8653],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=o(s("./node_modules/@babel/runtime/regenerator/index.js"));s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.object.assign.js");var r,i,l=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=s("./src/js/api/commands/fm.js"),d=s("./src/js/endpoints/git-version/index.ts"),a=s("./src/js/api/endpoint/index.ts"),c={beforeRouteEnter:(0,a.preload)([function(){return d.getInfo.request({uuid:undefined.uuid})}]),props:{uuid:{type:String,required:!0}},data:function(){return{query:{deploy_branch:"",deploy_dir:"",keyfile:"",branches:[]}}},computed:{gitInfo:d.getInfo.bindData(),name:function(){return this.gitInfo.name},homeDir:function(){return this.$state.session.homeDir}},methods:{validateKeyFile:function(e){return!e||(0,u.checkExists)({path:e})},initRepoInfo:(i=(0,l.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.query=Object.assign(this.query,this.gitInfo);case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),submit:(r=(0,l.default)(n.default.mark((function e(){var t,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$valid("edit-repo")){e.next=7;break}return e.next=3,d.putModify.request({uuid:this.uuid,deploy_branch:this.query.deploy_branch,deploy_dir:this.query.deploy_dir,keyfile:this.query.keyfile});case 3:t=e.sent,(s=t.error)?s.notify():this.$notifications.success({title:this.$gettext("Git Modify"),content:this.$gettext("Repository modified")}),this.$emit("modified");case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}};t.Z=c},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=o(s("./node_modules/@babel/runtime/regenerator/index.js")),r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),l=o(s("./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue")),u=s("./src/js/endpoints/git-version/index.ts");function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){(0,i.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var c,p,m,f,v,_={beforeRouteEnter:(0,s("./src/js/api/endpoint/index.ts").preload)([function(e){return u.getInfo.request({uuid:e.params.uuid})}]),components:{ModifyRepoDialog:l.default},props:{uuid:{type:String,required:!0}},computed:{gitInfo:u.getInfo.bindData((function(e){return a(a({},e),{},{default_branch:u.helpers.getDefaultBranch(e.branches)})}))},methods:{modifyDialog:(v=(0,r.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getInfo.request({uuid:this.uuid});case 2:this.$dialog("MODIFY_GIT_REPO_DIALOG").open();case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),gitGet:(f=(0,r.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getInfo.request({uuid:this.uuid});case 2:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)}),getLogs:(m=(0,r.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$router.push({name:"user/git-version/logs",params:{branch:this.gitInfo.default_branch,uuid:this.uuid,skip:"0"}});case 1:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),fetch:(p=(0,r.default)(n.default.mark((function e(){var t,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.gitInfo.remote){e.next=4;break}this.$notifications.info({title:this.$gettext("Git Fetch"),content:this.$gettext("Remote is not set")}),e.next=9;break;case 4:return e.next=6,u.postFetch.request({uuid:this.uuid});case 6:t=e.sent,(s=t.error)?s.notify():this.$notifications.success({title:this.$gettext("Git Fetch"),content:this.$gettext("Fetch completed")});case 9:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),deploy:(c=(0,r.default)(n.default.mark((function e(){var t,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.postDeploy.request({uuid:this.uuid});case 2:t=e.sent,(s=t.error)?s.notify():this.$notifications.success({title:this.$gettext("Git Deploy"),content:this.$gettext("Deployment completed")});case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})}};t.Z=_},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=style&index=0&id=a8ccbe52&lang=scss&scoped=true&":function(){},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=style&index=0&id=06aeb086&lang=scss&scoped=true&":function(){},"./src/js/endpoints/git-version/index.ts":function(e,t,s){"use strict";s.r(t),s.d(t,{deleteRepo:function(){return c},getCommit:function(){return v},getGit:function(){return l},getInfo:function(){return p},getLogs:function(){return m},helpers:function(){return o},postDeploy:function(){return i},postFetch:function(){return d},postInit:function(){return u},postWebhook:function(){return a},putModify:function(){return f}});var o={};s.r(o),s.d(o,{getDefaultBranch:function(){return r}});var n=s("./src/js/api/endpoint/index.ts"),r=function(e){return 0===e.length?"":["main","master"].find((function(t){return e.includes(t)}))||e[0]},i=(0,n.POST)("/git/uuid/:uuid/deploy",{statusCodes:{409:"GIT_DEPLOY_BRANCH_NOT_SET",410:"GIT_DEPLOY_DIR_NOT_SET"},errorMessages:{GIT_DEPLOY_BRANCH_NOT_SET:(0,n.$gettext)("Git deploy branch is not set"),GIT_DEPLOY_DIR_NOT_SET:(0,n.$gettext)("Git deploy directory is not set")}}),l=(0,n.GET)("/git/domain/:domain"),u=(0,n.POST)("/git/domain/:domain",{statusCodes:{409:"GIT_DIRECTORY_EXISTS"},errorMessages:{GIT_DIRECTORY_EXISTS:(0,n.$gettext)("Git directory exists %{ directory }")}}),d=(0,n.POST)("/git/uuid/:uuid/fetch"),a=(0,n.POST)("/git/uuid/:uuid/webhook"),c=(0,n.DELETE)("/git/uuid/:uuid"),p=(0,n.GET)("/git/uuid/:uuid"),m=(0,n.GET)("/git/uuid/:uuid/branch/:branch"),f=(0,n.PUT)("/git/uuid/:uuid"),v=(0,n.GET)("/git/uuid/:uuid/commit/:commit")},"./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return i}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=script&lang=js&"),n=o.Z,r=(s("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=style&index=0&id=a8ccbe52&lang=scss&scoped=true&"),(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"MODIFY_GIT_REPO_DIALOG",size:"normal"},on:{"dialog:open":e.initRepoInfo}},[s("translate",{attrs:{slot:"title","translate-params":{name:e.name}},slot:"title"},[e._v("\n        Modify Repository %{ name }\n    ")]),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[s("ui-form-element",{attrs:{vertical:""}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Deploy Branch\n            ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.query.branches||[]},slot:"content",model:{value:e.query.deploy_branch,callback:function(t){e.$set(e.query,"deploy_branch",t)},expression:"query.deploy_branch"}})],1),e._v(" "),s("ui-form-element",{attrs:{vertical:"",group:"edit-repo",validators:{required:!1}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Deploy Directory\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)}},slot:"content",model:{value:e.query.deploy_dir,callback:function(t){e.$set(e.query,"deploy_dir",t)},expression:"query.deploy_dir"}})],1),e._v(" "),s("ui-form-element",{directives:[{name:"show",rawName:"v-show",value:e.gitInfo.remote,expression:"gitInfo.remote"}],attrs:{vertical:"",group:"edit-repo",validators:{required:!1}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Key file\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)}},slot:"content",model:{value:e.query.keyfile,callback:function(t){e.$set(e.query,"keyfile",t)},expression:"query.keyfile"}})],1)],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"primary","validate-group":"edit-repo"},on:{click:e.submit},slot:"buttons"},[s("translate",[e._v("Save")])],1)],1)}),[],!1,null,"a8ccbe52",null)),i=r.exports},"./src/js/pages/user/git-version/info.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return d}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=script&lang=js&"),n=o.Z,r=(s("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=style&index=0&id=06aeb086&lang=scss&scoped=true&"),s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),i=s("./src/js/pages/user/git-version/info.vue?vue&type=custom&index=0&blockType=route"),l=s.n(i),u=(0,r.Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:[{label:e.$gettext("Logs"),visible:e.gitInfo.branches.length>0,icon:"#log",handler:function(){return e.getLogs()}},{label:e.$gettext("Fetch"),visible:e.gitInfo.remote,icon:"#reload",handler:function(){return e.fetch()}},{label:e.$gettext("Deploy"),visible:!0,icon:"#download",handler:function(){return e.deploy()}},{label:e.$gettext("Modify"),visible:!0,icon:"#settings",handler:function(){return e.modifyDialog()}}]}},[s("template",{slot:"page:title"},[s("translate",{attrs:{"translate-params":e.gitInfo}},[e._v("\n            Repository: %{name}\n        ")])],1),e._v(" "),s("template",{slot:"header:buttons"},[e.gitInfo.branches.length>0?s("ui-button-link",{attrs:{theme:"safe",name:"user/git-version/logs",params:{branch:e.gitInfo.default_branch,uuid:e.uuid,skip:0}}},[s("translate",[e._v("Logs")])],1):e._e(),e._v(" "),s("ui-button",{staticClass:"reload",attrs:{theme:"safe"},on:{click:function(t){return e.fetch()}}},[s("translate",[e._v("Fetch")])],1),e._v(" "),s("ui-button",{staticClass:"download",attrs:{theme:"safe"},on:{click:function(t){return e.deploy()}}},[s("translate",[e._v("Deploy")])],1),e._v(" "),s("ui-button",{staticClass:"settings",attrs:{theme:"safe"},on:{click:function(t){return e.modifyDialog()}}},[s("translate",[e._v("Modify")])],1)],1),e._v(" "),s("app-page-section",[s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Deploy Branch\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.deploy_branch||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Deploy Directory\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.deploy_dir||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",{directives:[{name:"show",rawName:"v-show",value:e.gitInfo.remote,expression:"gitInfo.remote"}]},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Keyfile\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.keyfile||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Branches\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.branches.join(", ")||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",{directives:[{name:"show",rawName:"v-show",value:e.gitInfo.remote,expression:"gitInfo.remote"}]},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Remote\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.remote||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                URL\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.url||"None")+"\n            ")])],1),e._v(" "),s("ui-form-element",{directives:[{name:"show",rawName:"v-show",value:e.gitInfo.remote,expression:"gitInfo.remote"}]},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Webhook URL\n            ")]),e._v(" "),s("div",{staticClass:"element-text",attrs:{slot:"content"},slot:"content"},[e._v("\n                "+e._s(e.gitInfo.webhook_url||"None")+"\n            ")])],1)],1),e._v(" "),s("modify-repo-dialog",{attrs:{uuid:e.uuid},on:{modified:e.gitGet}})],2)}),[],!1,null,"06aeb086",null);"function"==typeof l()&&l()(u);var d=u.exports},"./src/js/pages/user/git-version/info.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=style&index=0&id=a8ccbe52&lang=scss&scoped=true&":function(e,t,s){var o=s("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/_dialogs/modify-repo-dialog.vue?vue&type=style&index=0&id=a8ccbe52&lang=scss&scoped=true&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,s("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("2d05da27",o,!0,{})},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=style&index=0&id=06aeb086&lang=scss&scoped=true&":function(e,t,s){var o=s("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/git-version/info.vue?vue&type=style&index=0&id=06aeb086&lang=scss&scoped=true&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,s("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("4dcd74cb",o,!0,{})}}]);