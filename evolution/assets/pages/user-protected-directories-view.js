(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[7371],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/protected-directories/view.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var a=r(s("./node_modules/@babel/runtime/regenerator/index.js")),o=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var n,i,l,u=s("./src/js/pages/user/protected-directories/_commands/index.js"),d={preload:u.getDirectoryInfo,api:[{command:u.getDirectoryInfo,bind:"info"}],commands:{getDirectoryInfo:u.getDirectoryInfo},data:function(){return{select:[],name:"",user:"",passwd:""}},computed:{path:function(){return this.$route.query.path},users:function(){return this.$api.info.rows.map((function(e){return e.username}))}},created:function(){this.name=this.$api.info.name},methods:{deleteUsers:(l=(0,o.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.deleteUsers)({select:this.select,path:this.path});case 2:(0,u.getDirectoryInfo)({path:this.path}),this.$reset();case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)}),addUser:(i=(0,o.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.addUser)({path:this.path,user:this.user,passwd:this.passwd,passwd2:this.passwd,name:this.name});case 2:(0,u.getDirectoryInfo)({path:this.path}),this.$reset(),this.name=this.$api.info.name;case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),disableProtection:(n=(0,o.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.unprotectDirectory)({name:this.name,path:this.path});case 2:e.sent&&this.$router.replace({name:"user/protected-directories"});case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),updateName:function(){(0,u.updateName)(this.$get(["name","path"]))},validateUsername:function(e){return!this.users.includes(e)}}};t.Z=d},"./src/js/pages/user/protected-directories/_commands/index.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.updateName=t.unprotectDirectory=t.protectDirectory=t.getDirs=t.getDirectoryStatus=t.getDirectoryInfo=t.getDirectories=t.deleteUsers=t.addUser=void 0,s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.promise.js");var a=r(s("./src/js/api/command/index.js")),o="/CMD_FILE_MANAGER",n=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{path:a.default.REQUIRED_STRING,user:a.default.REQUIRED_STRING,passwd:a.default.REQUIRED_STRING,passwd2:a.default.REQUIRED_STRING}});t.protectDirectory=n;var i=a.default.get({id:"PROTECTED_DIRECTORIES",url:"/CMD_PROTECTED_DIRECTORIES",domain:!0,response:[]});t.getDirectories=i;var l=a.default.get({id:"PROTECTED_DIRECTORY_STATUS",url:o,params:{action:"protect"},schema:{path:a.default.REQUIRED_STRING},response:{protected:!1},after:function(){return function(e){return{protected:!!e.ENABLED}}}});t.getDirectoryStatus=l;var u=l.extend({id:"PROTECTED_DIRECTORY_INFO",pagination:!0,response:{},after:function(e){return e.flow(e.deleteProp("ENABLED"),e.deleteProp("domain"),e.deleteProp("path"),e.processTableInfo("users"),e.moveProp({users:"rows",NAME:"name"}),e.mapProp("rows",e.toArray))}});t.getDirectoryInfo=u;var d=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING,user:a.default.REQUIRED_STRING,passwd:a.default.REQUIRED_STRING,passwd2:a.default.REQUIRED_STRING}});t.addUser=d;var c=a.default.select({url:o,params:{action:"delete"},schema:{path:a.default.REQUIRED_STRING}});t.deleteUsers=c;var p=a.default.post({url:o,params:{action:"protect"},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING}});t.unprotectDirectory=p;var m=a.default.post({url:o,params:{action:"protect",enabled:!0},schema:{name:a.default.REQUIRED_STRING,path:a.default.REQUIRED_STRING}});t.updateName=m;var f=a.default.get({url:"/CMD_FILE_MANAGER",params:{action:"json_all",ipp:1e5,comparison12:"equals",value12:"directory"}});t.getDirs=f},"./src/js/pages/user/protected-directories/view.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return r.X},default:function(){return u}});var r=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/protected-directories/view.vue?vue&type=script&lang=js&"),a=r.Z,o=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),n=s("./src/js/pages/user/protected-directories/view.vue?vue&type=custom&index=0&blockType=route"),i=s.n(n),l=(0,o.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:[{label:e.$gettext("Remove Protection"),icon:"#delete",handler:e.$dialog("REMOVE_PROTECTION_DIALOG").open,theme:"danger"}]}},[s("ui-button",{attrs:{slot:"header:buttons",theme:"danger"},on:{click:function(t){e.$dialog("REMOVE_PROTECTION_DIALOG").open()}},slot:"header:buttons"},[s("translate",[e._v("Remove Protection")])],1),e._v(" "),s("app-page-section",[s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Path:\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content",disabled:"",value:e.path},slot:"content"})],1),e._v(" "),s("ui-form-element",{attrs:{group:"dirName",validators:{required:!0},underline:!1}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Name:\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content",placeholder:e.$gettext("eg. Member's Area")},slot:"content",model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[s("ui-button",{attrs:{slot:"additions:right",theme:"safe","validate-group":"dirName"},on:{click:e.updateName},slot:"additions:right"},[s("translate",[e._v("Update")])],1)],1)],1),e._v(" "),s("ui-api-table",e._b({attrs:{"hide-before-controls":""},on:{"action:del":function(t){e.$dialog("DELETE_ITEMS_DIALOG").open()}},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getDirectoryInfo,requestData:{path:e.path},rowID:"username",columns:{username:{label:e.$gettext("Users"),grow:!0}},actions:{del:{label:e.$gettext("Delete")}}},!1),[s("ui-grid",{attrs:{slot:"table:after",main:"end"},slot:"table:after"},[s("ui-button",{attrs:{icon:"plus-fill",size:"small",theme:"light"},on:{click:function(t){e.$dialog("ADD_USER_DIALOG").open()}}},[s("translate",[e._v("Add User")])],1)],1)],1)],1),e._v(" "),s("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("user","users",e.select.length)},on:{"click:confirm":e.deleteUsers}}),e._v(" "),s("ui-dialog",{attrs:{id:"ADD_USER_DIALOG",theme:"safe"}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Add User\n        ")]),e._v(" "),s("template",{slot:"content"},[s("ui-form-element",{attrs:{vertical:"",group:"addProtectedDirUser",validators:{required:!0,validateUsername:e.validateUsername}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Username\n                ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),e._v(" "),s("translate",{attrs:{slot:"error:validateUsername"},slot:"error:validateUsername"},[e._v("\n                    User already exists\n                ")])],1),e._v(" "),s("ui-form-element",{attrs:{vertical:"",group:"addProtectedDirUser",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Password\n                ")]),e._v(" "),s("input-password",{attrs:{slot:"content","show-generator":""},slot:"content",model:{value:e.passwd,callback:function(t){e.passwd=t},expression:"passwd"}})],1)],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"addProtectedDirUser"},on:{click:e.addUser},slot:"buttons"},[s("translate",[e._v("Add")])],1)],2),e._v(" "),s("ui-dialog-confirm",{attrs:{id:"REMOVE_PROTECTION_DIALOG"},on:{"click:confirm":e.disableProtection}},[s("translate",{attrs:{"translate-params":{path:e.path}}},[e._v("\n            Are you sure you want to disable protection for %{path}?\n        ")])],1)],1)}),[],!1,null,null,null);"function"==typeof i()&&i()(l);var u=l.exports},"./src/js/pages/user/protected-directories/view.vue?vue&type=custom&index=0&blockType=route":function(){}}]);