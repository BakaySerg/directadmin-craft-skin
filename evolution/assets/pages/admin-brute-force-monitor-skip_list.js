(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[9810],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/skip-dialog.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;t.Z={data:function(){return{comments:"",skip_value:""}},methods:{submit:function(){this.$emit("skip",{comments:this.comments,skip_value:this.skip_value})}}}},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/tabs.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.function.name.js");var s={api:[{command:o("./src/js/api/commands/admin/brute-force-monitor.js").getDefaults,bind:{"response.scripts":"scripts"}}],props:{id:{type:String,required:!0},filter:{type:Object,required:!1}},computed:{filterMessage:function(){if(this.filter){if("ip"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by IP: %{ ip }"),{ip:this.filter.value});if("user"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by User: %{ user } "),{user:this.filter.value})}return this.$gettext("Select IP address or User to filter results")},headers:function(){var e=[{id:"general",label:this.$gettext("Failed Logins"),desc:this.filterMessage},{id:"ip_list",label:this.$gettext("Failed Logins: IP list"),desc:this.$gettext("Select IP to filter results")},{id:"user_list",label:this.$gettext("Failed logins: Usernames List"),desc:this.$gettext("Select username to filter results")},{id:"skip_list",label:this.$gettext("Skip List"),desc:this.$gettext("Skipped IPs / Users")}];return this.$api.scripts.show_blocked_ips&&e.push({id:"block_list",label:this.$gettext("Block List"),desc:this.$gettext("View / Delete Blocked IPs")}),e}},methods:{changeTab:function(e){var t=this,o="general"===e?"admin/brute-force-monitor":"admin/brute-force-monitor/".concat(e);o!==this.$route.name&&(this.$router.push({name:o}),this.$nextTick((function(){t.$refs.tabs.dataCurrentTab=t.id})))}}};t.Z=s},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/skip_list.vue?vue&type=script&lang=js&":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=o("./src/js/api/commands/admin/brute-force-monitor.js"),i=s(o("./src/js/pages/admin/brute-force-monitor/_components/tabs.vue")),n=s(o("./src/js/pages/admin/brute-force-monitor/_components/skip-dialog.vue")),l={preload:[r.getDefaults,r.getSkipList],commands:{getSkipList:r.getSkipList},components:{Tabs:i.default,SkipDialog:n.default},data:function(){return{select:[],showButton:!0}},methods:{addToSkipList:function(e){(0,r.skip)(e).then(this.$reloadApiTable)},removeFromSkipList:function(){(0,r.unskip)({select:this.select}).then(this.$reloadApiTable)}},beforeRouteLeave:function(e,t,o){this.showButton=!1,o()}};t.Z=l},"./src/js/api/commands/admin/brute-force-monitor.js":function(e,t,o){"use strict";o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.symbol.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),o("./node_modules/core-js/modules/es.object.define-properties.js"),o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.unskip=t.unblock=t.skip=t.getUserList=t.getSkipList=t.getIpList=t.getIpInfo=t.getGeneralList=t.getDefaults=t.getBlockList=t.block=void 0,o("./node_modules/core-js/modules/es.array.find.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.array.sort.js"),o("./node_modules/core-js/modules/es.promise.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/es.array.slice.js");var r=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=s(o("./src/js/api/command/index.js"));function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}function l(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){(0,r.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var a="/CMD_BRUTE_FORCE_MONITOR",u=function(e,t){return i.default.get(l({id:e,url:a},t))},c=function(e,t){return i.default.post({url:a,params:{action:e},schema:t})},d=u("BFM_DEFAULTS",{params:{seek_value:"-1"},after:function(e){return e.flow(e.project({logsize:"BRUTE_LOG_SIZE",userLimit:"USER_LIMIT",ipLimit:"IP_LIMIT",logScanning:"LOG_SCANNING",subjects:"SUBJECT_SELECT",defaultSubject:"SUBJECT_SELECT","scripts.block":"HAVE_BLOCK_SH","scripts.unblock":"HAVE_UNBLOCK_SH","scripts.show_blocked_ips":"HAVE_SHOW_BLOCKED_IPS_SH"}),e.mapProps({logScanning:e.convert.toAppBoolean,subjects:e.toSelect,defaultSubject:e.flow(e.find(e.getProp("selected")),e.getProp("value")),scripts:e.mapValues(e.isEqual("1"))}))}});t.getDefaults=d;var p=u("BFM_IPINFO",{schema:{ipinfo:i.default.REQUIRED_STRING},after:function(e){return e.flow(e.project({ip:"BLOCK_IP",data:"info"}),e.mapProp("data",e.flow(e.convert.toLines,e.filter(e.notEmpty))))}});t.getIpInfo=p;var m=u("BFM_GENERAL_LIST",{params:{show:"LOGINFAILURES"},pagination:!0,schema:{filter:i.default.OPTIONAL_STRING,value:i.default.OPTIONAL_STRING},before:function(e){var t=e.filter,o=e.value,s={};if(e.sort||(s.sort1="-1"),t){var r="ip"===t?2:3;s["comparison".concat(r)]="equals",s["value".concat(r)]=o}return s},after:function(e){return e.flow(e.project({rows:"LOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray((function(e){return l(l({},e),{},{date:new Date(Number(e.id.slice(0,13))),index:Number(e.id.slice(13))})}))))}});t.getGeneralList=m;var f=u("BFM_IPLIST",{params:{show:"IPLOGINFAILURES",sort1:-2},pagination:!0,after:function(e){return e.flow(e.project({rows:"IPLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.project({ip:"ip",failures:"login_failures",first:"first_entry",last:"last_entry",notified:"notified",blocked:"blocked"})),e.mapArrayProps({first:e.convert.toAppDate,last:e.convert.toAppDate,notified:e.isEqual("Yes"),blocked:e.isEqual("Yes")}))))}});t.getIpList=f;var _=u("BFM_USER_LIST",{params:{show:"USERLOGINFAILURES",sort1:-2},pagination:!0,after:function(e){return e.flow(e.project({rows:"USERLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArrayProps({first_entry:e.convert.toAppDate,last_entry:e.convert.toAppDate,notified:e.isEqual("Yes")}))))}});t.getUserList=_;var b=u("BFM_SKIP_LIST",{params:{show:"SKIPLIST"},pagination:!0,after:function(e){return e.flow(e.project({rows:"SKIPLIST"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.flow(e.moveProp("when","date"),e.mapProp("date",e.convert.toAppDate))))))}});t.getSkipList=b;var v=u("BFM_BLOCK_LIST",{params:{show:"BLOCKED_IPS"},pagination:!0,after:function(e){return e.flow(e.project({rows:"BLOCKED_IPS"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray(e.deleteProp("ip_info"),e.mapProp("date_blocked",e.convert.toAppDate))))}});t.getBlockList=v;var j={type:Array,required:!1},g=i.default.OPTIONAL_STRING,k=c("skiplist",{ip:j,user:j,comments:g,skip_value:g});t.skip=k;var I=c("remove_from_skiplist",{select:i.default.ROWS});t.unskip=I;var h=c("block_ips",{ip:j,user:j});t.block=h;var L=c("unblock",{ip:i.default.ROWS});t.unblock=L},"./src/js/pages/admin/brute-force-monitor/_components/skip-dialog.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return s.X},default:function(){return i}});var s=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/skip-dialog.vue?vue&type=script&lang=js&"),r=s.Z,i=(0,o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ui-dialog",{attrs:{id:"SKIP_DIALOG"}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Add to Skip List\n    ")]),e._v(" "),o("div",{attrs:{slot:"content"},slot:"content"},[o("ui-form-element",{attrs:{vertical:""}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                IP / Range / Domain / E-mail\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.skip_value,callback:function(t){e.skip_value=t},expression:"skip_value"}})],1),e._v(" "),o("ui-form-element",{attrs:{vertical:""}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Comments\n            ")]),e._v(" "),o("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.comments,callback:function(t){e.comments=t},expression:"comments"}})],1)],1),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"safe"},on:{click:e.submit},slot:"buttons"},[o("translate",[e._v("Add")])],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/brute-force-monitor/_components/tabs.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return s.X},default:function(){return i}});var s=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/tabs.vue?vue&type=script&lang=js&"),r=s.Z,i=(0,o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page-section",[o("ui-tabs",{ref:"tabs",attrs:{selected:e.id,tabs:e.headers},on:{"update:selected":e.changeTab}},[o("div",{attrs:{slot:"tab:"+e.id},slot:"tab:"+e.id},[e._t("default")],2)])],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/brute-force-monitor/skip_list.vue":function(e,t,o){"use strict";o.r(t),o.d(t,{__esModule:function(){return s.X},default:function(){return u}});var s=o("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/skip_list.vue?vue&type=script&lang=js&"),r=s.Z,i=o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),n=o("./src/js/pages/admin/brute-force-monitor/skip_list.vue?vue&type=custom&index=0&blockType=route"),l=o.n(n),a=(0,i.Z)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("app-page",{attrs:{id:"brute-force-monitor",actions:e.showButton?[{handler:e.$dialog("SKIP_DIALOG").open,label:e.$gettext("Add to skip list"),icon:"#plus-fill"}]:[]}},[e.showButton?o("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(t){e.$dialog("SKIP_DIALOG").open()}},slot:"header:buttons"},[o("translate",[e._v("Add to skip list")])],1):e._e(),e._v(" "),o("tabs",{attrs:{id:"skip_list"}},[o("ui-api-table",e._b({on:{"action:remove":function(t){e.$dialog("REMOVE_FROM_SKIP_LIST_DIALOG").open()}},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getSkipList,rowID:"ip_user",columns:{ip_user:{label:e.$gettext("IP / User"),grow:!0},date:{label:e.$gettext("Date Added"),filter:"date"},comments:e.$gettext("Comments")},actions:{remove:e.$gettext("Remove")},verticalLayout:e.$_Client.isPhone},!1))],1),e._v(" "),o("ui-dialog",{attrs:{id:"REMOVE_FROM_SKIP_LIST_DIALOG",theme:"danger"}},[o("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Remove from Skip List\n        ")]),e._v(" "),o("translate",{attrs:{slot:"content"},slot:"content"},[e._v("\n            Are you sure you want to remove selected elements from skip list?\n        ")]),e._v(" "),o("ui-button",{attrs:{slot:"buttons",theme:"danger"},on:{click:e.removeFromSkipList},slot:"buttons"},[o("translate",[e._v("Remove")])],1)],1),e._v(" "),o("skip-dialog",{on:{skip:e.addToSkipList}})],1)}),[],!1,null,null,null);"function"==typeof l()&&l()(a);var u=a.exports},"./src/js/pages/admin/brute-force-monitor/skip_list.vue?vue&type=custom&index=0&blockType=route":function(){}}]);