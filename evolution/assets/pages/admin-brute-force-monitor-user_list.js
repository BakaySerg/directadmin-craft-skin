(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[1865],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/skip-users-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var o=s("./src/js/api/commands/admin/brute-force-monitor.js"),r={props:{select:{type:Array,required:!0,default:function(){return[]}}},methods:{submit:function(){(0,o.skip)({user:this.select})}}};t.Z=r},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/tabs.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.function.name.js");var o={api:[{command:s("./src/js/api/commands/admin/brute-force-monitor.js").getDefaults,bind:{"response.scripts":"scripts"}}],props:{id:{type:String,required:!0},filter:{type:Object,required:!1}},computed:{filterMessage:function(){if(this.filter){if("ip"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by IP: %{ ip }"),{ip:this.filter.value});if("user"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by User: %{ user } "),{user:this.filter.value})}return this.$gettext("Select IP address or User to filter results")},headers:function(){var e=[{id:"general",label:this.$gettext("Failed Logins"),desc:this.filterMessage},{id:"ip_list",label:this.$gettext("Failed Logins: IP list"),desc:this.$gettext("Select IP to filter results")},{id:"user_list",label:this.$gettext("Failed logins: Usernames List"),desc:this.$gettext("Select username to filter results")},{id:"skip_list",label:this.$gettext("Skip List"),desc:this.$gettext("Skipped IPs / Users")}];return this.$api.scripts.show_blocked_ips&&e.push({id:"block_list",label:this.$gettext("Block List"),desc:this.$gettext("View / Delete Blocked IPs")}),e}},methods:{changeTab:function(e){var t=this,s="general"===e?"admin/brute-force-monitor":"admin/brute-force-monitor/".concat(e);s!==this.$route.name&&(this.$router.push({name:s}),this.$nextTick((function(){t.$refs.tabs.dataCurrentTab=t.id})))}}};t.Z=o},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/user_list.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=s("./src/js/api/commands/admin/brute-force-monitor.js"),i=o(s("./src/js/pages/admin/brute-force-monitor/_components/tabs.vue")),n=o(s("./src/js/pages/admin/brute-force-monitor/_components/skip-users-dialog.vue")),a={preload:[r.getDefaults,r.getUserList],commands:{getUserList:r.getUserList},components:{Tabs:i.default,SkipUsersDialog:n.default},data:function(){return{select:[]}}};t.Z=a},"./src/js/api/commands/admin/brute-force-monitor.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.unskip=t.unblock=t.skip=t.getUserList=t.getSkipList=t.getIpList=t.getIpInfo=t.getGeneralList=t.getDefaults=t.getBlockList=t.block=void 0,s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.promise.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.array.slice.js");var r=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=o(s("./src/js/api/command/index.js"));function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){(0,r.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l="/CMD_BRUTE_FORCE_MONITOR",u=function(e,t){return i.default.get(a({id:e,url:l},t))},d=function(e,t){return i.default.post({url:l,params:{action:e},schema:t})},c=u("BFM_DEFAULTS",{params:{seek_value:"-1"},after:function(e){return e.flow(e.project({logsize:"BRUTE_LOG_SIZE",userLimit:"USER_LIMIT",ipLimit:"IP_LIMIT",logScanning:"LOG_SCANNING",subjects:"SUBJECT_SELECT",defaultSubject:"SUBJECT_SELECT","scripts.block":"HAVE_BLOCK_SH","scripts.unblock":"HAVE_UNBLOCK_SH","scripts.show_blocked_ips":"HAVE_SHOW_BLOCKED_IPS_SH"}),e.mapProps({logScanning:e.convert.toAppBoolean,subjects:e.toSelect,defaultSubject:e.flow(e.find(e.getProp("selected")),e.getProp("value")),scripts:e.mapValues(e.isEqual("1"))}))}});t.getDefaults=c;var p=u("BFM_IPINFO",{schema:{ipinfo:i.default.REQUIRED_STRING},after:function(e){return e.flow(e.project({ip:"BLOCK_IP",data:"info"}),e.mapProp("data",e.flow(e.convert.toLines,e.filter(e.notEmpty))))}});t.getIpInfo=p;var m=u("BFM_GENERAL_LIST",{params:{show:"LOGINFAILURES"},pagination:!0,schema:{filter:i.default.OPTIONAL_STRING,value:i.default.OPTIONAL_STRING},before:function(e){var t=e.filter,s=e.value,o={};if(e.sort||(o.sort1="-1"),t){var r="ip"===t?2:3;o["comparison".concat(r)]="equals",o["value".concat(r)]=s}return o},after:function(e){return e.flow(e.project({rows:"LOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray((function(e){return a(a({},e),{},{date:new Date(Number(e.id.slice(0,13))),index:Number(e.id.slice(13))})}))))}});t.getGeneralList=m;var f=u("BFM_IPLIST",{params:{show:"IPLOGINFAILURES",sort1:-2},pagination:!0,after:function(e){return e.flow(e.project({rows:"IPLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.project({ip:"ip",failures:"login_failures",first:"first_entry",last:"last_entry",notified:"notified",blocked:"blocked"})),e.mapArrayProps({first:e.convert.toAppDate,last:e.convert.toAppDate,notified:e.isEqual("Yes"),blocked:e.isEqual("Yes")}))))}});t.getIpList=f;var b=u("BFM_USER_LIST",{params:{show:"USERLOGINFAILURES",sort1:-2},pagination:!0,after:function(e){return e.flow(e.project({rows:"USERLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArrayProps({first_entry:e.convert.toAppDate,last_entry:e.convert.toAppDate,notified:e.isEqual("Yes")}))))}});t.getUserList=b;var _=u("BFM_SKIP_LIST",{params:{show:"SKIPLIST"},pagination:!0,after:function(e){return e.flow(e.project({rows:"SKIPLIST"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.flow(e.moveProp("when","date"),e.mapProp("date",e.convert.toAppDate))))))}});t.getSkipList=_;var j=u("BFM_BLOCK_LIST",{params:{show:"BLOCKED_IPS"},pagination:!0,after:function(e){return e.flow(e.project({rows:"BLOCKED_IPS"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray(e.deleteProp("ip_info"),e.mapProp("date_blocked",e.convert.toAppDate))))}});t.getBlockList=j;var g={type:Array,required:!1},v=i.default.OPTIONAL_STRING,y=d("skiplist",{ip:g,user:g,comments:v,skip_value:v});t.skip=y;var I=d("remove_from_skiplist",{select:i.default.ROWS});t.unskip=I;var S=d("block_ips",{ip:g,user:g});t.block=S;var L=d("unblock",{ip:i.default.ROWS});t.unblock=L},"./src/js/pages/admin/brute-force-monitor/_components/skip-users-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return i}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/skip-users-dialog.vue?vue&type=script&lang=js&"),r=o.Z,i=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"ADD_USERS_TO_SKIP_LIST",theme:"danger"}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Add to skip list\n    ")]),e._v(" "),s("translate",{attrs:{slot:"content","translate-n":e.select.length,"translate-plural":"Are you sure you want to add selected users to skip list?"},slot:"content"},[e._v("\n        Are you sure you want to add selected user to skip list?\n    ")]),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"danger"},on:{click:e.submit},slot:"buttons"},[s("translate",[e._v("\n            Add\n        ")])],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/brute-force-monitor/_components/tabs.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return i}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/_components/tabs.vue?vue&type=script&lang=js&"),r=o.Z,i=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page-section",[s("ui-tabs",{ref:"tabs",attrs:{selected:e.id,tabs:e.headers},on:{"update:selected":e.changeTab}},[s("div",{attrs:{slot:"tab:"+e.id},slot:"tab:"+e.id},[e._t("default")],2)])],1)}),[],!1,null,null,null).exports},"./src/js/pages/admin/brute-force-monitor/user_list.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return u}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/brute-force-monitor/user_list.vue?vue&type=script&lang=js&"),r=o.Z,i=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),n=s("./src/js/pages/admin/brute-force-monitor/user_list.vue?vue&type=custom&index=0&blockType=route"),a=s.n(n),l=(0,i.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{id:"brute-force-monitor"}},[s("tabs",{attrs:{id:"user_list"}},[s("ui-api-table",e._b({on:{"action:skip":function(t){e.$dialog("ADD_USERS_TO_SKIP_LIST").open()}},scopedSlots:e._u([{key:"col:user",fn:function(t){var o=t.user;return s("ui-link",{attrs:{name:"admin/brute-force-monitor",query:{user:o}},domProps:{textContent:e._s(o)}})}},{key:"col:notified",fn:function(t){var o=t.notified;return s("ui-badge",{attrs:{theme:o?"primary":"danger",size:"small"}},[e._v("\n                "+e._s(o?e.$gettext("Yes"):e.$gettext("No"))+"\n            ")])}}]),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getUserList,rowID:"user",columns:{user:{label:e.$gettext("User"),grow:!0},login_failures:e.$gettext("Login Failures"),first_entry:{label:e.$gettext("First"),filter:"date"},last_entry:{label:e.$gettext("Last"),filter:"date"},notified:e.$gettext("Notified")},actions:{skip:e.$gettext("Skip")},initialSort:{key:"login_failures",order:"DESC"},verticalLayout:e.$_Client.isPhone},!1))],1),e._v(" "),s("skip-users-dialog",e._b({},"skip-users-dialog",{select:e.select},!1))],1)}),[],!1,null,null,null);"function"==typeof a()&&a()(l);var u=l.exports},"./src/js/pages/admin/brute-force-monitor/user_list.vue?vue&type=custom&index=0&blockType=route":function(){}}]);