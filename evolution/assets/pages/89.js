(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{1828:function(t,e,a){"use strict";a.r(e);var r=a(4026),n=a(2637);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);var o=a(0),i=a(3666),u=a.n(i),c=Object(o.a)(n.default,r.a,r.b,!1,null,null,null);"function"==typeof u.a&&u()(c),e.default=c.exports},1884:function(t,e,a){"use strict";var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.validateIPRangeList=e.validateDomain=e.validatePassword=e.validateSubdomain=e.validateUsername=e.validateDBUser=e.validateDatabase=e.validateDNSName=e.validateMXValue=e.validateDNSValue=e.validateFTP=e.validateEmail=e.validateForwarder=void 0;var n=r(a(78)),s=r(a(98)),o=r(a(1885)),i=n.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:n.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:o.default.isValid,message:o.default.getMessage}}),u=i.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});e.validateForwarder=u;var c=i.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});e.validateEmail=c;var l=i.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});e.validateFTP=l;var d=i.extend({params:{type:"dns"},domain:!0,schema:{record:n.default.REQUIRED_STRING}}),p=d.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:n.default.REQUIRED_STRING}});e.validateDNSValue=p;var f=p.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(t){return{value:"10",mx_value:t.value}}});e.validateMXValue=f;var v=d.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:n.default.REQUIRED_STRING,value:null}});e.validateDNSName=v;var m=i.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});e.validateDatabase=m;var h=i.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});e.validateDBUser=h;var _=i.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});e.validateUsername=_;var g=i.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});e.validateSubdomain=g;var y=i.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});e.validatePassword=y;var b=i.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(t){var e=t.value;return{value:s.default.toASCII(e)}}});e.validateDomain=b;var P=i.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});e.validateIPRangeList=P},1885:function(t,e,a){"use strict";a.r(e);var r=a(97);e.default={isValid:function(t){return void 0===t.error},getMessage:function(t){return Object(r.toAppHtml)(t.error||"")}}},1953:function(t,e,a){"use strict";a(7),a(10),a(5),a(6),a(8),a(11);var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.changePassword=e.updateSettings=e.getSettings=e.deleteAccounts=e.unsuspendAccounts=e.suspendAccounts=e.updateAccount=e.createAccount=e.getAccounts=e.getAccount=void 0;var n=r(a(2)),s=r(a(78));function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}var i=s.default.get({id:"FTP_ACCOUNT",url:"/CMD_FTP_SHOW",domain:!0,schema:{user:s.default.REQUIRED_STRING}});e.getAccount=i;var u=s.default.get({id:"FTP_ACCOUNTS",url:"/CMD_FTP",response:[],params:{full_json:!0},domain:!0,after:function(t){return t.flow(t.project({accounts:"users",anonLogin:"ANONLOGIN"}),t.mapProp("accounts",t.flow(t.mapValues((function(t,e){return function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){(0,n.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({login:e},t)})),t.toArray,t.mapArrayProps({suspended:t.convert.toAppBoolean}))))}});e.getAccounts=u;var c=s.default.post({url:"/CMD_FTP",params:{action:"create"},domain:!0,schema:{user:s.default.REQUIRED_STRING,passwd:s.default.REQUIRED_STRING,passwd2:s.default.REQUIRED_STRING,type:s.default.REQUIRED_STRING,custom_val:s.default.OPTIONAL_STRING},notifySuccess:!1});e.createAccount=c;var l=c.extend({params:{action:"modify"},schema:{passwd:s.default.OPTIONAL_STRING,passwd2:s.default.OPTIONAL_STRING}});e.updateAccount=l;var d=s.default.select({url:"/CMD_FTP",domain:!0,params:{action:"delete"},notifySuccess:!1,notifyError:!1}),p=d.extend({params:{suspend:!0}});e.suspendAccounts=p;var f=d.extend({params:{unsuspend:!0}});e.unsuspendAccounts=f;var v=d.extend({params:{delete:!0}});e.deleteAccounts=v;var m=s.default.get({id:"FTP_SETTINGS",url:"/CMD_FTP_SETTINGS",domain:!0,after:function(t){return function(e){return{access:t.convert.toAppBoolean(e.Anonymous),upload:t.convert.toAppBoolean(e.AnonymousUpload),message:t.flow(t.convert.toAppString,t.convert.toAppText)(e.message)}}}});e.getSettings=m;var h=s.default.post({url:"/CMD_FTP_SETTINGS",params:{action:"modify"},domain:!0,schema:{anon:s.default.REQUIRED_BOOL,anonup:s.default.REQUIRED_BOOL,message:s.default.REQUIRED_STRING}});e.updateSettings=h;var _=s.default.post({url:"/CMD_CHANGE_FTP_PASSWORD",schema:{ftp:s.default.REQUIRED_STRING,password1:s.default.REQUIRED_STRING,password2:s.default.REQUIRED_STRING}});e.changePassword=_},1997:function(t,e,a){"use strict";a.r(e);var r=a(1998),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(s);e.default=n.a},1998:function(t,e,a){"use strict";a(16),a(14),a(23),a(25),a(18),a(6);var r=a(1),n=a(19);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=r(a(36)),o=r(a(37));a(68),a(55),a(84),a(21),a(61),a(34),a(12),a(15),a(40),a(8);var i=a(942),u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var a=c(e);if(a&&a.has(t))return a.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}r.default=t,a&&a.set(t,r);return r}(a(9));function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,a=new WeakMap;return(c=function(t){return t?a:e})(t)}var l,d,p=i.getFolderTree.extend({notifyError:!1,params:{filemanager_du:0,action:"parent_tree"}}),f={name:"PathSuggest",model:{prop:"value",event:"update:value"},props:{value:{type:String,required:!0}},data:function(){return{path:this.value,selected:null,loaded:[],loading:!1,state:[]}},computed:{folders:function(){var t=this,e=this.getParent(this.path),a=u.filter(u.allPass([function(a){return t.getParent(a)===e},function(e){return e.startsWith(t.path)},function(e){return e!==t.path}]));return u.pipe(a,u.sortWith([u.ascend(u.length),u.ascend((function(t){return t}))]))(this.state)}},watch:{value:function(t){t!==this.path&&this.setModel(t)}},methods:{getParent:function(t){var e=t.slice(1).split("/").slice(0,-1).join("/");return"/".concat(e)},treeRequest:(d=(0,o.default)(s.default.mark((function t(e){var a;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p({path:e});case 2:if(!((a=t.sent)instanceof Error)){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",a.map(u.prop("path")));case 6:case"end":return t.stop()}}),t)}))),function(t){return d.apply(this,arguments)}),loadDir:(l=(0,o.default)(s.default.mark((function t(e){var a;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loaded.includes(e)){t.next=2;break}return t.abrupt("return");case 2:return this.loaded.push(e),this.loading=!0,t.next=6,this.treeRequest(e);case 6:a=t.sent,this.state=u.filter(Boolean,u.uniq(u.concat(this.state,a))),this.loading=!1;case 9:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)}),onInput:function(t){""!==t?("/"!==t[0]&&(t="/".concat(t)),this.$refs.dropdown,this.setModel(t)):this.setModel(t)},setModel:function(t){if(this.folders.includes(t))this.loadDir(t);else{var e=this.getParent(t);this.loadDir(e)}this.path=t,this.$emit("update:value",t)},autocomplete:function(){var t=this.folders;if(0!==t.length)if(null===this.selected)if(1!==t.length){var e=this.path;t.shift().replace(e,"").split("").forEach((function(a){var r=e+a;t.every((function(t){return t.startsWith(r)}))&&(e=r)})),this.setModel(e)}else this.setModel(t[0]);else this.setModel(this.folders[this.selected])},smartBackspace:function(){var t=this.getParent(this.path);this.setModel(t)}}};e.default=f},2637:function(t,e,a){"use strict";a.r(e);var r=a(2638),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(s);e.default=n.a},2638:function(t,e,a){"use strict";a(7),a(10),a(5),a(6),a(8),a(11);var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a(36));a(34),a(24),a(12),a(15);var s=r(a(38)),o=r(a(37)),i=r(a(2)),u=a(1953),c=a(1884),l=a(112),d=a(13),p=r(a(2639));function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){(0,i.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m,h={preload:[u.getAccounts],components:{PathSuggest:p.default},api:[{command:u.getAccounts,bind:"ftp"}],commands:{validateFTP:c.validateFTP,validatePassword:c.validatePassword},data:function(){return{username:"",password:"",type:"domain",customDir:""}},computed:v(v({existingUsers:function(){return this.$api.ftp.accounts.map((function(t){return t.user}))}},(0,d.mapTokens)({ftpsep:"FTP_SEP",customDirPrefix:"HOME_DIR"})),{},{ftpOptions:function(){return[{id:"domain",label:this.$gettext("Domain"),desc:this.$gettext("FTP account with the root directory in the domains home directory (one up from the public_html)")},{id:"ftp",label:this.$gettext("FTP"),desc:this.$gettext("FTP account with the root directory in the domains public_ftp directory")},{id:"user",label:this.$gettext("User"),desc:this.$gettext("FTP account with the root directory as the user name in the public_html directory")},{id:"custom",label:this.$gettext("Custom"),desc:this.$gettext("Please provide custom directory in the field below")}]}}),methods:{createFtpAccount:(m=(0,o.default)(n.default.mark((function t(){var e,a,r,o;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.createAccount)({user:this.username,passwd:this.password,passwd2:this.password,type:this.type,custom_val:"".concat(this.customDirPrefix).concat(this.customDir)});case 2:(e=t.sent)instanceof Error||(a=[[this.$gettext("Login"),e.login],[this.$gettext("Password"),e.passwd],[this.$gettext("Path"),e.path]].map((function(t){var e=(0,s.default)(t,2),a=e[0],r=e[1];return"<tr><td>".concat(a,":</td><td>").concat(r,"</td></tr>")})),r='<table class="table-elem">'.concat(a,"</table>"),o={title:this.$gettext("FTP account created"),content:r,extended:!0},this.$notifications.success(o),d.emitter.emit("request:results",o),this.$router.push({name:"user/ftp-accounts"}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)}),isUserExists:function(t){return!this.existingUsers.includes(t)},copyPassword:function(){var t=this;(0,l.toClipboard)(this.password)&&this.$nextTick((function(){t.$notifications.success({title:"Password copied!"})}))}}};e.default=h},2639:function(t,e,a){"use strict";a.r(e);var r=a(2880),n=a(1997);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);var o=a(0),i=Object(o.a)(n.default,r.a,r.b,!1,null,null,null);e.default=i.exports},2880:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ui-input-group",{attrs:{slot:"content"},slot:"content"},[a("ui-button",{attrs:{slot:"additions:left",disabled:"disabled"},slot:"additions:left"},[t._v("\n        "+t._s(t.$state.app.tokens.HOME_DIR)+"\n    ")]),t._v(" "),a("input-autocomplete",{attrs:{slot:"input",value:t.path,values:t.folders,"suggest-after":0,focused:t.selected,"force-all-values":"","focus-on-mouse-over":!1},on:{"update:focused":function(e){t.selected=e},input:t.onInput},nativeOn:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.stopPropagation(),e.preventDefault(),t.autocomplete.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&2!==e.button?null:(e.stopPropagation(),e.preventDefault(),t.autocomplete.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"backspace",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),t.smartBackspace.apply(null,arguments)):null}]},slot:"input"})],1)},n=[]},3666:function(t,e){},4026:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-page",[a("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"createFtpAccount"},on:{click:t.createFtpAccount},slot:"footer:buttons"},[a("translate",[t._v("Create")])],1),t._v(" "),a("app-page-section",[a("ui-form-element",{attrs:{group:"createFtpAccount",validators:{required:!0,isUserExists:t.isUserExists,regex:/^[a-z0-9\-]+$/i,api:t.$commands.validateFTP},vertical:t.$_Client.isPhone}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                FTP Username\n            ")]),t._v(" "),a("input-text",{attrs:{slot:"content",suffix:""+t.ftpsep+t.$p6e.toU(t.$domain)},slot:"content",model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),t._v(" "),a("translate",{attrs:{slot:"error:isUserExists"},slot:"error:isUserExists"},[t._v("\n                User already exists\n            ")]),t._v(" "),a("translate",{attrs:{slot:"error:regex"},slot:"error:regex"},[t._v("\n                Wrong username format\n            ")])],1),t._v(" "),a("ui-form-element",{attrs:{group:"createFtpAccount",validators:{required:!0,api:t.$commands.validatePassword},vertical:t.$_Client.isPhone}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Enter Password\n            ")]),t._v(" "),a("input-password",{directives:[{name:"flex-item",rawName:"v-flex-item",value:{grow:!0},expression:"{ grow: true }"}],ref:"password",attrs:{slot:"content","show-generator":""},slot:"content",model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t._v(" "),a("ui-form-element",{attrs:{underline:!1}},[a("template",{slot:"content"},[a("ui-tabs",{attrs:{radio:"",tabs:t.ftpOptions,selected:t.type},on:{"update:selected":function(e){t.type=e}}},[a("ui-form-element",{attrs:{slot:"tab:custom",underline:!1,"hide-title":t.$_Client.isPhone},slot:"tab:custom"},[t.$_Client.isPhone?t._e():a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                            Directory\n                        ")]),t._v(" "),a("path-suggest",{attrs:{slot:"content"},slot:"content",model:{value:t.customDir,callback:function(e){t.customDir=e},expression:"customDir"}})],1)],1)],1)],2)],1)],1)},n=[]}}]);