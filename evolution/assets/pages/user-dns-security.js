(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[4909],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_components/zone-key.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n={props:{id:String,created:Date,published:Date,activated:Date,value:String}};t.Z=n},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_dialogs/confirm-dnssec-action.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;t.Z={}},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/security.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var o=n(s("./node_modules/@babel/runtime/regenerator/index.js")),a=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),r=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js"));s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.array.map.js");var i=s("./src/js/api/commands/dnssec.js"),l=n(s("./src/js/pages/user/dns/_dialogs/confirm-dnssec-action.vue"));function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){(0,r.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var c,p={preload:function(e){var t=e.dom,s=e.pointer;return(0,i.getData)({ptr:s||null,domain:t||void 0})},components:{ZoneKey:n(s("./src/js/pages/user/dns/_components/zone-key.vue")).default,ConfirmDialog:l.default},api:[{command:i.getData,bind:{"response.keys":"keys","response.status":"status","response.zone":"zone",isDone:"dataLoaded"}}],props:{dom:{type:String,required:!1,default:function(){return this.$domain}}},data:function(){return{action:null}},computed:{keysRows:function(){return this.$api.status.keys?{zone:{id:this.$gettext("Zone-Signing Key"),data:this.$api.keys.zone},key:{id:this.$gettext("Key-Signing Key"),data:this.$api.keys.key}}:{}},zoneRows:function(){return[{label:this.$gettext("Signed"),value:this.$api.zone.signedDate},{label:this.$gettext("Expiry"),value:this.$api.zone.expiryDate},{label:this.$gettext("DS Record"),value:this.$api.zone.DS},{label:this.$gettext("DLV Record"),value:this.$api.zone.DLV}].map((function(e){return d(d({},e),{},{date:e.value instanceof Date})}))},ptr:function(){return this.$route.query.pointer||null}},watch:{$domain:"updateData"},methods:{updateData:function(){(0,i.getData)({domain:this.dom,ptr:this.ptr})},generateKeys:function(){(0,i.generateKeys)({ptr:this.ptr,domain:this.dom}).then(this.updateData)},signZone:function(){(0,i.signZone)({ptr:this.ptr,domain:this.dom}).then(this.updateData)},clearZone:function(){(0,i.clearZone)({ptr:this.ptr,domain:this.dom}).then(this.updateData)},requestConfirmation:function(e){var t=this;return function(){t.action=e,t.$dialog("CONFIRM_DNSSEC_DIALOG").open()}},doAction:(c=(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"function"==typeof this.action&&this.action.call(this),this.action=null;case 2:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)}),cancelAction:function(){this.action=null}}};t.Z=p},"./src/js/api/commands/dnssec.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.signZone=t.getData=t.generateKeys=t.clearZone=void 0,s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js");var o=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=n(s("./src/js/api/command/index.js")),r=s("./src/js/store/index.js"),i=s("./src/js/modules/constants.js"),l=function(){var e,t=(e={},(0,o.default)(e,i.USER_LEVEL.ADMIN,"/CMD_DNS_ADMIN"),(0,o.default)(e,i.USER_LEVEL.USER,"/CMD_DNS_CONTROL"),e),s=(0,r.State)("app.route.path");return s?s.includes("".concat(i.USER_LEVEL.ADMIN,"/"))?t[i.USER_LEVEL.ADMIN]:t[i.USER_LEVEL.USER]:t[(0,r.State)("app.user.accessLevel")]},u=a.default.post({url:l,params:{action:"dnssec"},domain:!0}),d=u.extend({params:{generate_keys:!0}});t.generateKeys=d;var c=u.extend({params:{sign_zone:!0}});t.signZone=c;var p=function(e){return e?new Date(e.replace(/.*\((.*)\)/,"$1")):""},_=function(e,t){return{keys:!!e.ksk_id,zone:"no"!==e.DNS_DS,zoneOutdated:!(!e.signed_on||!e.ksk_created)&&t.convert.toAppDate(e.signed_on)<p(e.ksk_created)}},v=function(e,t){return t.flow(t.project({expiryDate:"expiry",signedDate:"signed_on",DLV:"DLV",DS:"DS"}),t.mapProps({expiryDate:t.convert.toAppDate,signedDate:t.convert.toAppDate,DLV:t.convert.toAppHtml,DS:t.convert.toAppHtml}))(e)},m=function(e,t){return t.flow(t.project({"zone.published":"zsk_publish","zone.id":"zsk_id","zone.created":"zsk_created","zone.activated":"zsk_activate","zone.key":"zsk_DNSKEY","key.published":"ksk_publish","key.id":"ksk_id","key.created":"ksk_created","key.activated":"ksk_activate","key.key":"ksk_DNSKEY"}),t.mapProps({zone:t.mapProps({published:p,created:p,activated:p}),key:t.mapProps({published:p,created:p,activated:p})}))(e)},y=a.default.post({url:l,id:"DNSSEC",params:{action:"dnssec",value:"get_keys"},domain:!0,response:{keys:!1,zone:!1},notifySuccess:!1,after:function(e){return function(t){return{status:_(t,e),zone:v(t,e),keys:m(t,e)}}}});t.getData=y;var f=a.default.post({url:l,params:{action:"dnssec",remove_dnssec:!0},schema:{ptr:a.default.OPTIONAL_STRING,domain:a.default.REQUIRED_STRING},domain:!0});t.clearZone=f},"./src/js/pages/user/dns/_components/zone-key.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return a}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_components/zone-key.vue?vue&type=script&lang=js&"),o=n.Z,a=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"zone-key"},[s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            ID\n        ")]),e._v(" "),s("span",{attrs:{slot:"content"},domProps:{textContent:e._s(e.id)},slot:"content"})],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Created\n        ")]),e._v(" "),s("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e._f("date")(e.created)))])],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Published\n        ")]),e._v(" "),s("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e._f("date")(e.published)))])],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Activated\n        ")]),e._v(" "),s("span",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e._f("date")(e.activated)))])],1),e._v(" "),s("ui-form-element",{attrs:{vertical:""}},[s("ui-code-area",{attrs:{slot:"content","break-lines":"",content:e.value},slot:"content"})],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/user/dns/_dialogs/confirm-dnssec-action.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return a}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/_dialogs/confirm-dnssec-action.vue?vue&type=script&lang=js&"),o=n.Z,a=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"CONFIRM_DNSSEC_DIALOG",theme:"danger","no-close-btn":""}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        DNSSEC\n    ")]),e._v(" "),s("translate",{attrs:{slot:"content",tag:"div"},slot:"content"},[e._v("\n        This action could cause domain resolution problems and cannot be undone. Are you sure you want to proceed?\n    ")]),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"danger"},on:{click:function(t){return e.$emit("confirm")}},slot:"buttons"},[s("translate",[e._v("Confirm")])],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"neutral"},on:{click:function(t){return e.$emit("cancel")}},slot:"buttons"},[s("translate",[e._v("Cancel")])],1)],1)}),[],!1,null,null,null).exports},"./src/js/pages/user/dns/security.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return n.X},default:function(){return u}});var n=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/dns/security.vue?vue&type=script&lang=js&"),o=n.Z,a=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),r=s("./src/js/pages/user/dns/security.vue?vue&type=custom&index=0&blockType=route"),i=s.n(r),l=(0,a.Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:[{label:e.$gettext("Re-sign your zone"),visible:e.$api.status.zone&&e.$api.status.zoneOutdated,handler:e.signZone,icon:"#console"},{label:e.$gettext("Sign your Zone"),visible:e.$api.status.keys&&!e.$api.status.zone,handler:e.signZone,icon:"#console"},{label:e.$gettext("Clear Zone"),visible:e.$api.status.zone||e.$api.status.keys,handler:e.requestConfirmation(e.clearZone),icon:"#cancel"},{label:e.$gettext("Generate Keys"),handler:e.requestConfirmation(e.generateKeys),icon:"#plus-fill"}]}},[s("template",{slot:"header:buttons"},[e.$api.status.zone&&e.$api.status.zoneOutdated?s("ui-button",{attrs:{theme:"primary"},on:{click:e.signZone}},[s("translate",[e._v("Re-sign your zone")])],1):e._e(),e._v(" "),e.$api.status.keys&&!e.$api.status.zone?s("ui-button",{attrs:{theme:"primary"},on:{click:e.signZone}},[s("translate",[e._v("Sign your zone")])],1):e._e(),e._v(" "),e.$api.status.zone||e.$api.status.keys?s("ui-tooltip",[s("ui-button",{attrs:{slot:"trigger",theme:"danger"},on:{click:e.clearZone},slot:"trigger"},[s("translate",[e._v("Clear Zone")])],1),e._v(" "),s("translate",[e._v("This action will delete all keys and revert to non-signed zone")])],1):e._e(),e._v(" "),s("ui-button",{attrs:{theme:"safe"},on:{click:e.generateKeys}},[s("translate",[e._v("Generate Keys")])],1)],1),e._v(" "),e.$api.status.zone?s("app-page-section",[s("ui-grid",{attrs:{slot:"section:title",cross:"center"},slot:"section:title"},[s("translate",[e._v("Zone Signing")]),e._v(" "),e.$api.status.zoneOutdated?s("ui-badge",{attrs:{theme:"danger"}},[s("translate",[e._v("Zone keys are newer than the Zone Signing.")])],1):e._e()],1),e._v(" "),e._l(e.zoneRows,(function(t){return s("ui-form-element",{key:t.label,attrs:{vertical:e.$_Client.isPhone}},[s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.label))]),e._v(" "),s("template",{slot:"content"},[t.date?s("span",[e._v(e._s(e._f("date")(t.value)))]):s("ui-code-area",{attrs:{"break-lines":"",content:t.value}})],1)],2)}))],2):e._e(),e._v(" "),e.$api.status.keys?s("app-page-section",[s("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("\n            Zone Keys\n        ")]),e._v(" "),s("table",[s("tr",[s("translate",{attrs:{tag:"th"}},[e._v("\n                    Key\n                ")]),e._v(" "),s("translate",{attrs:{tag:"th"}},[e._v("\n                    ID\n                ")]),e._v(" "),s("translate",{attrs:{tag:"th"}},[e._v("\n                    Created\n                ")]),e._v(" "),s("translate",{attrs:{tag:"th"}},[e._v("\n                    Published\n                ")]),e._v(" "),s("translate",{attrs:{tag:"th"}},[e._v("\n                    Activated\n                ")])],1),e._v(" "),e._l(e.keysRows,(function(t){return[s("tr",{key:t.id+"-first"},[s("td",{staticClass:"txt:bold"},[e._v("\n                        "+e._s(t.id)+"\n                    ")]),e._v(" "),s("td",[e._v(e._s(t.data.id))]),e._v(" "),s("td",[e._v(e._s(e._f("date")(t.data.created)))]),e._v(" "),s("td",[e._v(e._s(e._f("date")(t.data.published)))]),e._v(" "),s("td",[e._v(e._s(e._f("date")(t.data.activated)))])]),e._v(" "),s("tr",{key:t.id+"-second"},[s("td",{attrs:{colspan:"5"}},[s("ui-code-area",{attrs:{"break-lines":"",content:t.data.key}})],1)])]}))],2),e._v(" "),s("ui-tabs",{attrs:{tabs:[{id:"zone",label:this.$gettext("Zone-Signing Key")},{id:"key",label:this.$gettext("Key-Signing Key")}]}},[s("zone-key",e._b({attrs:{slot:"tab:zone",value:e.$api.keys.zone.key},slot:"tab:zone"},"zone-key",e.$api.keys.zone,!1)),e._v(" "),s("zone-key",e._b({attrs:{slot:"tab:key",value:e.$api.keys.key.key},slot:"tab:key"},"zone-key",e.$api.keys.key,!1))],1)],1):e._e(),e._v(" "),e.$api.status.keys?e._e():s("app-page-section",[s("translate",{staticClass:"c:txt:danger"},[e._v("\n            Keys not yet generated.\n        ")])],1),e._v(" "),s("confirm-dialog",{on:{confirm:e.doAction,cancel:e.cancelAction}})],2)}),[],!1,null,null,null);"function"==typeof i()&&i()(l);var u=l.exports},"./src/js/pages/user/dns/security.vue?vue&type=custom&index=0&blockType=route":function(){}}]);