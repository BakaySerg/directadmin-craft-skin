(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{1839:function(t,e,n){"use strict";n.r(e);var r=n(4037),o=n(2667);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var l=n(0),a=n(3688),s=n.n(a),u=Object(l.a)(o.default,r.a,r.b,!1,null,null,null);"function"==typeof s.a&&s()(u),e.default=u.exports},2667:function(t,e,n){"use strict";n.r(e);var r=n(2668),o=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e.default=o.a},2668:function(t,e,n){"use strict";n(7),n(10),n(5),n(6),n(8),n(11),n(25);var r=n(1),o=n(19);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(36)),l=r(n(44)),a=r(n(2)),s=r(n(37));n(34),n(55),n(16),n(14),n(2669),n(23),n(18),n(24);var u=p(n(3687)),c=p(n(9));function d(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(d=function(t){return t?n:e})(t)}function p(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var n=d(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var a=i?Object.getOwnPropertyDescriptor(t,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=t[l]}return r.default=t,n&&n.set(t,r),r}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){(0,a.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h,b,O={commands:u,preload:u.getHotlinkOptions,data:function(){return{allowBlankReferer:!1,urls:[],files:"",redirectTo:"forbidden",url:"",checkedRows:[],newUrl:""}},api:[{command:u.getHotlinkOptions,bind:{"response.urls":"urls","response.options":"options"}}],computed:{select:function(){return this.checkedRows.map((function(t){return t.url}))},urlString:function(){return this.urls.map((function(t){return t.url})).join("\n")},requestData:function(){return{enabled:this.$api.options.hotlinksEnabled?"yes":"no",allow_blank_referer:this.allowBlankReferer?"yes":"no",urls:this.urlString,files:this.files,redirect:this.redirectTo,redirect_url:this.url}}},created:function(){this.urls=c.clone(this.$api.urls),this.files=this.$api.options.files.join(","),this.allowBlankReferer=this.$api.options.hotlinkAllowBlankReferer,this.url=this.$api.options.url,this.redirectTo=this.$api.options.redirectTo},methods:{loadOptions:(b=(0,s.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.getHotlinkOptions();case 2:this.urls=c.clone(this.$api.urls);case 3:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)}),deleteUrls:(h=(0,s.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.deleteHotlinkUrls({select:this.select}).then(this.loadOptions);case 2:this.checkedRows=[];case 3:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)}),changeHotlinksStatus:function(t){u.saveOptions(v(v({},this.requestData),{},{enabled:t?"yes":"no"})).then(this.loadOptions)},saveOptions:function(){u.saveOptions(this.requestData).then(this.loadOptions)},addMyDomains:function(){var t=(0,l.default)(new Set([].concat((0,l.default)(this.urls.map((function(t){return t.url}))),(0,l.default)(this.$api.options.domains)))).join("\n");u.saveOptions(v(v({},this.requestData),{},{urls:t})).then(this.loadOptions)},addUrl:function(){this.urls.push({url:this.newUrl}),this.newUrl="",this.saveOptions()}}};e.default=O},2669:function(t,e,n){"use strict";var r=n(722),o=n(947);t.exports=r("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),o)},3687:function(t,e,n){"use strict";n(7),n(10),n(6),n(8),n(11),n(16),n(14),n(23),n(25),n(18);var r=n(1),o=n(19);Object.defineProperty(e,"__esModule",{value:!0}),e.saveOptions=e.deleteHotlinkUrls=e.getHotlinkOptions=void 0;var i=r(n(2));n(5),n(21),n(61),n(12);var l=r(n(78)),a=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var n=s(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var a=i?Object.getOwnPropertyDescriptor(t,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=t[l]}r.default=t,n&&n.set(t,r);return r}(n(9));n(97);function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(s=function(t){return t?n:e})(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d=l.default.get({id:"HOTLINK_OPTIONS",url:"/CMD_HOTLINK",params:{ipp:99999,page:1},domain:!0,mapResponse:{urls:a.pipe(a.prop("data"),a.omit("info"),a.values,a.filter(a.pipe(a.prop("url"),Boolean))),options:function(t){var e=t.options,n=function(t){return"checked"===e[t]};return{domains:t.options.MY_DOMAINS_LIST.split("\\n").filter(Boolean),hotlinkAllowBlankReferer:n("HOTLINK_ALLOW_BLANK_REFERER_CHECKED"),hotlinksEnabled:n("HOTLINK_ENALBED_CHECKED"),files:e.HOTLINK_PROTECT_FILES.split(","),redirectToForbidden:n("REDIRECT_TO_FORBIDDEN"),redirectToUrl:n("REDIRECT_TO_URL_CHECKED"),redirectTo:n("REDIRECT_TO_FORBIDDEN_CHECKED")?"forbidden":"url",url:e.REDIRECT_URL}}}});e.getHotlinkOptions=d;var p=l.default.select({url:"/CMD_HOTLINK",params:{action:"multiple",delete:!0},domain:!0});e.deleteHotlinkUrls=p;var f=l.default.post({url:"/CMD_HOTLINK",params:{action:"save"},domain:!0,schema:{enabled:c(c({},l.default.REQUIRED_STRING),{},{validator:function(t){return["yes","no"].includes(t)}}),allow_blank_referer:c(c({},l.default.REQUIRED_STRING),{},{validator:function(t){return["yes","no"].includes(t)}}),urls:l.default.REQUIRED_STRING,files:l.default.REQUIRED_STRING,redirect:c(c({},l.default.REQUIRED_STRING),{},{validator:function(t){return["forbidden","url"].includes(t)}}),redirect_url:l.default.OPTIONAL_STRING}});e.saveOptions=f},3688:function(t,e){},4037:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",{attrs:{actions:[{label:t.$gettext("Enable Hotlinks Protection"),handler:function(){return t.changeHotlinksStatus(!0)},icon:"#settings",visible:!1===t.$api.options.hotlinksEnabled},{label:t.$gettext("Disable Hotlinks Protection"),handler:function(){return t.changeHotlinksStatus(!0)},icon:"#settings",visible:!0===t.$api.options.hotlinksEnabled},{label:t.$gettext("Add My Domains"),handler:t.addMyDomains,icon:"#plus-fill",visible:!0===t.$api.options.hotlinksEnabled}]}},[n("template",{slot:"header:buttons"},[t.$api.options.hotlinksEnabled?n("ui-button",{attrs:{theme:"danger",size:"big"},on:{click:function(e){return t.changeHotlinksStatus(!1)}}},[n("translate",[t._v("Disable Hotlinks Protection")])],1):n("ui-button",{key:"enableHotlinks",attrs:{theme:"safe",size:"big"},on:{click:function(e){return t.changeHotlinksStatus(!0)}}},[n("translate",[t._v("Enable Hotlinks Protection")])],1),t._v(" "),t.$api.options.hotlinksEnabled?n("ui-button",{attrs:{size:"big",theme:"primary"},on:{click:t.addMyDomains}},[n("translate",[t._v("Add My Domains")])],1):t._e()],1),t._v(" "),n("app-page-section",[n("ui-r-table",{attrs:{rows:t.urls,columns:[{id:"url",label:t.$gettext("URL")}],"is-sortable":"","is-checkable":"","disable-pagination":"","checked-rows":t.checkedRows,"vertical-layout":t.$_Client.isPhone},on:{"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}}},[n("ui-table-action",{attrs:{slot:"table:actions"},on:{click:t.deleteUrls},slot:"table:actions"},[n("translate",[t._v("Delete")])],1)],1),t._v(" "),n("ui-input-group",{staticClass:"width:100%"},[n("input-text",{attrs:{slot:"input"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addUrl.apply(null,arguments)}},slot:"input",model:{value:t.newUrl,callback:function(e){t.newUrl=e},expression:"newUrl"}}),t._v(" "),n("ui-button",{attrs:{slot:"additions:right",size:"normal",theme:"safe",disabled:!t.newUrl||"url"===t.redirectTo&&!t.url},on:{click:t.addUrl},slot:"additions:right"},[n("translate",[t._v("Add")])],1)],1),t._v(" "),n("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Protected file types\n            ")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.files,callback:function(e){t.files=e},expression:"files"}})],1),t._v(" "),n("ui-form-element",[n("span",{attrs:{slot:"title"},slot:"title"}),t._v(" "),n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.allowBlankReferer,callback:function(e){t.allowBlankReferer=e},expression:"allowBlankReferer"}},[n("translate",[t._v("Allow Blank Referrer")])],1)],1),t._v(" "),n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Redirect to\n            ")]),t._v(" "),n("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center"},expression:"{\n                    cross: 'center'\n                }"}],attrs:{slot:"content"},slot:"content"},[n("input-radio",{attrs:{value:"forbidden"},model:{value:t.redirectTo,callback:function(e){t.redirectTo=e},expression:"redirectTo"}},[n("translate",[t._v("403 Forbidden")])],1),t._v(" "),n("input-radio",{directives:[{name:"margin",rawName:"v-margin",value:[,,,1],expression:"[,,,1]"}],attrs:{value:"url"},model:{value:t.redirectTo,callback:function(e){t.redirectTo=e},expression:"redirectTo"}},[n("translate",[t._v("URL")])],1)],1)],1),t._v(" "),n("transition",{attrs:{name:"fade"}},["url"===t.redirectTo?n("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                    Redirect URL\n                ")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1):t._e()],1),t._v(" "),n("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"hotlinkOptions"},on:{click:t.saveOptions},slot:"footer:buttons"},[n("translate",[t._v("Save")])],1)],1)],2)},o=[]}}]);