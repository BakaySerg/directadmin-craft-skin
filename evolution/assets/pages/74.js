(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{1771:function(e,t,n){"use strict";n.r(t);var o=n(3970),r=n(2319);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);var i=n(0),s=n(3410),l=n.n(s),u=Object(i.a)(r.default,o.a,o.b,!1,null,null,null);"function"==typeof l.a&&l()(u),t.default=u.exports},1978:function(e,t,n){"use strict";n(10),n(5),n(6),n(8),n(11);var o=n(1);Object.defineProperty(t,"__esModule",{value:!0}),t.uploadLogo=t.resetLogo=t.clearColors=t.saveColors=t.getCustomizations=t.getColors=t.uploadSkin=t.deleteSkins=t.applyGlobal=t.applySkin=t.getSkins=void 0;var r=o(n(44)),a=o(n(2));n(34),n(7),n(12),n(85),n(50),n(27),n(17);var i=o(n(78));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u="/CMD_SKINS",c=i.default.get({id:"SKINS",url:u,response:[],after:function(){return function(e){return Object.keys(e.full_list).map((function(t){return{skin:t,path:e.full_list[t],canLogo:void 0!==e.can_logo[t],owner:e.skin_owners[t]}}))}}});t.getSkins=c;var f=i.default.select({url:u,schema:{apply_as:{type:String,default:"reseller",validator:function(e){return["reseller","all"].includes(e)}}},before:function(e){var t=e.apply_as;return(0,a.default)({apply_as:null},t,!0)}});t.applySkin=f;var d=i.default.select({url:u,params:{global_docsroot:!0,json:!0}});t.applyGlobal=d;var p=i.default.select({url:u,params:{delete:!0}});t.deleteSkins=p;var h=i.default.post({url:u,params:{action:"upload",MAX_FILE_SIZE:"10485760"},schema:{name:i.default.REQUIRED_STRING,server:i.default.REQUIRED_BOOL,file:{type:File,required:!0}},fileTransfer:!0,continous:!0});t.uploadSkin=h;var v=i.default.get({url:u,id:"SKIN_COLORS",response:[],params:{action:"edit_customization"},schema:{name:i.default.REQUIRED_STRING},after:function(){return function(e){for(var t=parseInt(e.SKIN_NUM_CUSTOM_COLORS,10),n=[],o=1;o<=t;o+=1){var r=e["SKIN_DEFAULT_CUSTOM_COLOR_".concat(o)],a=e["SKIN_CUSTOM_COLOR_".concat(o,"_OPTIONS")];n.push({current:e["SKIN_CUSTOM_COLOR_".concat(o)],default:r,options:"ANY"===a?"*":Object.values(a)})}return n}}});t.getColors=v;var _=function(e){return function(t){return{custom:"1"===t["HAS_CUSTOM_".concat(e.toUpperCase(),"_TOKEN")],token:t["CUSTOM_".concat(e.toUpperCase(),"_TOKEN")]}}},m=i.default.get({id:"SKIN_CUSTOMIZATIONS",url:u,params:{action:"edit_customization"},schema:{name:i.default.REQUIRED_STRING},mapResponse:{colors:function(e){return"1"===e.HAS_CUSTOMIZATION&&!!e.SKIN_CUSTOM_COLOR_1},uploads:{logo:_("logo"),logo2:_("logo2"),favicon:_("favicon"),symbol:_("symbol"),symbol2:_("symbol2")}}});t.getCustomizations=m;var k=i.default.post({url:u,params:{save:!0,action:"select_custom_color"},schema:{name:i.default.REQUIRED_STRING,colors:{type:Array,required:!0}},before:function(e){return e.colors.reduce((function(e,t,n){var o;return l(l({},e),{},(o={},(0,a.default)(o,"color".concat(n+1),t),(0,a.default)(o,"color_check_".concat(n+1),n+1),o))}),{colors:null})}});t.saveColors=k;var S=i.default.post({url:u,params:{action:"select_custom_color",clear_customization:!0},schema:{name:i.default.REQUIRED_STRING,count:{type:Number,required:!0}},before:function(e){var t=e.count;return(0,r.default)(Array(t)).reduce((function(e,t,n){return l(l({},e),{},(0,a.default)({},"color_check_".concat(n+1),n+1))}),{count:null})}});t.clearColors=S;var g=i.default.post({url:u,params:{action:"clear_custom_logo"},schema:{name:i.default.REQUIRED_STRING,which:{type:Number,required:!1,default:1,validator:function(e){return e>=1&&e<=5}}},fileTransfer:!0});t.resetLogo=g;var b=i.default.post({url:u,params:{action:"upload_logo"},schema:{name:i.default.REQUIRED_STRING,file:{type:File,required:!0},which:{type:Number,required:!1,default:1,validator:function(e){return e>=1&&e<=5}}},fileTransfer:!0,continous:!0,contentType:"application/json"});t.uploadLogo=b},2319:function(e,t,n){"use strict";n.r(t);var o=n(2320),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t.default=r.a},2320:function(e,t,n){"use strict";n(7),n(10),n(5),n(6),n(8),n(11);var o=n(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(36));n(34);var a=o(n(37)),i=o(n(2)),s=n(1978),l=n(13),u=o(n(3408)),c=o(n(3409));function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p,h,v,_={preload:s.getSkins,api:[{command:s.getSkins,bind:"skins"}],components:{UploadSkinDialog:u.default,CustomizeSkinDialog:c.default},data:function(){return{customizedSkin:{file:null,base64:"",colors:[]},checkedRows:[],selectedSkin:null}},computed:d(d({},(0,l.mapTokens)({currentSkin:"SKIN"})),{},{checkedSkins:function(){return this.checkedRows.map((function(e){return e.skin}))}}),methods:{reloadSkins:function(){(0,s.getSkins)(),this.checkedRows=[]},deleteSkins:(v=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,s.deleteSkins)({select:this.checkedSkins}).then(this.reloadSkins);case 1:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),applySkin:(h=(0,a.default)(r.default.mark((function e(t){var n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.$state.app.tokens.SKIN,e.next=3,(0,s.applySkin)({select:this.checkedSkins,apply_as:t});case 3:return e.next=5,this.$store.dispatch("app/GET_TOKENS");case 5:this.$state.app.tokens.SKIN!==n&&(window.location="/CMD_SKINS");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)}),setGlobal:(p=(0,a.default)(r.default.mark((function e(){var t;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$state.app.tokens.SKIN,e.next=3,(0,s.applyGlobal)({select:this.checkedSkins});case 3:return e.next=5,this.$store.dispatch("app/GET_TOKENS");case 5:this.$state.app.tokens.SKIN!==t&&(window.location="/CMD_SKINS");case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),customizeSkin:function(e){e!==this.currentSkin?(this.selectedSkin=e,this.$dialog("CUSTOMIZE_SKIN_DIALOG").open()):this.$router.push({name:"reseller/customize-skin"})}}};t.default=_},2321:function(e,t,n){"use strict";n.r(t);var o=n(2322),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t.default=r.a},2322:function(e,t,n){"use strict";var o=n(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(36));n(26);var a,i=o(n(37)),s=n(1978),l={data:function(){return{name:"",serverwide:!0,file:null}},methods:{uploadSkin:(a=(0,i.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.uploadSkin)({file:this.file,name:this.name,server:this.serverwide});case 2:e.sent&&(this.$emit("uploaded"),this.$dialog("UPLOAD_SKIN_DIALOG").close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}};t.default=l},2323:function(e,t,n){"use strict";n.r(t);var o=n(2324),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t.default=r.a},2324:function(e,t,n){"use strict";var o=n(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(36)),a=o(n(37));n(24),n(26);var i,s,l,u,c=n(1978),f={components:{DropzoneFilePreview:o(n(948)).default},inheritAttrs:!1,props:{skin:String},data:function(){return{file:null,colors:[],colorOptions:[],customizations:{}}},computed:{defaultLogo:function(){return this.skin?"/CMD_SKINS?action=view_custom_logo&name=".concat(this.skin,"&").concat(Date.now()):""},defaultLogoVisible:function(){return this.file&&!this.file.name}},methods:{resetState:function(){this.$reset(),this.resetLogoPreview()},handleOpen:(u=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.getColors)({name:this.skin});case 2:return this.colorOptions=e.sent,e.next=5,(0,c.getCustomizations)({name:this.skin});case 5:this.customizations=e.sent;case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),handleReset:(l=(0,a.default)(r.default.mark((function e(t){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("logo"!==t){e.next=3;break}return e.next=3,this.resetLogo();case 3:if("colors"!==t){e.next=6;break}return e.next=6,this.resetColors();case 6:this.$emit("customized"),this.close();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)}),handleSave:(s=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.defaultLogoVisible){e.next=3;break}return e.next=3,this.uploadLogo();case 3:if(!this.colors.length){e.next=6;break}return e.next=6,this.saveColors();case 6:this.close(),this.$emit("customized");case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),close:function(){this.$dialog("CUSTOMIZE_SKIN_DIALOG").close()},resetColors:function(){(0,c.clearColors)({name:this.skin,count:this.colorOptions.length})},resetLogo:function(){(0,c.resetLogo)({name:this.skin})},uploadLogo:function(){(0,c.uploadLogo)({name:this.skin,file:this.file})},saveColors:(i=(0,a.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,c.saveColors)({name:this.skin,colors:this.colors});case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),resetLogoPreview:function(){this.file=new File([],"")}},created:function(){this.resetLogoPreview()}};t.default=f},3408:function(e,t,n){"use strict";n.r(t);var o=n(4123),r=n(2321);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);var i=n(0),s=Object(i.a)(r.default,o.a,o.b,!1,null,null,null);t.default=s.exports},3409:function(e,t,n){"use strict";n.r(t);var o=n(4124),r=n(2323);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);var i=n(0),s=Object(i.a)(r.default,o.a,o.b,!1,null,null,null);t.default=s.exports},3410:function(e,t){},3970:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-page",{attrs:{actions:[{handler:e.$dialog("UPLOAD_SKIN_DIALOG").open,label:e.$gettext("Upload Skin"),icon:"#upload"}]}},[n("template",{slot:"header:buttons"},[n("ui-button",{attrs:{theme:"safe"},on:{click:function(t){e.$dialog("UPLOAD_SKIN_DIALOG").open()}}},[n("translate",[e._v("Upload Skin")])],1)],1),e._v(" "),n("app-page-section",[n("ui-r-table",{attrs:{rows:e.$api.skins,columns:[{id:"skin",label:e.$gettext("Skin Name"),grow:!0,editable:!1},{id:"path",label:e.$gettext("Path")},{id:"owner",label:e.$gettext("Skin Owner")}],"vertical-layout":e.$_Client.isPhone,"checked-rows":e.checkedRows,"disable-pagination":""},on:{"update:checkedRows":function(t){e.checkedRows=t},"update:checked-rows":function(t){e.checkedRows=t}},scopedSlots:e._u([{key:"col:skin",fn:function(t){var o=t.skin;return n("ui-grid",{},[n("span",[e._v(e._s(o))]),e._v(" "),o===e.currentSkin?n("ui-badge",{attrs:{theme:"primary",size:"small"}},[n("translate",[e._v("Current")])],1):e._e()],1)}},{key:"row:actions",fn:function(t){var o=t.item;return o.canLogo?n("ui-button-icon",{attrs:{icon:"pencil",title:e.$gettext("Customize")},on:{click:function(t){return e.customizeSkin(o.skin)}}}):e._e()}}],null,!0)},[n("template",{slot:"table:actions"},[1===e.checkedSkins.length?n("ui-table-action",{on:{click:function(t){return e.applySkin("reseller")}}},[n("translate",[e._v("Apply to Me")])],1):e._e(),e._v(" "),1===e.checkedSkins.length?n("ui-table-action",{on:{click:function(t){return e.applySkin("all")}}},[n("translate",[e._v("Apply to All Users")])],1):e._e(),e._v(" "),e.$state.app.user.canBe("admin")?n("ui-table-action",{attrs:{disabled:1!==e.checkedSkins.length},on:{click:e.setGlobal}},[n("translate",[e._v("Set Global")])],1):e._e(),e._v(" "),n("ui-table-action",{on:{click:function(t){e.$dialog("DELETE_SKINS_DIALOG").open()}}},[n("translate",[e._v("Delete")])],1)],1)],2)],1),e._v(" "),n("upload-skin-dialog",{on:{uploaded:e.reloadSkins}}),e._v(" "),n("customize-skin-dialog",{attrs:{skin:e.selectedSkin},on:{"dialog:close":function(t){e.selectedSkin=null},customized:e.reloadSkins}}),e._v(" "),n("ui-dialog-delete-items",{attrs:{id:"DELETE_SKINS_DIALOG",subject:e.$ngettext("selected skin","selected skins",e.checkedSkins.length)},on:{"click:confirm":e.deleteSkins}})],2)},r=[]},4123:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-dialog",e._g({attrs:{id:"UPLOAD_SKIN_DIALOG",noAutoClose:""},on:{"dialog:close":e.$reset}},e.$listeners),[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Upload Skin")]),e._v(" "),n("template",{slot:"content"},[n("ui-form-element",{attrs:{underline:!1}},[n("input-dropzone",{attrs:{slot:"content",accept:[".tar.gz"]},slot:"content",model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),n("ui-form-element",{attrs:{group:"uploadSkin",validators:{required:!0},vertical:""}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Name")]),e._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[n("input-checkbox-button",{attrs:{slot:"additions:right"},slot:"additions:right",model:{value:e.serverwide,callback:function(t){e.serverwide=t},expression:"serverwide"}},[n("translate",{staticClass:"wrap:nowrap"},[e._v("Server wide")])],1)],1)],1)],1),e._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe",validateGroup:"uploadSkin",disabled:!e.file},on:{click:e.uploadSkin},slot:"buttons"},[n("translate",[e._v("Upload")])],1)],2)},r=[]},4124:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-dialog",e._g({attrs:{id:"CUSTOMIZE_SKIN_DIALOG",size:"normal",theme:"primary",noAutoClose:""},on:{"dialog:open":e.handleOpen,"dialog:close":e.resetState}},e.$listeners),[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Customize Skin")]),e._v(" "),n("template",{slot:"content"},[n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Logo")]),e._v(" "),n("input-dropzone",{attrs:{slot:"content",accept:["image/*"]},slot:"content",model:{value:e.file,callback:function(t){e.file=t},expression:"file"}},[e.file?n("dropzone-file-preview",e._b({attrs:{slot:"preview",image:e.defaultLogoVisible?e.defaultLogo:"",noInfo:"",showPreview:""},on:{removeFile:function(t){e.file=null}},slot:"preview"},"dropzone-file-preview",{file:e.file},!1)):e._e()],1)],1),e._v(" "),e._l(e.colorOptions,(function(t,o){return n("ui-form-element",{key:o},[n("translate",{attrs:{slot:"title","translate-params":{index:o+1}},slot:"title"},[e._v("\n                Custom Color %{index}\n            ")]),e._v(" "),n("input-color",{attrs:{slot:"content",colors:"*"!==t.options?t.options:void 0,value:e.colors[o]||t.current||t.default},on:{change:function(t){return e.$set(e.colors,o,t)}},slot:"content"})],1)}))],2),e._v(" "),n("template",{slot:"buttons"},[e.customizations.logo?n("ui-button",{attrs:{theme:"danger"},on:{click:function(t){return e.handleReset("logo")}}},[n("translate",[e._v("Reset logo")])],1):e._e(),e._v(" "),e.customizations.colors?n("ui-button",{attrs:{theme:"danger"},on:{click:function(t){return e.handleReset("colors")}}},[n("translate",[e._v("Reset colors")])],1):e._e(),e._v(" "),n("ui-button",{attrs:{disabled:!(e.colors.length||e.file&&!e.defaultLogoVisible),theme:"safe"},on:{click:e.handleSave}},[n("translate",[e._v("Save")])],1)],1)],2)},r=[]}}]);