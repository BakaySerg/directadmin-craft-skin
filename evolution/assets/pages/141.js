(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{1796:function(e,a,t){"use strict";t.r(a);var s=t(3994),r=t(2524);for(var n in r)["default"].indexOf(n)<0&&function(e){t.d(a,e,(function(){return r[e]}))}(n);var i=t(0),o=t(3582),d=t.n(o),l=Object(i.a)(r.default,s.a,s.b,!1,null,null,null);"function"==typeof d.a&&d()(l),a.default=l.exports},1884:function(e,a,t){"use strict";var s=t(1);Object.defineProperty(a,"__esModule",{value:!0}),a.validateIPRangeList=a.validateDomain=a.validatePassword=a.validateSubdomain=a.validateUsername=a.validateDBUser=a.validateDatabase=a.validateDNSName=a.validateMXValue=a.validateDNSValue=a.validateFTP=a.validateEmail=a.validateForwarder=void 0;var r=s(t(78)),n=s(t(98)),i=s(t(1885)),o=r.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:r.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:i.default.isValid,message:i.default.getMessage}}),d=o.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});a.validateForwarder=d;var l=o.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});a.validateEmail=l;var u=o.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});a.validateFTP=u;var p=o.extend({params:{type:"dns"},domain:!0,schema:{record:r.default.REQUIRED_STRING}}),m=p.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:r.default.REQUIRED_STRING}});a.validateDNSValue=m;var c=m.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(e){return{value:"10",mx_value:e.value}}});a.validateMXValue=c;var f=p.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:r.default.REQUIRED_STRING,value:null}});a.validateDNSName=f;var _=o.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});a.validateDatabase=_;var v=o.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});a.validateDBUser=v;var D=o.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});a.validateUsername=D;var b=o.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});a.validateSubdomain=b;var E=o.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});a.validatePassword=E;var R=o.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(e){var a=e.value;return{value:n.default.toASCII(a)}}});a.validateDomain=R;var h=o.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});a.validateIPRangeList=h},1885:function(e,a,t){"use strict";t.r(a);var s=t(97);a.default={isValid:function(e){return void 0===e.error},getMessage:function(e){return Object(s.toAppHtml)(e.error||"")}}},1895:function(e,a,t){"use strict";t(16),t(14),t(23),t(25),t(18),t(6);var s=t(1),r=t(19);Object.defineProperty(a,"__esModule",{value:!0}),a.getLoginPMAStatus=a.globalLoginPMA=a.loginPMA=a.setUserPrivs=a.getUserPrivs=a.changeUserPassword=a.assignUser=a.addUser=a.deleteAccessHost=a.addAccessHost=a.deleteUsers=a.getDatabase=a.uploadBackup=a.deleteDatabase=a.optimizeDatabase=a.checkDatabase=a.repairDatabase=a.getDatabases=a.createDatabase=a.getUsers=void 0;var n=s(t(78)),i=function(e,a){if(!a&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=o(a);if(t&&t.has(e))return t.get(e);var s={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=n?Object.getOwnPropertyDescriptor(e,i):null;d&&(d.get||d.set)?Object.defineProperty(s,i,d):s[i]=e[i]}s.default=e,t&&t.set(e,s);return s}(t(9));function o(e){if("function"!=typeof WeakMap)return null;var a=new WeakMap,t=new WeakMap;return(o=function(e){return e?t:a})(e)}var d=n.default.get({id:"DB_USERS",url:"/CMD_DB_CREATE",domain:!0,mapResponse:{users:i.pipe(i.omit(["MAX_DB_LENGTH","MAX_DB_USER_LENGTH"]),i.values,i.filter((function(e){return"..."!==e.text})),i.map((function(e){return{value:e.value,label:e.text}}))),max_db_length:i.prop("MAX_DB_LENGTH"),max_db_user_length:i.prop("MAX_DB_USER_LENGTH")}});a.getUsers=d;var l=n.default.post({url:"/CMD_DB",params:{action:"create"},domain:!0,schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING,passwd:n.default.OPTIONAL_STRING,passwd2:n.default.OPTIONAL_STRING,userlist:n.default.OPTIONAL_STRING},after:function(e){return e.mapProp("result",e.convert.toAppHtml)}});a.createDatabase=l;var u=n.default.get({id:"DATABASES",url:"/CMD_DB",domain:!0,pagination:!0,after:function(e){return e.mapProps({databases:e.toTable(e.mapArrayProps({nusers:e.convert.toAppNumber,size:e.convert.toAppNumber})),HAVE_ONE_CLICK_PMA_LOGIN:e.convert.toAppBoolean,total_usage:e.convert.toAppNumber,dbs_select:e.toSelect})}});a.getDatabases=u;var p=n.default.select({url:"/CMD_DB",domain:!0,params:{json:!0}}),m=p.extend({params:{repair:!0}});a.repairDatabase=m;var c=p.extend({params:{check:!0}});a.checkDatabase=c;var f=p.extend({params:{optimize:!0}});a.optimizeDatabase=f;var _=p.extend({params:{delete_db:!0}});a.deleteDatabase=_;var v=n.default.post({url:"/CMD_DB",params:{action:"restore",method:"default"},domain:!0,schema:{name:n.default.REQUIRED_STRING,dbuser:n.default.REQUIRED_STRING,dbpass:n.default.REQUIRED_STRING,file:{type:File,required:!0}},before:function(e){return{file1:e.file,file:null}},fileTransfer:!0,continous:!0});a.uploadBackup=v;var D=n.default.get({id:"DB_VIEW",url:"/CMD_DB_VIEW",params:{page:1,ipp:9999},domain:!0,schema:{name:n.default.REQUIRED_STRING},after:function(e){return e.flow(e.project({hosts:"access_hosts",users:"db_users",pmaLogin:"HAVE_ONE_CLICK_PMA_LOGIN"}),e.mapProps({users:e.flow(e.deleteProp("info"),e.toArray,e.mapArray(e.getProp("User"))),hosts:e.flow(e.deleteProp("info"),e.toArray,e.mapArray(e.getProp("Access Hosts"))),pmaLogin:e.convert.toAppBoolean}))}});a.getDatabase=D;var b=n.default.post({url:"/CMD_DB",method:"POST",params:{action:"deleteuser",delete:!0,json:!0},domain:!0,schema:{name:n.default.REQUIRED_STRING,select:n.default.ROWS}});a.deleteUsers=b;var E=n.default.post({url:"/CMD_DB_ACCESS",domain:!0,params:{add:!0,json:!0},schema:{name:n.default.REQUIRED_STRING,host:n.default.REQUIRED_STRING}});a.addAccessHost=E;var R=n.default.select({url:"/CMD_DB_ACCESS",domain:!0,params:{delete:!0,json:!0},schema:{name:n.default.REQUIRED_STRING}});a.deleteAccessHost=R;var h=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"createuser",json:!0},schema:{name:n.default.REQUIRED_STRING,passwd:n.default.REQUIRED_STRING,passwd2:n.default.REQUIRED_STRING}});a.addUser=h;var I=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"createuser",json:!0,passwd:"*****",passwd2:"*****"},schema:{name:n.default.REQUIRED_STRING,userlist:n.default.REQUIRED_STRING}});a.assignUser=I;var g=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"modifyuser",json:!0},schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING,passwd:n.default.REQUIRED_STRING,passwd2:n.default.REQUIRED_STRING}});a.changeUserPassword=g;var U=n.default.get({id:"DB_USER_PRIVS",url:"/CMD_DB_USER_PRIVS",domain:!0,schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING},after:function(e){return e.mapValues(e.isEqual("Y"))}});a.getUserPrivs=U;var A=n.default.post({url:"/CMD_DB_USER_PRIVS",domain:!0,params:{action:"save "},body:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING}});a.setUserPrivs=A;var N=n.default.post({url:"/CMD_PMA_LOGIN",domain:!0,params:{json:!0},notifySuccess:!1,notifyError:!1,schema:{name:n.default.REQUIRED_STRING}});a.loginPMA=N;var S=n.default.post({url:"/CMD_PMA_LOGIN",params:{json:!0,name:"all",domain:""},notifySuccess:!1,notifyError:!1});a.globalLoginPMA=S;var T=n.default.get({url:"/CMD_DB",response:!1,mapResponse:function(e){return"yes"===e.HAVE_ONE_CLICK_PMA_LOGIN},notifyError:!1});a.getLoginPMAStatus=T},2524:function(e,a,t){"use strict";t.r(a);var s=t(2525),r=t.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){t.d(a,e,(function(){return s[e]}))}(n);a.default=r.a},2525:function(e,a,t){"use strict";var s=t(1);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=s(t(36)),n=s(t(37));t(34),t(57),t(17),t(26);var i,o,d=t(1884),l=t(1895),u={preload:l.getUsers,api:[{command:l.getUsers,bind:{"response.users":"users","response.max_db_length":"max_db_length","response.max_db_user_length":"max_db_user_length"}},{command:d.validateDBUser,bind:"dbUserValidation"}],commands:{validateDatabase:d.validateDatabase,validatePassword:d.validatePassword},data:function(){return{dbName:"",dbUser:"",dbPassword:"",copyDBName:!0}},computed:{dbUsers:function(){return this.$api.users.map((function(e){return e.value}))},existingUser:function(){var e=this;return!!this.dbUsers.find((function(a){return a===e.dbUser}))},maxDBLength:function(){return Number(this.$api.max_db_length)||1/0},maxUsernameLength:function(){return Number(this.$api.max_db_user_length)||1/0}},watch:{dbName:function(e){e&&this.copyDBName&&(this.dbUser=e)}},methods:{createDatabase:(o=(0,n.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.createDatabase)({name:this.dbName,user:this.dbUser,passwd:this.existingUser?"******":this.dbPassword,passwd2:this.existingUser?"******":this.dbPassword,userlist:this.existingUser?this.dbUser:"..."});case 2:e.sent&&(this.$store.dispatch("app/GET_TOKENS"),this.$router.push({name:"user/database"}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),usernameValidation:(i=(0,n.default)(r.default.mark((function e(a){var t,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&!this.existingUser){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,(0,d.validateDBUser)({value:a});case 4:return t=e.sent,s=t.valid,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)}),validateLength:function(e){return!e||this.maxDBLength>e.length+this.$state.app.user.name.length+1},validateUsernameLength:function(e){return!e||this.maxUsernameLength>e.length+this.$state.app.user.name.length+1}}};a.default=u},3582:function(e,a){},3994:function(e,a,t){"use strict";t.d(a,"a",(function(){return s})),t.d(a,"b",(function(){return r}));var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("app-page",[t("app-page-section",[t("ui-form-element",{attrs:{group:"database",validators:{required:!0,api:e.$commands.validateDatabase,validateLength:e.validateLength},vertical:e.$_Client.isPhone}},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Database Name:\n            ")]),e._v(" "),t("input-text",{attrs:{slot:"content",prefix:e.$state.app.user.name+"_"},slot:"content",model:{value:e.dbName,callback:function(a){e.dbName=a},expression:"dbName"}}),e._v(" "),t("translate",{attrs:{slot:"error:validateLength"},slot:"error:validateLength"},[e._v("\n                DB Name is too long\n            ")])],1),e._v(" "),t("ui-form-element",{attrs:{group:"database",validators:{required:!0,usernameValidation:e.usernameValidation,validateUsernameLength:e.validateUsernameLength},vertical:e.$_Client.isPhone,underline:!!e.dbUser&&!e.existingUser}},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Database User:\n            ")]),e._v(" "),t("input-autocomplete",{attrs:{slot:"content",values:e.dbUsers,disabled:e.copyDBName},slot:"content",model:{value:e.dbUser,callback:function(a){e.dbUser=a},expression:"dbUser"}},[t("template",{slot:"additions:left"},[e._v("\n                    "+e._s(e.$state.app.user.name)+"_\n                ")]),e._v(" "),e.$_Client.isPhone?e._e():t("input-checkbox-button",{attrs:{slot:"additions:right"},slot:"additions:right",model:{value:e.copyDBName,callback:function(a){e.copyDBName=a},expression:"copyDBName"}},[t("translate",[e._v("Same as database name")])],1)],2),e._v(" "),t("span",{attrs:{slot:"error:usernameValidation"},domProps:{innerHTML:e._s(e.$api.dbUserValidation.message)},slot:"error:usernameValidation"}),e._v(" "),t("translate",{attrs:{slot:"error:validateUsernameLength"},slot:"error:validateUsernameLength"},[e._v("\n                Username is too long\n            ")])],1),e._v(" "),e.$_Client.isPhone?t("ui-form-element",{attrs:{vertical:""}},[t("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.copyDBName,callback:function(a){e.copyDBName=a},expression:"copyDBName"}},[t("translate",[e._v("Same as database name")])],1)],1):e._e(),e._v(" "),e.dbUser&&!e.existingUser?t("ui-form-element",{attrs:{group:"database",validators:{required:!0,api:e.$commands.validatePassword},vertical:e.$_Client.isPhone,underline:!1}},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Database Password:\n            ")]),e._v(" "),t("input-password",{attrs:{slot:"content","show-generator":""},slot:"content",model:{value:e.dbPassword,callback:function(a){e.dbPassword=a},expression:"dbPassword"}})],1):e._e()],1),e._v(" "),t("ui-button",{attrs:{slot:"footer:buttons",disabled:!e.$valid("database"),theme:"safe"},on:{click:e.createDatabase},slot:"footer:buttons"},[t("translate",[e._v("Create Database")])],1)],1)},r=[]}}]);