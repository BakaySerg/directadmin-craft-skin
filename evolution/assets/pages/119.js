(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{1824:function(t,e,a){"use strict";a.r(e);var n=a(4022),o=a(2624);for(var r in o)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(r);a(3659);var i=a(0),s=a(3661),l=a.n(s),c=Object(i.a)(o.default,n.a,n.b,!1,null,null,null);"function"==typeof l.a&&l()(c),e.default=c.exports},2037:function(t,e,a){"use strict";var n=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.validateVacationAccount=e.getVacation=e.deleteVacations=e.modifyVacation=e.createVacation=e.getVacationDefaults=e.getVacations=void 0;var o=n(a(19));a(17);var r=n(a(78)),i=function(t){return t.mapProps({custom_reply_headers:t.isEqual("1"),reply_content_types:t.toSelect,reply_encodings:t.toSelect,reply_once_select:t.toSelect})},s=r.default.get({id:"VACATIONS",url:"/CMD_EMAIL_VACATION",domain:!0,pagination:!0,after:function(t){return t.flow((function(t){return{rows:t}}),t.processTableInfo("rows"),t.mapProp("rows",t.flow(t.toArray,t.mapArray(t.flow(t.project({user:"user",start:"time.start_timestamp",end:"time.end_timestamp"}),t.mapProps({start:t.convert.toAppDate,end:t.convert.toAppDate}))))))}});e.getVacations=s;var l=r.default.get({id:"VACATION_DEFAULTS",url:"/CMD_EMAIL_VACATION_CREATE",domain:!0,after:function(t){return t.flow(t.mapProps({ENDDAY:t.toSelect,ENDMONTH:t.toSelect,ENDYEAR:t.toSelect,ENDTIME:t.toSelect,STARTDAY:t.toSelect,STARTMONTH:t.toSelect,STARTYEAR:t.toSelect,STARTTIME:t.toSelect,poplist:t.toSelect}),t.moveProp({ENDDAY:"end.day",ENDMONTH:"end.month",ENDYEAR:"end.year",ENDTIME:"end.time",STARTDAY:"start.day",STARTMONTH:"start.month",STARTYEAR:"start.year",STARTTIME:"start.time"}),t.mapProps({end:function(t){return{time:t.time,date:new Date(t.year.value,Number(t.month.value)-1,t.day.value)}},start:function(t){return{time:t.time,date:new Date(t.year.value,Number(t.month.value)-1,t.day.value)}},headers:i(t)}))}});e.getVacationDefaults=l;var c=r.default.post({url:"/CMD_EMAIL_VACATION",params:{action:"create"},domain:!0,schema:{user:r.default.REQUIRED_STRING,starttime:r.default.REQUIRED_STRING,startday:r.default.REQUIRED_STRING,startmonth:r.default.REQUIRED_STRING,startyear:r.default.REQUIRED_STRING,endtime:r.default.REQUIRED_STRING,endday:r.default.REQUIRED_STRING,endmonth:r.default.REQUIRED_STRING,endyear:r.default.REQUIRED_STRING}});e.createVacation=c;var u=c.extend({params:{action:"modify"}});e.modifyVacation=u;var d=r.default.select({url:"/CMD_EMAIL_VACATION",params:{action:"delete",delete:!0},domain:!0});e.deleteVacations=d;var f=r.default.get({id:"VACATION",url:"/CMD_EMAIL_VACATION_MODIFY",domain:!0,schema:{user:r.default.REQUIRED_STRING},after:function(t){return t.flow(t.mapProps({ENDDAY:t.toSelect,ENDMONTH:t.toSelect,ENDYEAR:t.toSelect,ENDTIME:t.toSelect,STARTDAY:t.toSelect,STARTMONTH:t.toSelect,STARTYEAR:t.toSelect,STARTTIME:t.toSelect}),t.moveProp({ENDDAY:"end.day",ENDMONTH:"end.month",ENDYEAR:"end.year",ENDTIME:"end.time",STARTDAY:"start.day",STARTMONTH:"start.month",STARTYEAR:"start.year",STARTTIME:"start.time"}),t.mapProps({end:function(t){return{time:t.time,date:new Date(t.year.value,Number(t.month.value)-1,t.day.value)}},start:function(t){return{time:t.time,date:new Date(t.year.value,Number(t.month.value)-1,t.day.value)}},text:t.convert.toAppText,headers:i(t)}))}});e.getVacation=f;var p=r.default.get({id:"VACATION_VALIDATION",domain:!0,url:"/CMD_EMAIL_VACATION",schema:{user:r.default.REQUIRED_STRING},before:function(t){return{user:null,comparison1:"equals",value1:t.user}},response:!1,mapResponse:function(t){return"object"!==(0,o.default)(t[0])}});e.validateVacationAccount=p},2624:function(t,e,a){"use strict";a.r(e);var n=a(2625),o=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e.default=o.a},2625:function(t,e,a){"use strict";a(7),a(10),a(5),a(6),a(8),a(11);var n=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(a(36)),r=n(a(37)),i=n(a(2));a(49);var s=a(2037),l=n(a(712)),c=n(a(2626));function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){(0,i.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f,p={preload:s.getVacationDefaults,api:[{command:s.getVacationDefaults,bind:"defaults"}],components:{"input-date":c.default},data:function(){return{user:"",text:"",start:new Date,starttime:"",end:new Date,endtime:"",subjectPrefix:"",contentType:"",encoding:"",onceSelect:""}},computed:{sameDay:function(){return this.start.getDate()===this.end.getDate()&&this.start.getYear()===this.end.getYear()&&this.start.getMonth()===this.end.getMonth()},today:function(){var t=new Date;return t.setHours(0,0,0),t}},created:function(){var t=this;Object.assign(this,{user:this.$api.defaults.poplist.value,start:this.$api.defaults.start.date,end:this.$api.defaults.end.date,starttime:this.$api.defaults.start.time.value,endtime:this.$api.defaults.end.time.value}),this.$api.defaults.headers&&this.$api.defaults.headers.custom_reply_headers&&(this.contentType=this.$api.defaults.headers.reply_content_types.value,this.encoding=this.$api.defaults.headers.reply_encodings.value,this.onceSelect=this.$api.defaults.headers.reply_once_select.value),this.$watch("start",(function(e){e>t.end&&(t.end=e)})),this.$watch("starttime",(function(e){t.sameDay&&t.compareTime(e,t.endtime)&&(t.endtime=e),t.$refs.endinput.$validate(t.end)})),this.$watch("endtime",(function(e){t.sameDay&&t.compareTime(t.starttime,e)&&(t.starttime=e),t.$refs.endinput.$validate(t.end)}))},methods:{compareTime:function(t,e){var a=function(t){return{morning:1,afternoon:2,evening:3}[t]};return a(t)>a(e)},toAPIDate:function(t){var e,a=this[t];return e={},(0,i.default)(e,"".concat(t,"time"),this["".concat(t,"time")]),(0,i.default)(e,"".concat(t,"day"),(0,l.default)(a,"dd",{awareOfUnicodeTokens:!0})),(0,i.default)(e,"".concat(t,"month"),(0,l.default)(a,"MM")),(0,i.default)(e,"".concat(t,"year"),(0,l.default)(a,"yyyy",{awareOfUnicodeTokens:!0})),e},requestData:function(){var t=d(d({user:this.user,text:this.text},this.toAPIDate("start")),this.toAPIDate("end"));return this.$api.defaults.headers&&this.$api.defaults.headers.custom_reply_headers&&(t.subject=this.subjectPrefix,t.reply_encoding=this.encoding,t.reply_content_type=this.contentType,t.reply_once_time=this.onceSelect),t},createVacation:(f=(0,r.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.createVacation)(this.requestData());case 2:if(!(t.sent instanceof Error)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,(0,s.getVacations)();case 7:this.$router.push({name:"user/email/vacations"});case 8:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)}),validateTime:function(){return!this.sameDay||this.compareTime(this.endtime,this.starttime)},validateVacationAccount:function(t){return!t||(0,s.validateVacationAccount)({user:t})}}};e.default=p},3129:function(t,e,a){var n=a(3660);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(4).default)("992b735e",n,!0,{})},3659:function(t,e,a){"use strict";a(3129)},3660:function(t,e,a){},3661:function(t,e){},4022:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return o}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-page",[a("app-page-section",[a("ui-form-element",{attrs:{group:"vacation",validators:{validateVacationAccount:t.validateVacationAccount}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Vacation Account:\n            ")]),t._v(" "),a("input-select",{attrs:{slot:"content",options:t.$api.defaults.poplist.options},slot:"content",model:{value:t.user,callback:function(e){t.user=e},expression:"user"}},[a("template",{slot:"additions:right"},[t._v("\n                    @"+t._s(t.$domainUnicode)+"\n                ")])],2),t._v(" "),a("translate",{attrs:{slot:"error:validateVacationAccount"},slot:"error:validateVacationAccount"},[t._v("\n                Already exists\n            ")])],1),t._v(" "),t.contentType?[a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                    Subject Prefix\n                ")]),t._v(" "),a("input-text",{attrs:{slot:"content",suffix:t.$gettext(": original subject")},slot:"content",model:{value:t.subjectPrefix,callback:function(e){t.subjectPrefix=e},expression:"subjectPrefix"}})],1),t._v(" "),a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                    Content-Type\n                ")]),t._v(" "),a("input-select",{attrs:{slot:"content",options:t.$api.defaults.headers.reply_content_types.options},slot:"content",model:{value:t.contentType,callback:function(e){t.contentType=e},expression:"contentType"}})],1),t._v(" "),a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                    Reply Frequency\n                ")]),t._v(" "),a("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[t._v("\n                    Minimum time before a repeated reply\n                ")]),t._v(" "),a("input-select",{attrs:{slot:"content",options:t.$api.defaults.headers.reply_once_select.options},slot:"content",model:{value:t.onceSelect,callback:function(e){t.onceSelect=e},expression:"onceSelect"}})],1)]:t._e(),t._v(" "),a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Vacation Start\n            ")]),t._v(" "),a("input-date",{attrs:{slot:"content",min:t.today},slot:"content",model:{value:t.start,callback:function(e){t.start=e},expression:"start"}},[a("input-select",{style:{minWidth:"12rem"},attrs:{slot:"additions:left",options:t.$api.defaults.start.time.options,novalidate:""},nativeOn:{focusin:function(t){t.stopPropagation()}},slot:"additions:left",model:{value:t.starttime,callback:function(e){t.starttime=e},expression:"starttime"}})],1)],1),t._v(" "),a("ui-form-element",{attrs:{group:"vacation",validators:{validateTime:t.validateTime}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Vacation End\n            ")]),t._v(" "),a("input-date",{ref:"endinput",attrs:{slot:"content",min:t.start},slot:"content",model:{value:t.end,callback:function(e){t.end=e},expression:"end"}},[a("input-select",{style:{minWidth:"12rem"},attrs:{slot:"additions:left",options:t.$api.defaults.end.time.options,novalidate:""},nativeOn:{focusin:function(t){t.stopPropagation()}},slot:"additions:left",model:{value:t.endtime,callback:function(e){t.endtime=e},expression:"endtime"}})],1),t._v(" "),a("translate",{attrs:{slot:"error:validateTime"},slot:"error:validateTime"},[t._v("\n                End time should be larger than start time\n            ")])],1),t._v(" "),a("ui-form-element",{attrs:{group:"vacation",validators:{required:!0}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Vacation Message:\n            ")]),t._v(" "),a("input-textarea",{attrs:{slot:"content"},slot:"content",model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),t._v(" "),a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Current Server Time:\n            ")]),t._v(" "),a("template",{slot:"content"},[t._v("\n                "+t._s(t.$api.defaults.servertime)+"\n            ")])],2)],2),t._v(" "),a("ui-button",{attrs:{slot:"footer:buttons",theme:"primary",disabled:!t.$valid("vacation")},on:{click:t.createVacation},slot:"footer:buttons"},[a("translate",[t._v("Create")])],1)],1)},o=[]}}]);