(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[7628],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/handlers/index.vue?vue&type=script&lang=js&":function(e,t,n){"use strict";n("./node_modules/core-js/modules/es.array.iterator.js"),n("./node_modules/core-js/modules/es.string.iterator.js"),n("./node_modules/core-js/modules/es.weak-map.js"),n("./node_modules/core-js/modules/web.dom-collections.iterator.js"),n("./node_modules/core-js/modules/es.object.define-property.js"),n("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),o=n("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=s(n("./node_modules/@babel/runtime/helpers/slicedToArray.js")),a=s(n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"));n("./node_modules/core-js/modules/es.array.filter.js"),n("./node_modules/core-js/modules/es.object.to-string.js"),n("./node_modules/core-js/modules/es.array.reduce.js"),n("./node_modules/core-js/modules/es.array.map.js"),n("./node_modules/core-js/modules/es.array.includes.js"),n("./node_modules/core-js/modules/es.string.includes.js"),n("./node_modules/core-js/modules/es.regexp.exec.js"),n("./node_modules/core-js/modules/es.string.split.js"),n("./node_modules/core-js/modules/es.array.concat.js"),n("./node_modules/core-js/modules/es.string.trim.js"),n("./node_modules/core-js/modules/es.function.name.js");var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var s={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(s,a,l):s[a]=e[a]}s.default=e,n&&n.set(e,s);return s}(n("./src/js/api/commands/user/handlers.js"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}var i={preload:[l.getHandlers,l.getSystemHandlers],api:[{command:l.getHandlers,bind:"handlers"},{command:l.getSystemHandlers,bind:"systemHandlers"}],commands:l,data:function(){return{select:[],add:{name:"",extension:""},del:{extension:""}}},computed:{checkedExtensions:function(){var e=this;return this.$api.handlers.rows.filter((function(t){return e.select.includes(t.handler)})).map((function(e){return e.extensions.split(" ")})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return!!e}))},handlersList:function(){return[].concat((0,a.default)(this.$api.handlers.rows.map((function(e){return e.handler}))),(0,a.default)(this.$api.systemHandlers.rows.map((function(e){return e.handler}))))},extensionsList:function(){return[].concat((0,a.default)(this.$api.handlers.rows.map((function(e){return e.extensions}))),(0,a.default)(this.$api.systemHandlers.rows.map((function(e){return e.extensions}))))}},watch:{$domain:function(){this.reloadTable()}},methods:{reloadTable:function(){this.$reloadApiTable(),this.$reset()},createHandler:function(){l.createHandler({name:this.add.name.trim(),extension:this.add.extension.trim()}).then(this.reloadTable).then(this.$reset)},deleteHandlers:function(){l.deleteHandlers(this.$get("select")).then(this.reloadTable).then(this.$reset)},deleteExtensions:function(){l.deleteHandlerExtension({select:this.select,extension:this.del.extension}).then(this.reloadTable).then(this.$reset)},validateExtension:function(e){return!e||!this.extensionsList.includes(e)},initDel:function(){var e=(0,r.default)(this.checkedExtensions,1);this.del.extension=e[0]}}};t.Z=i},"./src/js/api/commands/user/handlers.js":function(e,t,n){"use strict";n("./node_modules/core-js/modules/es.object.define-property.js");var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getSystemHandlers=t.getHandlers=t.deleteHandlers=t.deleteHandlerExtension=t.createHandler=void 0,n("./node_modules/core-js/modules/es.object.to-string.js"),n("./node_modules/core-js/modules/es.promise.js");var o=s(n("./src/js/api/command/index.js")),r=o.default.get({id:"HANDLERS",url:"/CMD_HANDLERS",domain:!0,pagination:!0,after:function(e){return e.flow((function(e){return{rows:e}}),e.processTableInfo("rows"),e.mapProps({rows:e.toArray}))}});t.getHandlers=r;var a=r.extend({id:"SYSTEM_HANDLERS",params:{action:"system"}});t.getSystemHandlers=a;var l=o.default.post({url:"/CMD_HANDLERS",params:{action:"add"},domain:!0,schema:{name:o.default.REQUIRED_STRING,extension:o.default.REQUIRED_STRING}});t.createHandler=l;var d=o.default.select({url:"/CMD_HANDLERS",params:{action:"multiple",button:"type"},domain:!0});t.deleteHandlers=d;var i=d.extend({params:{button:"extension"},schema:{extension:o.default.REQUIRED_STRING}});t.deleteHandlerExtension=i},"./src/js/pages/user/handlers/index.vue":function(e,t,n){"use strict";n.r(t),n.d(t,{__esModule:function(){return s.X},default:function(){return i}});var s=n("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/handlers/index.vue?vue&type=script&lang=js&"),o=s.Z,r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=n("./src/js/pages/user/handlers/index.vue?vue&type=custom&index=0&blockType=route"),l=n.n(a),d=(0,r.Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-page",{attrs:{actions:[{label:e.$gettext("Create Handler"),handler:e.$dialog("CREATE_HANDLER_DIALOG").open,icon:"#plus-fill"},{label:e.$gettext("System Apache Handlers"),name:"user/handlers/system",icon:"#settings"}]}},[n("template",{slot:"header:buttons"},[n("ui-button",{attrs:{theme:"primary"},on:{click:function(t){e.$dialog("CREATE_HANDLER_DIALOG").open()}}},[n("translate",[e._v("Create Handler")])],1)],1),e._v(" "),n("app-page-section",[n("ui-api-table",e._b({on:{"action:deleteHandler":function(t){e.$dialog("DELETE_HANDLERS_DIALOG").open()},"action:deleteExtension":function(t){e.$dialog("DELETE_EXTENSION_DIALOG").open()}},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getHandlers,rowID:"handler",columns:{handler:e.$gettext("Handler"),extensions:e.$gettext("Extensions")},actions:{deleteHandler:e.$gettext("Delete Handler"),deleteExtension:e.$gettext("Delete Extension")},equalWidthLayout:!0,verticalLayout:e.$_Client.isPhone},!1))],1),e._v(" "),"standard2021"!==e.$_layout?n("ui-link",{attrs:{slot:"bottom:links",bullet:"",name:"user/handlers/system"},slot:"bottom:links"},[n("translate",[e._v("System Apache Handlers")])],1):e._e(),e._v(" "),n("ui-dialog",{attrs:{id:"CREATE_HANDLER_DIALOG",theme:"safe"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Add New Apache Handler\n        ")]),e._v(" "),n("template",{slot:"content"},[n("ui-form-element",{attrs:{group:"createHandler",validators:{required:!0,maxLength:50}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Name\n                ")]),e._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.add.name,callback:function(t){e.$set(e.add,"name",t)},expression:"add.name"}})],1),e._v(" "),n("ui-form-element",{attrs:{group:"createHandler",validators:{required:!0,notEmpty:function(e){return!e||!!e.trim()},validateExtension:e.validateExtension,maxLength:10}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Extension\n                ")]),e._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.add.extension,callback:function(t){e.$set(e.add,"extension",t)},expression:"add.extension"}}),e._v(" "),n("translate",{attrs:{slot:"error:notEmpty"},slot:"error:notEmpty"},[e._v("\n                    Required field\n                ")]),e._v(" "),n("translate",{attrs:{slot:"error:validateExtension"},slot:"error:validateExtension"},[e._v("\n                    Handler for such extension already exists\n                ")])],1)],1),e._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"createHandler"},on:{click:e.createHandler},slot:"buttons"},[n("translate",[e._v("Create")])],1)],2),e._v(" "),n("ui-dialog-delete-items",{attrs:{id:"DELETE_HANDLERS_DIALOG",subject:e.$ngettext("handler","handlers",e.select.length)},on:{"click:confirm":e.deleteHandlers}}),e._v(" "),n("ui-dialog",{attrs:{id:"DELETE_EXTENSION_DIALOG",theme:"danger"},on:{"dialog:open":e.initDel}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Delete Extension\n        ")]),e._v(" "),n("ui-form-element",{attrs:{slot:"content",group:"deleteExtension",validators:{required:!0}},slot:"content"},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Extension:\n            ")]),e._v(" "),n("input-select",{attrs:{slot:"content",options:e.checkedExtensions},slot:"content",model:{value:e.del.extension,callback:function(t){e.$set(e.del,"extension",t)},expression:"del.extension"}})],1),e._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"danger","validate-group":"deleteExtension"},on:{click:e.deleteExtensions},slot:"buttons"},[n("translate",[e._v("Delete")])],1)],1)],2)}),[],!1,null,null,null);"function"==typeof l()&&l()(d);var i=d.exports},"./src/js/pages/user/handlers/index.vue?vue&type=custom&index=0&blockType=route":function(){}}]);