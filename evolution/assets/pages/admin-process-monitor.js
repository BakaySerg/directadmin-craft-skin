(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[5706],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=script&lang=js&":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.array.iterator.js"),t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.string.iterator.js"),t("./node_modules/core-js/modules/es.weak-map.js"),t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=t("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(s,"X",{value:!0}),s.Z=void 0,t("./node_modules/core-js/modules/es.parse-int.js");var l=o(t("./node_modules/@babel/runtime/regenerator/index.js")),a=o(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),r=function(e,s){if(!s&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=i(s);if(t&&t.has(e))return t.get(e);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var r=l?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=e[a]}o.default=e,t&&t.set(e,o);return o}(t("./src/js/api/commands/admin/process-monitor.js"));function i(e){if("function"!=typeof WeakMap)return null;var s=new WeakMap,t=new WeakMap;return(i=function(e){return e?t:s})(e)}var d,u,c={preload:[r.getProcesses,r.getDefaults],api:[{command:r.getProcesses,bind:{"response.info":"info",isLoading:"loading"}},{command:r.getDefaults,bind:"defaults"}],commands:r,data:function(){return{reloadInfo:{enabled:!1,delay:"15",left:0,timer:null},rootpass:""}},methods:{reload:function(){return this.$refs.table.reloadTable()},loadInfoManually:(u=(0,a.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearTimer(),e.next=3,this.reload();case 3:this.reloadInfo.enabled&&this.startReload();case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),toggleReload:function(){this.reloadInfo.enabled=!this.reloadInfo.enabled,this.clearTimer(),this.reloadInfo.enabled&&this.startReload()},clearTimer:function(){this.reloadInfo.left=0,this.reloadInfo.timer&&clearTimeout(this.reloadInfo.timer)},startReload:(d=(0,a.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reloadInfo.left=this.reloadInfo.left?this.reloadInfo.left-1:parseInt(this.reloadInfo.delay,10),this.reloadInfo.left){e.next=5;break}return e.next=4,this.reload();case 4:this.reloadInfo.left=parseInt(this.reloadInfo.delay,10);case 5:this.reloadInfo.timer=setTimeout(this.startReload,1e3);case 6:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),authRootUser:function(){r.authenticate({rootpass:this.rootpass}).then(r.getDefaults)},removeAuth:function(){r.removeAuth().then(r.getDefaults)},sendSignal:function(e,s){r.sendSignal({select:[e],value:s}).then(this.reload)}}};s.Z=c},"./src/js/api/commands/admin/process-monitor.js":function(e,s,t){"use strict";t("./node_modules/core-js/modules/es.object.define-property.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.sendSignal=s.removeAuth=s.getProcesses=s.getDefaults=s.authenticate=void 0;var n=o(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),l=o(t("./node_modules/@babel/runtime/helpers/toConsumableArray.js"));t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.promise.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.string.starts-with.js"),t("./node_modules/core-js/modules/es.array.slice.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.string.split.js"),t("./node_modules/core-js/modules/es.string.trim.js"),t("./node_modules/core-js/modules/es.array.find.js");var a=o(t("./src/js/api/command/index.js")),r="/CMD_PROCESS_MONITOR",i=a.default.get({id:"PROCESS_MONITOR",url:r,params:{sor1:9,sort1dir:-1},pagination:!0,after:function(e){return e.flow(e.project({rows:"processes",info:"info"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("info",e.flow(e.convert.toLines,e.filter(e.notEmpty),(function(e){return e[0].startsWith("top")?{type:"linux",top:e[0].slice(6),tasks:e[1].slice(7),cpus:e[2].slice(9),mem:e[3].slice(11),swap:e[4].slice(11)}:{type:"bsd",pid:(e=[].concat((0,l.default)(e[0].split(";")),(0,l.default)(e.slice(1))).map((function(e){return e.trim()})).filter(Boolean))[0].slice(10),load:e[1].slice(16),processes:e[2].split(":").pop().trim(),mem:e[3].slice(5),swap:e[4].slice(6)}}))))}});s.getProcesses=i;var d=a.default.get({id:"PROCESS_MONITOR_DEFAULTS",url:r,after:function(e){return e.flow(e.project({requireAuth:"require_root_auth",signals:"value",defaultSignal:"value",columns:"processes.info.columns"}),e.mapProps({requireAuth:e.isEqual("yes"),signals:e.transformObject((function(e){var s=e.value,t=e.text;return(0,n.default)({},s,t)})),defaultSignal:e.flow(e.find(e.getProp("selected")),e.getProp("value"))}))}});s.getDefaults=d;var u=a.default.post({url:r,params:{authenticate:!0},schema:{rootpass:a.default.REQUIRED_STRING}});s.authenticate=u;var c=a.default.post({url:r,params:{authenticate:!1}});s.removeAuth=c;var p=a.default.post({url:r,params:{signal:!0},schema:{select:a.default.ROWS,value:a.default.REQUIRED_STRING}});s.sendSignal=p},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=style&index=0&lang=scss&":function(){},"./src/js/pages/admin/process-monitor.vue":function(e,s,t){"use strict";t.r(s),t.d(s,{__esModule:function(){return o.X},default:function(){return d}});var o=t("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=script&lang=js&"),n=o.Z,l=(t("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=style&index=0&lang=scss&"),t("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),a=t("./src/js/pages/admin/process-monitor.vue?vue&type=custom&index=0&blockType=route"),r=t.n(a),i=(0,l.Z)(n,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("app-page",{attrs:{id:"process-monitor",actions:[{handler:e.removeAuth,label:e.$gettext("Remove Authentication"),icon:"#settings",visible:!1===e.$api.defaults.requireAuth},{handler:e.$dialog("AUTHENTICATE_DIALOG").open,label:e.$gettext("Authenticate to send signals"),icon:"#settings",visible:!0===e.$api.defaults.requireAuth}]}},[e.$api.defaults.requireAuth?t("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(s){e.$dialog("AUTHENTICATE_DIALOG").open()}},slot:"header:buttons"},[t("translate",[e._v("Authenticate to send signals")])],1):t("ui-button",{attrs:{slot:"header:buttons",theme:"danger"},on:{click:e.removeAuth},slot:"header:buttons"},[t("translate",[e._v("Remove Authentication")])],1),e._v(" "),t("app-page-section",[t("div",{staticClass:"top-controls"},[t("ui-input-group",{attrs:{grow:e.$_Client.isPhone}},[t("ui-button",{attrs:{slot:"additions:left"},on:{click:e.toggleReload},slot:"additions:left"},[t("input-checkbox",{model:{value:e.reloadInfo.enabled,callback:function(s){e.$set(e.reloadInfo,"enabled",s)},expression:"reloadInfo.enabled"}},[t("translate",[e._v("Reload every")])],1)],1),e._v(" "),t("input-select",{attrs:{slot:"input",options:["1","2","3","4","5","10","15","30","60"]},on:{change:function(s){e.reloadInfo.left=parseInt(s)}},slot:"input",model:{value:e.reloadInfo.delay,callback:function(s){e.$set(e.reloadInfo,"delay",s)},expression:"reloadInfo.delay"}}),e._v(" "),t("ui-button",{attrs:{slot:"additions:right",disabled:""},slot:"additions:right"},[t("translate",[e._v("seconds")])],1)],1),e._v(" "),t("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:e.$_Client.isPhone?"column":"row",cross:e.$_Client.isPhone?"stretch":"center"},expression:"{\n                    dir: $_Client.isPhone\n                        ? 'column'\n                        : 'row',\n                    cross: $_Client.isPhone\n                        ? 'stretch'\n                        : 'center'\n                }"}]},[e.reloadInfo.enabled?t("span",{staticClass:"reload-counter"},[e.reloadInfo.left?t("translate",{key:"reloadDelayMessage",attrs:{"translate-params":{delay:e.reloadInfo.left}}},[e._v("\n                        reload in %{delay} seconds\n                    ")]):t("translate",{key:"reloadMessage"},[e._v("\n                        reloading...\n                    ")])],1):e._e(),e._v(" "),t("ui-button",{staticClass:"reloadButton",attrs:{size:e.$_Client.isPhone?"normal":"small",theme:"light",disabled:e.$api.loading},on:{click:e.loadInfoManually}},[t("translate",[e._v("Now")])],1)],1)],1),e._v(" "),"linux"===e.$api.info.type?t("div",{staticClass:"topInfo"},[t("ul",{staticClass:"label"},[t("translate",{attrs:{tag:"li"}},[e._v("\n                    Top:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    Tasks:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    CPU(s):\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    KiB Mem:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    KiB Swap:\n                ")])],1),e._v(" "),t("ul",{staticClass:"value"},[t("li",{domProps:{textContent:e._s(e.$api.info.top)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.tasks)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.cpus)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.mem)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.swap)}})])]):t("div",{staticClass:"topInfo"},[t("ul",{staticClass:"label"},[t("translate",{attrs:{tag:"li"}},[e._v("\n                    Last PID:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    Load Average:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    Processes:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    Mem:\n                ")]),e._v(" "),t("translate",{attrs:{tag:"li"}},[e._v("\n                    Swap:\n                ")])],1),e._v(" "),t("ul",{staticClass:"value"},[t("li",{domProps:{textContent:e._s(e.$api.info.pid)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.load)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.processes)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.mem)}}),e._v(" "),t("li",{domProps:{textContent:e._s(e.$api.info.swap)}})])]),e._v(" "),t("ui-api-table",{directives:[{name:"margin",rawName:"v-margin",value:[3,,,],expression:"[3,,,]"}],key:"process-table-"+(e.$api.defaults.requireAuth?"authenticated":"non-authenticated"),ref:"table",attrs:{command:e.$commands.getProcesses,columns:{signal:{hide:e.$api.defaults.requireAuth,label:" "},PID:{label:"PID",editable:!1},USER:"USER",PR:"PR",NI:"NI",VIRT:"VIRT",RES:"RES",SHR:"SHR",S:"S","%CPU":"%CPU","%MEM":"%MEM","TIME+":"TIME+",COMMAND:{label:"COMMAND",grow:!0}},"initial-sort":{key:"%CPU",order:"ASC"},"vertical-layout":e.$_Client.isPhone,"disable-select":""},scopedSlots:e._u([{key:"col:signal",fn:function(s){var o=s.PID;return t("ui-actions",{attrs:{position:"right"}},e._l(e.$api.defaults.signals,(function(s,n){return t("ui-link",{key:s,on:{click:function(s){return e.sendSignal(o,n)}}},[e._v("\n                    "+e._s(s)+"\n                ")])})),1)}}])})],1),e._v(" "),e.$api.defaults.requireAuth?t("ui-dialog",{attrs:{id:"AUTHENTICATE_DIALOG"}},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n            Authenticate to send signals\n        ")]),e._v(" "),t("ui-form-element",{attrs:{slot:"content",vertical:"",group:"authenticateRoot",validators:{required:!0}},slot:"content"},[t("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Root Password\n            ")]),e._v(" "),t("input-password",{attrs:{slot:"content"},slot:"content",model:{value:e.rootpass,callback:function(s){e.rootpass=s},expression:"rootpass"}})],1),e._v(" "),t("ui-button",{attrs:{slot:"buttons","validate-group":"authenticateRoot",theme:"safe"},on:{click:e.authRootUser},slot:"buttons"},[t("translate",[e._v("Authenticate")])],1)],1):e._e()],1)}),[],!1,null,null,null);"function"==typeof r()&&r()(i);var d=i.exports},"./src/js/pages/admin/process-monitor.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=style&index=0&lang=scss&":function(e,s,t){var o=t("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/process-monitor.vue?vue&type=style&index=0&lang=scss&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,t("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("866e2370",o,!0,{})}}]);