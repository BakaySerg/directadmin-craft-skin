(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{1835:function(t,e,r){"use strict";r.r(e);var n=r(4033),a=r(2658);for(var o in a)["default"].indexOf(o)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(o);r(3681);var i=r(0),u=r(3683),s=r.n(u),c=Object(i.a)(a.default,n.a,n.b,!1,null,null,null);"function"==typeof s.a&&s()(c),e.default=c.exports},1886:function(t,e,r){"use strict";r.r(e),r.d(e,"preload",(function(){return w})),r.d(e,"GET",(function(){return k})),r.d(e,"POST",(function(){return E})),r.d(e,"PUT",(function(){return T})),r.d(e,"PATCH",(function(){return S})),r.d(e,"DELETE",(function(){return D})),r.d(e,"$gettext",(function(){return x}));var n=r(30),a=r.n(n),o=r(28),i=r(9),u=r(1893),s=r(1894),c=r(13),l=new a.a,p={401:"UNAUTHORIZED",404:"ENDPOINT_NOT_FOUND",405:"METHOD_NOT_ALLOWED"},d={BAD_REQUEST:l.$gettext("Bad Request: %{ message }"),UNAUTHORIZED:l.$gettext("Unauthorized"),ACCESS_DENIED:l.$gettext("Access Denied"),INTERNAL_ERROR:l.$gettext("Server Error: %{ message }"),METHOD_NOT_ALLOWED:l.$gettext("Method Not Allowed"),ENDPOINT_NOT_FOUND:l.$gettext("Endpoint Not Found")},f=function(t,e,r){void 0===r&&(r={});var n=l.$gettextInterpolate(e,r||{});return{status:t,message:n,type:r.type,data:i.omit(["type"],r),notify:function(){return o.Store.dispatch("notifications/NOTIFY",{theme:"danger",title:l.$gettext("Error"),content:n,route:o.Store.state.app.route.path||"/",time:new Date})}}},h=function(t,e,r,n){return new(r||(r=Promise))((function(a,o){function i(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,u)}s((n=n.apply(t,e||[])).next())}))},g=function(t,e){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},m={data:{},statusCodes:{},errorMessages:{}},v=function(t,e,r){void 0===r&&(r={});var n=function(t,e){return(t+"_"+e.slice(5).replace(/\//,"_").replace(/\:/,"")).toUpperCase()}(t,e);r=i.mergeDeepRight(m,r);var a=Object(s.registerEndpoint)(n,r.data);return{endpoint:a,request:function(i){return h(void 0,void 0,void 0,(function(){var s,h,m;return g(this,(function(g){switch(g.label){case 0:return o.Store&&o.Store.state.commands.blockingRequest?[4,o.Store.state.commands.blockingRequest]:[3,2];case 1:g.sent(),g.label=2;case 2:a.params=i||{},a.state={isLoading:!0},g.label=3;case 3:return g.trys.push([3,5,,6]),[4,Object(u.request)({endpointID:n,url:e,method:t},a.params)];case 4:return s=g.sent(),"get"===t&&(a.data=s.data),a.state={isOk:!0,isDone:!0,isLoading:!1,error:null},[2,{state:"success",data:s.data,error:null}];case 5:return h=g.sent(),401===(m=function(t,e,r){var n;void 0===e&&(e={}),void 0===r&&(r={});var a=Object.assign(e,p),o=Object.assign(r,d);if(t.response){if(t.response.data&&t.response.data.type)if(void 0!==o[(i=t.response.data).type])return f(t.response.status,o[i.type],i);if(a[t.response.status]){var i={type:a[t.response.status]};t.response.data=i;var u=a[t.response.status];if(u&&o[u])return f(t.response.status,o[u],{type:u})}}else if(t.request)return c.emitter.emit("request:networkerror"),f(-1,l.$gettext("Network Error: Server is unreachable"),{type:"NETWORK_UNREACHABLE"});return f((null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.status)||-1,l.$gettext("Unknown Error"),{type:"UNKNOWN_ERROR"})}(h,r.statusCodes,r.errorMessages)).status&&window.location.reload(),a.state={isOk:!1,isDone:!0,isLoading:!1,error:m},[2,{state:"error",error:m,data:null}];case 6:return[2]}}))}))}}},b=function(t,e,r){void 0===r&&(r={});var n=v(t,e,r),a=n.endpoint,o=n.request;return Object.freeze({get params(){return a.params},get state(){return a.state},request:o})},y=function(t,e,r,n){return new(r||(r=Promise))((function(a,o){function i(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,u)}s((n=n.apply(t,e||[])).next())}))},O=function(t,e){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},_=function(t,e){return t.notify(),e(!1)},w=function(t,e){return void 0===e&&(e=_),function(r,n,a){return y(void 0,void 0,void 0,(function(){var o,i,u;return O(this,(function(s){switch(s.label){case 0:return[4,Promise.all(t.map((function(t){return t(r,n)})))];case 1:return o=s.sent(),void 0!==(i=o.find((function(t){return"error"===t.state})))?(u=i.error,[2,e(u,a)]):(a(),[2])}}))}))}},k=function(t,e){return function(t,e,r){void 0===r&&(r={});var n=v(t,e,r),a=n.endpoint,o=n.request;return Object.freeze({get data(){return a.data},set data(t){a.data=t},get params(){return a.params},get state(){return a.state},request:o,bindData:function(t){return function(){return t?t(a.data):a.data}}})}("get",t,e)},E=function(t,e){return b("post",t,e)},T=function(t,e){return b("put",t,e)},S=function(t,e){return b("patch",t,e)},D=function(t,e){return b("delete",t,e)},x=(new a.a).$gettext},1893:function(t,e,r){"use strict";r(16),r(14),r(23),r(25),r(18),r(6);var n=r(1),a=r(19);Object.defineProperty(e,"__esModule",{value:!0}),e.request=void 0;var o=n(r(36)),i=n(r(37));r(12),r(15),r(21),r(40),r(84);var u=n(r(505)),s=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var r=p(e);if(r&&r.has(t))return r.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var u=o?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=t[i]}n.default=t,r&&r.set(t,n);return n}(r(9)),c=r(31),l=r(28);function p(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(p=function(t){return t?r:e})(t)}var d=u.default.create({baseURL:"/api"});d.interceptors.request.use(s.mergeDeepRight({timeout:0,headers:{Accept:"application/json","Content-Type":"application/json",Pragma:"no-cache"}}));var f,h=function(t,e){if(t.includes(":")){var r=[];return{url:t.replace(/:[a-z]*/g,(function(t){if(":domain"===t&&!e.domain)return l.Store.state.app.domain;t=t.slice(1);var n=e[t];if(void 0===n)throw new Error("EndpointParamError: ".concat(t," is not defined"));return r.push(t),n})),urlParams:r}}return{url:t,urlParams:[]}},g=(f=(0,i.default)(o.default.mark((function t(e,r){var n,a,i,u,l,p,f;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e.url){t.next=2;break}throw new Error("Unsupported URL format");case 2:return n=h(e.url,r),a=n.url,i=n.urlParams,u={endpointID:e.endpointID,url:a,method:e.method},l=s.omit(i,r),!1===s.isEmpty(l)&&(p="get"===e.method?"params":"data",u[p]=l),t.prev=6,t.next=9,d.request(u);case 9:return t.abrupt("return",t.sent);case 12:throw t.prev=12,t.t0=t.catch(6),c.ENV.DEV&&(console.group(),console.dir(u),f=u.params||u.data,console.table({"Endpoint ID":u.endpointID,Url:u.url,Method:u.method,"Request Data":JSON.stringify(f),"Response Status Code":t.t0.response.status,"Response Data":JSON.stringify(t.t0.response.data)}),console.groupEnd()),t.t0;case 16:case"end":return t.stop()}}),t,null,[[6,12]])}))),function(t,e){return f.apply(this,arguments)});e.request=g},1894:function(t,e,r){"use strict";r(16),r(14),r(23),r(25),r(18),r(6);var n=r(19);Object.defineProperty(e,"__esModule",{value:!0}),e.registerEndpoint=void 0,r(49);var a=r(28),o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var r=i(e);if(r&&r.has(t))return r.get(t);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var s=o?Object.getOwnPropertyDescriptor(t,u):null;s&&(s.get||s.set)?Object.defineProperty(a,u,s):a[u]=t[u]}a.default=t,r&&r.set(t,a);return a}(r(9));function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(i=function(t){return t?r:e})(t)}e.registerEndpoint=function(t,e){return a.Store.commit("endpoints/REGISTER_ENDPOINT",{id:t,data:e}),{get data(){return o.clone(a.Store.state.endpoints[t].data)},set data(e){a.Store.commit("endpoints/SET_DATA",{id:t,data:e})},get state(){return a.Store.state.endpoints[t].state},set state(e){a.Store.commit("endpoints/SET_STATE",{id:t,state:Object.assign({},{isLoading:!1,isOk:!1,isError:!1,error:null},e)})},get params(){return o.clone(a.Store.state.endpoints[t].params)},set params(e){a.Store.commit("endpoints/SET_PARAMS",{id:t,params:e})}}}},1943:function(t,e,r){"use strict";r.r(e),r.d(e,"postDeploy",(function(){return a})),r.d(e,"getGit",(function(){return o})),r.d(e,"postInit",(function(){return i})),r.d(e,"postFetch",(function(){return u})),r.d(e,"postWebhook",(function(){return s})),r.d(e,"deleteRepo",(function(){return c})),r.d(e,"getInfo",(function(){return l})),r.d(e,"getLogs",(function(){return p})),r.d(e,"putModify",(function(){return d})),r.d(e,"getCommit",(function(){return f})),r.d(e,"getDefaultBranch",(function(){return h}));var n=r(1886),a=Object(n.POST)("/git/uuid/:uuid/deploy",{statusCodes:{409:"GIT_DEPLOY_BRANCH_NOT_SET",410:"GIT_DEPLOY_DIR_NOT_SET"},errorMessages:{GIT_DEPLOY_BRANCH_NOT_SET:Object(n.$gettext)("Git deploy branch is not set"),GIT_DEPLOY_DIR_NOT_SET:Object(n.$gettext)("Git deploy directory is not set")}}),o=Object(n.GET)("/git/domain/:domain"),i=Object(n.POST)("/git/domain/:domain",{statusCodes:{409:"GIT_DIRECTORY_EXISTS"},errorMessages:{GIT_DIRECTORY_EXISTS:Object(n.$gettext)("Git directory exists %{ directory }")}}),u=Object(n.POST)("/git/uuid/:uuid/fetch"),s=Object(n.POST)("/git/uuid/:uuid/webhook"),c=Object(n.DELETE)("/git/uuid/:uuid"),l=Object(n.GET)("/git/uuid/:uuid"),p=Object(n.GET)("/git/uuid/:uuid/branch/:branch"),d=Object(n.PUT)("/git/uuid/:uuid"),f=Object(n.GET)("/git/uuid/:uuid/commit/:commit"),h=function(t){return 0===t.length?"":["main","master"].find((function(e){return t.includes(e)}))||t[0]}},2658:function(t,e,r){"use strict";r.r(e);var n=r(2659),a=r.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(o);e.default=a.a},2659:function(t,e,r){"use strict";var n=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r(27),r(84),r(34),r(7),r(14),r(65),r(85);var a,o,i,u,s,c=n(r(36)),l=n(r(37)),p=r(28),d=r(1943),f={beforeRouteEnter:(s=(0,l.default)(c.default.mark((function t(e,r,n){var a,o,i,u;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=(0,p.State)("app.domain"),o=e.params.uuid,i=e.params.branch,u=e.params.skip,t.next=6,d.getLogs.request({uuid:o,branch:i,skip:u,domain:a});case 6:return t.next=8,d.getInfo.request({uuid:o});case 8:n(!0);case 9:case"end":return t.stop()}}),t)}))),function(t,e,r){return s.apply(this,arguments)}),props:{uuid:{type:String,required:!0},branch:{type:String,required:!0},skip:{type:String,required:!0}},data:function(){return{currentBranch:this.branch,query:{from:""}}},computed:{gitInfo:d.getInfo.bindData(),gitLogs:d.getLogs.bindData(),dateGroups:function(){var t=this.gitLogs.commits.reduce((function(t,e){var r=new Date(e.time),n=("0"+(r.getMonth()+1)).slice(-2),a=("0"+r.getDate()).slice(-2),o=r.getFullYear()+"-"+n+"-"+a;return t[o]||(t[o]=[]),t[o].push(e),t}),{});return Object.keys(t).map((function(e){return{date:e,commits:t[e]}}))}},watch:{$route:function(t,e){e.params.skip!=t.params.skip&&e.params.branch==t.params.branch&&(this.skip=t.params.skip,this.request(t.params.uuid,t.params.branch,t.params.skip)),e.params.branch!=t.params.branch&&this.request(t.params.uuid,t.params.branch,t.params.skip)},uuid:function(){this.request()}},methods:{getBack:(u=(0,l.default)(c.default.mark((function t(){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push({name:"user/git-version/info",params:{uuid:this.uuid}});case 1:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)}),requestOlder:(i=(0,l.default)(c.default.mark((function t(){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:(parseInt(this.skip)+10).toString()}});case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),requestNewer:(o=(0,l.default)(c.default.mark((function t(){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:parseInt(this.skip)-10>=0?(parseInt(this.skip)-10).toString():"0"}});case 1:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),request:(a=(0,l.default)(c.default.mark((function t(e,r,n){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.getLogs.request({uuid:e,branch:r,skip:n.toString()});case 2:this.uuid=e,this.branch=r,this.currentBranch=r,this.skip=n;case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return a.apply(this,arguments)}),changeBranch:function(){this.$router.push({name:"user/git-version/logs",params:{uuid:this.uuid,branch:this.currentBranch,skip:"0"}})},showLogDiff:function(t){this.$router.push({name:"user/git-version/diff",params:{commit:t,uuid:this.gitInfo.uuid}})}}};e.default=f},3134:function(t,e,r){var n=r(3682);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,r(4).default)("80869a5c",n,!0,{})},3681:function(t,e,r){"use strict";r(3134)},3682:function(t,e,r){},3683:function(t,e){},4033:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return a}));var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("app-page",{attrs:{id:"git-logs-page",actions:[{label:t.$gettext("Back to Repository"),visible:!0,icon:"#anchor",handler:function(){return t.getBack()}}]}},[r("template",{slot:"page:title"},[r("translate",[t._v("Repository")]),t._v("\n        : "+t._s(t.gitInfo.name)+"\n    ")],1),t._v(" "),r("app-page-section",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.request.apply(null,arguments)}}},[r("ui-form-element",[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Branch\n            ")]),t._v(" "),r("input-select",{attrs:{slot:"content",options:t.gitInfo.branches},on:{change:t.changeBranch},slot:"content",model:{value:t.currentBranch,callback:function(e){t.currentBranch=e},expression:"currentBranch"}})],1)],1),t._v(" "),t._l(t.dateGroups,(function(e){return r("div",{key:e.date},[r("app-page-section",{attrs:{id:"log-table"}},[r("ui-r-table",t._b({attrs:{"hide-before-controls":"","disable-pagination":""},scopedSlots:t._u([{key:"col:time",fn:function(e){var r=e.time;return[t._v("\n                    "+t._s(("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2))+"\n                ")]}},{key:"col:message",fn:function(e){var n=e.item;return r("ui-link",{attrs:{name:"user/git-version/diff",params:{commit:n.hash,uuid:t.gitInfo.uuid,branch:t.currentBranch}}},[r("div",{staticStyle:{"font-weight":"bold"}},[t._v("\n                        "+t._s(n.message.split("\n")[0].substr(0,70))+"\n                        "+t._s(n.message.split("\n")[0].length>70?"...":"")+"\n                    ")]),t._v("\n                    "+t._s(n.author.name)+"\n                ")])}},{key:"row:actions",fn:function(e){var n=e.item;return r("ui-link",{staticStyle:{"font-family":"monospace"},attrs:{title:t.$gettext("Show Details")},on:{click:function(e){return t.showLogDiff(n.hash)}}},[t._v("\n                    "+t._s(n.hash.substr(0,7))+"\n                ")])}}],null,!0)},"ui-r-table",{rows:e.commits,columns:[{id:"message",label:"Commits on "+e.date}],verticalLayout:t.$_Client.isPhone,isCheckable:!1,isSortable:!1},!1))],1)],1)})),t._v(" "),r("app-page-section",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.request.apply(null,arguments)}}},[r("ui-button",{directives:[{name:"show",rawName:"v-show",value:t.gitLogs.more_newer,expression:"gitLogs.more_newer"}],attrs:{slot:"footer:buttons",theme:"primary"},on:{click:function(e){return e.preventDefault(),t.requestNewer()}},slot:"footer:buttons"},[r("translate",[t._v("Newer")])],1),t._v(" "),r("ui-button",{attrs:{slot:"footer:buttons",disabled:!t.gitLogs.more_older,theme:"primary"},on:{click:function(e){return e.preventDefault(),t.requestOlder()}},slot:"footer:buttons"},[r("translate",[t._v("Older")])],1)],1)],2)},a=[]}}]);