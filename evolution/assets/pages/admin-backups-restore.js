(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[4485],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=o(s("./node_modules/@babel/runtime/regenerator/index.js")),l=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),n=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js"));s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.object.assign.js");var a=s("./src/js/api/commands/admin/backups/index.js"),i=s("./src/js/vue/mixins.js");function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){(0,n.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var c,p={preload:[a.getRestoreOptions,a.getEncryptionStatus],mixins:[(0,i.$bindTab)({defaultTab:"where",param:"step"})],data:function(){return{where:"local",whereData:{local_path:"",ftp_ip:"",ftp_username:"",ftp_password:"",ftp_path:"",ftp_port:"",ftp_secure:""},ip_choice:"select",ipSelectData:{ip:"",create_user_home_override:""},checkedRows:[],decrypt:!1,password:"",selectedFiles:[],reseller_override:""}},api:[{command:a.getRestoreOptions,bind:"options"},{command:a.getRestoreFiles,bind:{response:"files",isDone:"filesLoaded"}},{command:a.getEncryptionStatus,bind:"encryption"}],computed:{validWhere:function(){return"local"===this.where&&!!this.whereData.local_path||"ftp"===this.where&&!!this.whereData.ftp_ip&&!!this.whereData.ftp_username&&!!this.whereData.ftp_password&&!!this.whereData.ftp_path&&!!this.whereData.ftp_port},validFiles:function(){if(this.decrypt&&!this.password)return!1;if(this.selectedFiles.length){var e=this.files.issues,t=void 0===e?{}:e;return this.selectedFiles.every((function(e){return!t[e]}))}return!1},options:function(){return this.$api.options},files:function(){return this.$api.filesLoaded?this.$api.files:this.$api.options.filesData},encryptionEnabled:function(){return this.$api.encryption.enabled},issues:function(){return this.files.list.filter((function(e){return e.issues}))},checkedFiles:function(){return this.checkedRows.map((function(e){return e.file}))},requestData:function(){return d(d(d({where:this.where},this.whereData),{},{ip_choice:this.ip_choice},this.ipSelectData),{},{select:this.selectedFiles,encryption_password:this.password,ftp_secure:this.whereData.ftp_secure?"ftps":"no",reseller_override:this.reseller_override||null})},filesList:function(){return this.files.list.map((function(e){return e.file}))},disabledFiles:function(){return this.files.list.filter((function(e){return e.disabled})).map((function(e){return e.file}))},resellerOverrideOptions:function(){return Object.keys(this.$api.options.data_list||{})}},watch:{step:function(e,t){"where"===t&&this.reloadFiles()}},created:function(){this.where=this.options.where,Object.assign(this.whereData,this.options.whereData),this.ipSelectData.ip=this.options.ips.value,this.$api.options.filesData.home_override&&(this.ipSelectData.create_user_home_override=this.$api.options.filesData.home_override.value)},methods:{reloadFiles:function(){(0,a.getRestoreFiles)(d({where:this.where},this.whereData))},restoreBackup:(c=(0,l.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.restoreBackup)(this.requestData);case 2:e.sent&&this.$router.push({name:"admin/backups"});case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})}};t.Z=p},"./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=style&index=0&id=06f82924&lang=scss&scoped=true&":function(){},"./src/js/pages/admin/backups/restore.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return u}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=script&lang=js&"),r=o.Z,l=(s("./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=style&index=0&id=06f82924&lang=scss&scoped=true&"),s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),n=s("./src/js/pages/admin/backups/restore.vue?vue&type=custom&index=0&blockType=route"),a=s.n(n),i=(0,l.Z)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{id:"restore-admin-backup"}},[s("app-page-section",[s("ui-steps",{attrs:{steps:[{id:"where",label:e.$gettext("Step 1: From Where"),desc:e.$gettext("Select directory for restore."),completed:e.validWhere},{id:"ip_select",label:e.$gettext("Step 2: Select IP"),desc:e.$gettext("Select IP address used for restore.")},{id:"files",label:e.$gettext("Step 3: Select File(s)"),desc:e.$gettext("Select backup files to restore."),completed:e.validFiles}],current:e.step},on:{"update:current":function(t){e.step=t}}},["where"===e.step?s("ui-button",{key:"reloadFiles",attrs:{slot:"buttons",theme:"primary"},on:{click:e.reloadFiles},slot:"buttons"},[s("translate",[e._v("Reload Files")])],1):e._e(),e._v(" "),"files"===e.step?s("ui-button",{key:"restoreBackup",attrs:{slot:"buttons",theme:"safe",disabled:!(e.validFiles&&e.validWhere)},on:{click:e.restoreBackup},slot:"buttons"},[s("translate",[e._v("Restore")])],1):e._e(),e._v(" "),s("div",{key:"where",attrs:{slot:"step:where"},slot:"step:where"},[s("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Local\n                    ")]),e._v(" "),s("input-radio",{attrs:{slot:"content",value:"local"},slot:"content",model:{value:e.where,callback:function(t){e.where=t},expression:"where"}})],1),e._v(" "),s("transition",{attrs:{name:"fade"}},["local"===e.where?s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            Path\n                        ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.local_path,callback:function(t){e.$set(e.whereData,"local_path",t)},expression:"whereData.local_path"}})],1):e._e()],1),e._v(" "),s("ui-form-element",{attrs:{underline:"ftp"===e.where,"vertical-on-phone":!1,reverse:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        FTP\n                    ")]),e._v(" "),s("input-radio",{attrs:{slot:"content",value:"ftp"},slot:"content",model:{value:e.where,callback:function(t){e.where=t},expression:"where"}})],1),e._v(" "),s("transition",{attrs:{name:"fade"}},["ftp"===e.where?s("ui-form-element",{attrs:{underline:!1}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            FTP Settings\n                        ")]),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    IP\n                                ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.ftp_ip,callback:function(t){e.$set(e.whereData,"ftp_ip",t)},expression:"whereData.ftp_ip"}})],1),e._v(" "),s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    Username\n                                ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.ftp_username,callback:function(t){e.$set(e.whereData,"ftp_username",t)},expression:"whereData.ftp_username"}})],1),e._v(" "),s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    Password\n                                ")]),e._v(" "),s("input-password",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.ftp_password,callback:function(t){e.$set(e.whereData,"ftp_password",t)},expression:"whereData.ftp_password"}})],1),e._v(" "),s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    Remote Path\n                                ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.ftp_path,callback:function(t){e.$set(e.whereData,"ftp_path",t)},expression:"whereData.ftp_path"}})],1),e._v(" "),s("ui-form-element",{attrs:{group:"restoreBackupWhere",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    Port\n                                ")]),e._v(" "),s("input-text",{attrs:{slot:"content",number:""},slot:"content",model:{value:e.whereData.ftp_port,callback:function(t){e.$set(e.whereData,"ftp_port",t)},expression:"whereData.ftp_port"}})],1),e._v(" "),s("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                    Secure FTP\n                                ")]),e._v(" "),s("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.whereData.ftp_secure,callback:function(t){e.$set(e.whereData,"ftp_secure",t)},expression:"whereData.ftp_secure"}})],1)],1)],1):e._e()],1)],1),e._v(" "),s("div",{key:"ip_select",attrs:{slot:"step:ip_select"},slot:"step:ip_select"},[s("ui-form-element",{attrs:{underline:"select"===e.ip_choice}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Use the IP\n                    ")]),e._v(" "),s("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:e.$_Client.isPhone?"column":"row"},expression:"{\n                            dir: $_Client.isPhone\n                                ? 'column'\n                                : 'row'\n                        }"},{name:"gutter",rawName:"v-gutter",value:1,expression:"1"}],attrs:{slot:"content"},slot:"content"},[s("input-radio",{attrs:{slot:"content",value:"file"},slot:"content",model:{value:e.ip_choice,callback:function(t){e.ip_choice=t},expression:"ip_choice"}},[s("translate",[e._v("stored in the backup")])],1),e._v(" "),s("input-radio",{attrs:{slot:"content",value:"select"},slot:"content",model:{value:e.ip_choice,callback:function(t){e.ip_choice=t},expression:"ip_choice"}},[s("translate",[e._v("from the list")])],1)],1)],1),e._v(" "),s("transition",{attrs:{name:"fade"}},["select"===e.ip_choice?s("ui-form-element",{attrs:{underline:!1}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            IP\n                        ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.options.ips.options},slot:"content",model:{value:e.ipSelectData.ip,callback:function(t){e.$set(e.ipSelectData,"ip",t)},expression:"ipSelectData.ip"}})],1):e._e()],1),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.$api.options.filesData.home_override?s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            Restore to partition\n                        ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.$api.options.filesData.home_override.options},slot:"content",model:{value:e.ipSelectData.create_user_home_override,callback:function(t){e.$set(e.ipSelectData,"create_user_home_override",t)},expression:"ipSelectData.create_user_home_override"}})],1):e._e()],1),e._v(" "),s("ul",[s("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n                        Note that you must set the IP to be shared if you want to add multiple users to it. If you select a non-shared IP, you can only restore 1 user to it.\n                    ")]),e._v(" "),s("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n                        If the user already exists, this setting will have no effect.\n                    ")]),e._v(" "),s("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n                        When restoring a Reseller or Admin, if you select an IP from the list, that Reseller will only receive the single IP.\n                        You would need to add extra IPs to that accounts IP list after he's created.\n                    ")]),e._v(" "),s("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n                        If using the IPs from within the backup, any IPs that don't exist on this system will not be included. If there no IPs to be used, a Reseller or Admin will be restored to the server IP.\n                    ")])])],1),e._v(" "),s("div",{key:"files",attrs:{slot:"step:files"},slot:"step:files"},[s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Location\n                    ")]),e._v(" "),s("input-text",{attrs:{slot:"content",disabled:"",value:e.files.location},slot:"content"})],1),e._v(" "),s("ui-form-element",{attrs:{underline:e.encryptionEnabled}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Files\n                    ")]),e._v(" "),s("input-select-multiple",{staticClass:"width:100%",attrs:{slot:"content",options:e.filesList,"disabled-entries":e.disabledFiles},slot:"content",model:{value:e.selectedFiles,callback:function(t){e.selectedFiles=t},expression:"selectedFiles"}},e._l(e.issues,(function(t){return s("ui-tooltip",{key:t.file,attrs:{slot:"option:"+t.file,theme:"danger"},slot:"option:"+t.file},[s("span",{staticClass:"c:txt:danger",attrs:{slot:"trigger"},slot:"trigger"},[e._v("\n                                "+e._s(t.file)+"\n                            ")]),e._v(" "),e._l(t.issues,(function(t){return s("li",{key:t,attrs:{theme:"danger"},domProps:{innerHTML:e._s(t)}})}))],2)})),1)],1),e._v(" "),s("ui-form-element",[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        Assign to Reseller\n                    ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.resellerOverrideOptions},slot:"content",model:{value:e.reseller_override,callback:function(t){e.reseller_override=t},expression:"reseller_override"}})],1),e._v(" "),e.encryptionEnabled?[s("ui-form-element",{attrs:{underline:e.decrypt,"vertical-on-phone":!1,reverse:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                            Backup Decryption\n                        ")]),e._v(" "),s("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.decrypt,callback:function(t){e.decrypt=t},expression:"decrypt"}})],1),e._v(" "),s("transition",{attrs:{name:"fadeBounce"}},[e.decrypt?s("ui-form-element",{attrs:{underline:!1,group:"scheduleBackup",validators:{required:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                                Password\n                            ")]),e._v(" "),s("input-password",{attrs:{slot:"content"},slot:"content",model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e()],1)]:e._e()],2)],1)],1)],1)}),[],!1,null,"06f82924",null);"function"==typeof a()&&a()(i);var u=i.exports},"./src/js/pages/admin/backups/restore.vue?vue&type=custom&index=0&blockType=route":function(){},"./node_modules/vue-style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=style&index=0&id=06f82924&lang=scss&scoped=true&":function(e,t,s){var o=s("./node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-6[0].rules[0].use[1]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[2]!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[3]!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-6[0].rules[0].use[4]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/admin/backups/restore.vue?vue&type=style&index=0&id=06f82924&lang=scss&scoped=true&");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,s("./node_modules/vue-style-loader/lib/addStylesClient.js").Z)("6d8d4d5c",o,!0,{})}}]);