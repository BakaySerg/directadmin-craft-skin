(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[8058],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/ftp-accounts/_components/path-suggest.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=s("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var r=o(s("./node_modules/@babel/runtime/regenerator/index.js")),n=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));s("./node_modules/core-js/modules/es.string.starts-with.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js");var u=s("./src/js/api/commands/fm.js"),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var s=d(t);if(s&&s.has(e))return s.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var u=r?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(o,n,u):o[n]=e[n]}o.default=e,s&&s.set(e,o);return o}(s("./node_modules/ramda/src/index.js"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(d=function(e){return e?s:t})(e)}var l,c,p=u.getFolderTree.extend({notifyError:!1,params:{filemanager_du:0,action:"parent_tree"}}),m={name:"PathSuggest",model:{prop:"value",event:"update:value"},props:{value:{type:String,required:!0}},data:function(){return{path:this.value,selected:null,loaded:[],loading:!1,state:[]}},computed:{folders:function(){var e=this,t=this.getParent(this.path),s=i.filter(i.allPass([function(s){return e.getParent(s)===t},function(t){return t.startsWith(e.path)},function(t){return t!==e.path}]));return i.pipe(s,i.sortWith([i.ascend(i.length),i.ascend((function(e){return e}))]))(this.state)}},watch:{value:function(e){e!==this.path&&this.setModel(e)}},methods:{getParent:function(e){var t=e.slice(1).split("/").slice(0,-1).join("/");return"/".concat(t)},treeRequest:(c=(0,n.default)(r.default.mark((function e(t){var s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({path:t});case 2:if(!((s=e.sent)instanceof Error)){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",s.map(i.prop("path")));case 6:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),loadDir:(l=(0,n.default)(r.default.mark((function e(t){var s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loaded.includes(t)){e.next=2;break}return e.abrupt("return");case 2:return this.loaded.push(t),this.loading=!0,e.next=6,this.treeRequest(t);case 6:s=e.sent,this.state=i.filter(Boolean,i.uniq(i.concat(this.state,s))),this.loading=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)}),onInput:function(e){""!==e?("/"!==e[0]&&(e="/".concat(e)),this.$refs.dropdown,this.setModel(e)):this.setModel(e)},setModel:function(e){if(this.folders.includes(e))this.loadDir(e);else{var t=this.getParent(e);this.loadDir(t)}this.path=e,this.$emit("update:value",e)},autocomplete:function(){var e=this.folders;if(0!==e.length)if(null===this.selected)if(1!==e.length){var t=this.path;e.shift().replace(t,"").split("").forEach((function(s){var o=t+s;e.every((function(e){return e.startsWith(o)}))&&(t=o)})),this.setModel(t)}else this.setModel(e[0]);else this.setModel(this.folders[this.selected])},smartBackspace:function(){var e=this.getParent(this.path);this.setModel(e)}}};t.Z=m},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/ftp-accounts/edit.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var a=o(s("./node_modules/@babel/runtime/regenerator/index.js")),r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.array.concat.js");var n,u=s("./src/js/api/commands/validation/index.js"),i=s("./src/js/api/commands/user/ftp.js"),d={components:{PathSuggest:o(s("./src/js/pages/user/ftp-accounts/_components/path-suggest.vue")).default},preload:i.getAccount,api:[{command:i.getAccount,bind:"account"}],commands:{validatePassword:u.validatePassword},props:{user:{type:String,required:!0}},data:function(){return{password:"",type:"domain",customDir:""}},computed:{ftpOptions:function(){return[{id:"domain",label:this.$gettext("Domain"),desc:this.$gettext("FTP account with the root directory in the domains home directory (one up from the public_html)")},{id:"ftp",label:this.$gettext("FTP"),desc:this.$gettext("FTP account with the root directory in the domains public_ftp directory")},{id:"user",label:this.$gettext("User"),desc:this.$gettext("FTP account with the root directory as the users name in the public_html directory")},{id:"custom",label:this.$gettext("Custom"),desc:this.$gettext("Please provide custom directory in the field below")}]},customDirPrefix:function(){return this.$state.session.homeDir}},created:function(){this.type=this.$api.account.type,this.customDir=this.$api.account.path.replace(this.customDirPrefix,"")},methods:{modifyFtpAccount:(n=(0,r.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.updateAccount)({user:this.user,passwd:this.password,passwd2:this.password,type:this.type,custom_val:"".concat(this.customDirPrefix).concat(this.customDir)});case 2:(t=e.sent)&&"0"===t.error&&(this.$notify({theme:"safe",title:this.$gettext("Account modified")}),this.$router.push({name:"user/ftp-accounts"}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),copyPassword:function(){var e=this,t=document.createElement("textarea");t.style.position="fixed",t.style.bottom=0,t.style.right=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=this.password,document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy")&&this.$nextTick((function(){e.$notifications.success({title:"Password copied!"}),document.body.removeChild(t)}))}}};t.Z=d},"./src/js/api/commands/user/ftp.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.updateSettings=t.updateAccount=t.unsuspendAccounts=t.suspendAccounts=t.getSettings=t.getAccounts=t.getAccount=t.deleteAccounts=t.createAccount=t.changePassword=void 0,s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.promise.js");var a=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),r=o(s("./src/js/api/command/index.js"));function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}var u=r.default.get({id:"FTP_ACCOUNT",url:"/CMD_FTP_SHOW",domain:!0,schema:{user:r.default.REQUIRED_STRING}});t.getAccount=u;var i=r.default.get({id:"FTP_ACCOUNTS",url:"/CMD_FTP",response:[],params:{full_json:!0},domain:!0,after:function(e){return e.flow(e.project({accounts:"users",anonLogin:"ANONLOGIN"}),e.mapProp("accounts",e.flow(e.mapValues((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){(0,a.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({login:t},e)})),e.toArray,e.mapArrayProps({suspended:e.convert.toAppBoolean}))))}});t.getAccounts=i;var d=r.default.post({url:"/CMD_FTP",params:{action:"create"},domain:!0,schema:{user:r.default.REQUIRED_STRING,passwd:r.default.REQUIRED_STRING,passwd2:r.default.REQUIRED_STRING,type:r.default.REQUIRED_STRING,custom_val:r.default.OPTIONAL_STRING},notifySuccess:!1});t.createAccount=d;var l=d.extend({params:{action:"modify"},schema:{passwd:r.default.OPTIONAL_STRING,passwd2:r.default.OPTIONAL_STRING}});t.updateAccount=l;var c=r.default.select({url:"/CMD_FTP",domain:!0,params:{action:"delete"},notifySuccess:!1,notifyError:!1}),p=c.extend({params:{suspend:!0}});t.suspendAccounts=p;var m=c.extend({params:{unsuspend:!0}});t.unsuspendAccounts=m;var f=c.extend({params:{delete:!0}});t.deleteAccounts=f;var v=r.default.get({id:"FTP_SETTINGS",url:"/CMD_FTP_SETTINGS",domain:!0,after:function(e){return function(t){return{access:e.convert.toAppBoolean(t.Anonymous),upload:e.convert.toAppBoolean(t.AnonymousUpload),message:e.flow(e.convert.toAppString,e.convert.toAppText)(t.message)}}}});t.getSettings=v;var h=r.default.post({url:"/CMD_FTP_SETTINGS",params:{action:"modify"},domain:!0,schema:{anon:r.default.REQUIRED_BOOL,anonup:r.default.REQUIRED_BOOL,message:r.default.REQUIRED_STRING}});t.updateSettings=h;var _=r.default.post({url:"/CMD_CHANGE_FTP_PASSWORD",schema:{ftp:r.default.REQUIRED_STRING,password1:r.default.REQUIRED_STRING,password2:r.default.REQUIRED_STRING}});t.changePassword=_},"./src/js/api/commands/validation/index.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.validateUsername=t.validateSubdomain=t.validatePassword=t.validateMXValue=t.validateIPRangeList=t.validateForwarder=t.validateFTP=t.validateEmail=t.validateDomain=t.validateDatabase=t.validateDNSValue=t.validateDNSName=t.validateDBUser=void 0;var a=o(s("./src/js/api/command/index.js")),r=o(s("./node_modules/punycode/punycode.es6.js")),n=o(s("./src/js/api/commands/validation/$processors.ts")),u=a.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:a.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:n.default.isValid,message:n.default.getMessage}}),i=u.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});t.validateForwarder=i;var d=u.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});t.validateEmail=d;var l=u.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});t.validateFTP=l;var c=u.extend({params:{type:"dns"},domain:!0,schema:{record:a.default.REQUIRED_STRING}}),p=c.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:a.default.REQUIRED_STRING}});t.validateDNSValue=p;var m=p.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(e){return{value:"10",mx_value:e.value}}});t.validateMXValue=m;var f=c.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:a.default.REQUIRED_STRING,value:null}});t.validateDNSName=f;var v=u.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});t.validateDatabase=v;var h=u.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});t.validateDBUser=h;var _=u.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});t.validateUsername=_;var j=u.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});t.validateSubdomain=j;var y=u.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});t.validatePassword=y;var g=u.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(e){var t=e.value;return{value:r.default.toASCII(t)}}});t.validateDomain=g;var b=u.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});t.validateIPRangeList=b},"./src/js/api/commands/validation/$processors.ts":function(e,t,s){"use strict";s.r(t);var o=s("./src/js/api/commands/converters/index.ts");t.default={isValid:function(e){return void 0===e.error},getMessage:function(e){return(0,o.toAppHtml)(e.error||"")}}},"./src/js/pages/user/ftp-accounts/_components/path-suggest.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return n}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/ftp-accounts/_components/path-suggest.vue?vue&type=script&lang=js&"),a=o.Z,r=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-input-group",{attrs:{slot:"content"},slot:"content"},[s("ui-button",{attrs:{slot:"additions:left",disabled:"disabled"},slot:"additions:left"},[e._v("\n        "+e._s(e.$state.session.homeDir)+"\n    ")]),e._v(" "),s("input-autocomplete",{attrs:{slot:"input",value:e.path,values:e.folders,"suggest-after":0,focused:e.selected,"force-all-values":"","focus-on-mouse-over":!1},on:{"update:focused":function(t){e.selected=t},input:e.onInput},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:(t.stopPropagation(),t.preventDefault(),e.autocomplete.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.autocomplete.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"backspace",void 0,t.key,void 0)?null:t.ctrlKey?(t.preventDefault(),e.smartBackspace.apply(null,arguments)):null}]},slot:"input"})],1)}),[],!1,null,null,null),n=r.exports},"./src/js/pages/user/ftp-accounts/edit.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return o.X},default:function(){return d}});var o=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/user/ftp-accounts/edit.vue?vue&type=script&lang=js&"),a=o.Z,r=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),n=s("./src/js/pages/user/ftp-accounts/edit.vue?vue&type=custom&index=0&blockType=route"),u=s.n(n),i=(0,r.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",[s("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"editFtpAccount"},on:{click:e.modifyFtpAccount},slot:"footer:buttons"},[s("translate",[e._v("Modify")])],1),e._v(" "),s("app-page-section",[s("ui-form-element",{attrs:{vertical:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                FTP Username:\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content",value:e.$api.account.fulluser,disabled:""},slot:"content"})],1),e._v(" "),s("ui-form-element",{attrs:{group:"editFtpAccount",validators:{api:e.$commands.validatePassword},vertical:e.$_Client.isPhone}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Enter Password\n            ")]),e._v(" "),s("input-password",{directives:[{name:"flex-item",rawName:"v-flex-item",value:{grow:!0},expression:"{ grow: true }"}],ref:"password",attrs:{slot:"content","show-generator":""},slot:"content",model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),s("ui-tabs",{attrs:{radio:"",tabs:e.ftpOptions,selected:e.type},on:{"update:selected":function(t){e.type=t}}},[s("ui-form-element",{attrs:{slot:"tab:custom",underline:!e.$_Client.isPhone},slot:"tab:custom"},[e.$_Client.isPhone?e._e():s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Directory\n                ")]),e._v(" "),s("path-suggest",{attrs:{slot:"content"},slot:"content",model:{value:e.customDir,callback:function(t){e.customDir=t},expression:"customDir"}})],1)],1)],1)],1)}),[],!1,null,null,null);"function"==typeof u()&&u()(i);var d=i.exports},"./src/js/pages/user/ftp-accounts/edit.vue?vue&type=custom&index=0&blockType=route":function(){}}]);