(self.webpackChunkcraft=self.webpackChunkcraft||[]).push([[260],{"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/reseller/_dialogs/create-nameservers-dialog.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=r(s("./node_modules/@babel/runtime/regenerator/index.js")),o=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.function.name.js");var a,l=s("./src/js/api/commands/reseller/nameservers.js"),i={api:[{command:l.getServers,bind:"servers"}],props:{forceVirtual:{type:Boolean,required:!1,default:!1}},data:function(){return{domain:"",ns1:{name:"ns1",ip:""},ns2:{name:"ns2",ip:""},virtual:this.forceVirtual}},computed:{apiData:function(){return this.$api.servers},domains:function(){return this.apiData.domains},ips:function(){return this.apiData.ips.map((function(e){return e.ip}))},select:function(){return[this.ns1.ip,this.ns2.ip]},suffix:function(){return this.domain?".".concat(this.domain):""},requestData:function(){return{domain:this.domain,select:this.select,ns1:this.ns1.name,ns2:this.ns2.name,virtual:this.virtual}}},methods:{selectDefaultDomain:function(){this.domain=this.domains[0]||""},create:(a=(0,o.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.createServer)(this.requestData);case 2:(0,l.getServers)(),this.$emit("create"),this.$reset();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}};t.Z=i},"./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/reseller/nameservers.vue?vue&type=script&lang=js&":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=s("./node_modules/@babel/runtime/helpers/typeof.js");Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var o=r(s("./node_modules/@babel/runtime/regenerator/index.js")),a=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.array.filter.js");var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var s=u(t);if(s&&s.has(e))return s.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=o?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(r,a,l):r[a]=e[a]}r.default=e,s&&s.set(e,r);return r}(s("./src/js/api/commands/reseller/nameservers.js")),i=r(s("./src/js/pages/reseller/_dialogs/create-nameservers-dialog.vue"));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(u=function(e){return e?s:t})(e)}var c,d={preload:l.getServers,api:[{command:l.getServers,bind:"servers"}],components:{CreateNameserversDialog:i.default},data:function(){return{ns1:"",ns2:"",checkedRows:[]}},computed:{checkedIPs:function(){return this.checkedRows.map((function(e){return e.ip}))},canDelete:function(){var e=this;if(2!==this.checkedRows.length||this.checkedRows.some((function(e){return!e.ns})))return!1;var t=this.$api.servers.domains.find((function(t){return e.checkedRows[0].ns.includes(t)}));return this.checkedRows[1].ns.includes(t)},actions:function(){return{create:this.$api.servers.ips.filter((function(e){return!e.ns})).length>=2,delete:this.canDelete}}},created:function(){this.ns1=this.$p6e.toU(this.$api.servers.nameservers.ns1),this.ns2=this.$p6e.toU(this.$api.servers.nameservers.ns2)},methods:{reloadRows:function(){l.getServers(),this.checkedRows=[]},updateDefaults:function(){l.setDefault({ns1:this.$p6e.toA(this.ns1),ns2:this.$p6e.toA(this.ns2)}).then(this.reloadRows)},deleteNameservers:(c=(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.deleteServers({select:this.checkedIPs}).then(this.reloadRows);case 1:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})}};t.Z=d},"./src/js/api/commands/reseller/nameservers.js":function(e,t,s){"use strict";s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.symbol.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("./node_modules/core-js/modules/es.object.define-properties.js"),s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.setDefault=t.getServers=t.deleteServers=t.createServer=void 0,s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.promise.js"),s("./node_modules/core-js/modules/es.array.find.js");var n=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=r(s("./src/js/api/command/index.js"));function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){(0,n.default)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var i="/CMD_NAME_SERVER",u=o.default.get({id:"NAMESERVERS",url:i,after:function(e){return e.flow(e.project({ips:"data",domains:"domains",defaultDomain:"domains","nameservers.ns1":"ns1","nameservers.ns2":"ns2"}),e.mapProps({ips:e.flow(e.mapValues((function(e,t){return l(l({},e),{},{ip:t})})),e.toArray,e.mapArray(e.getProps(["ip","status","value","ns"]))),domains:e.flow(e.mapValues(e.getProp("value")),e.toArray),defaultDomain:e.flow(e.find(e.getProp("selected")),e.getProp("value"))}))}});t.getServers=u;var c=o.default.select({url:i,params:{delete:!0}});t.deleteServers=c;var d=o.default.select({url:i,params:{create:!0},schema:{ns1:o.default.REQUIRED_STRING,ns2:o.default.REQUIRED_STRING,domain:o.default.REQUIRED_STRING,virtual:o.default.REQUIRED_BOOL}});t.createServer=d;var m=o.default.post({url:i,params:{action:"modify"},schema:{ns1:o.default.REQUIRED_STRING,ns2:o.default.REQUIRED_STRING}});t.setDefault=m},"./src/js/pages/reseller/_dialogs/create-nameservers-dialog.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return r.X},default:function(){return o}});var r=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/reseller/_dialogs/create-nameservers-dialog.vue?vue&type=script&lang=js&"),n=r.Z,o=(0,s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js").Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-dialog",{attrs:{id:"CREATE_NAMESERVERS_DIALOG",size:"normal"},on:{"dialog:open":e.selectDefaultDomain,"dialog:close":e.$reset}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n        Create Name Servers\n    ")]),e._v(" "),s("template",{slot:"content"},[s("ui-form-element",{attrs:{vertical:""}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Domain:\n            ")]),e._v(" "),s("input-select",{attrs:{slot:"content",options:e.domains},slot:"content",model:{value:e.domain,callback:function(t){e.domain=t},expression:"domain"}},[s("input-checkbox-button",{attrs:{slot:"additions:right",theme:"light",disabled:e.forceVirtual},slot:"additions:right",model:{value:e.virtual,callback:function(t){e.virtual=t},expression:"virtual"}},[s("translate",[e._v("Virtual")])],1)],1)],1),e._v(" "),s("ui-form-element",{attrs:{vertical:""}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Name Server 1:\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content",suffix:e.suffix},slot:"content",model:{value:e.ns1.name,callback:function(t){e.$set(e.ns1,"name",t)},expression:"ns1.name"}})],1),e._v(" "),e.virtual?e._e():s("ui-form-element",{attrs:{vertical:""}},[s("input-select",{attrs:{slot:"content",options:e.ips},slot:"content",model:{value:e.ns1.ip,callback:function(t){e.$set(e.ns1,"ip",t)},expression:"ns1.ip"}})],1),e._v(" "),s("ui-form-element",{attrs:{vertical:""}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Name Server 2:\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content",suffix:e.suffix},slot:"content",model:{value:e.ns2.name,callback:function(t){e.$set(e.ns2,"name",t)},expression:"ns2.name"}})],1),e._v(" "),e.virtual?e._e():s("ui-form-element",{attrs:{vertical:""}},[s("input-select",{attrs:{slot:"content",options:e.ips},slot:"content",model:{value:e.ns2.ip,callback:function(t){e.$set(e.ns2,"ip",t)},expression:"ns2.ip"}})],1)],1),e._v(" "),s("ui-button",{attrs:{slot:"buttons",theme:"primary"},on:{click:e.create},slot:"buttons"},[s("translate",[e._v("Create Name Servers")])],1)],2)}),[],!1,null,null,null).exports},"./src/js/pages/reseller/nameservers.vue":function(e,t,s){"use strict";s.r(t),s.d(t,{__esModule:function(){return r.X},default:function(){return u}});var r=s("./node_modules/babel-loader/lib/index.js!./node_modules/vue-loader/lib/index.js??vue-loader-options!./src/js/pages/reseller/nameservers.vue?vue&type=script&lang=js&"),n=r.Z,o=s("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=s("./src/js/pages/reseller/nameservers.vue?vue&type=custom&index=0&blockType=route"),l=s.n(a),i=(0,o.Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-page",{attrs:{actions:[{label:e.$gettext("Create Name Servers"),theme:"primary",icon:"#plus-fill",handler:e.$dialog("CREATE_NAMESERVERS_DIALOG").open}]}},[s("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(t){e.$dialog("CREATE_NAMESERVERS_DIALOG").open()}},slot:"header:buttons"},[s("translate",[e._v("Create Name Servers")])],1),e._v(" "),s("app-page-section",[s("ui-r-table",{attrs:{columns:[{id:"ip",label:e.$gettext("IP"),editable:!1},{id:"status",label:e.$gettext("Status")},{id:"value",label:e.$gettext("User(s)")},{id:"ns",label:e.$gettext("Name Server"),editable:!1}],rows:e.$api.servers.ips,"checked-rows":e.checkedRows,"vertical-layout":e.$_Client.isPhone,"disable-pagination":"","equal-width-layout":""},on:{"update:checkedRows":function(t){e.checkedRows=t},"update:checked-rows":function(t){e.checkedRows=t}},scopedSlots:e._u([{key:"col:ns",fn:function(t){var s=t.ns;return[e._v("\n                "+e._s(e._f("p6eUnicode")(s))+"\n            ")]}}])},[s("ui-table-action",{attrs:{slot:"table:actions",disabled:!e.actions.delete},on:{click:function(t){e.$dialog("DELETE_ITEMS_DIALOG").open()}},slot:"table:actions"},[s("translate",[e._v("Delete")])],1)],1)],1),e._v(" "),s("app-page-section",[s("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("\n            Set the Name servers that will be assigned to new users\n        ")]),e._v(" "),s("ui-form-element",{attrs:{group:"setNameservers",validators:{required:!0,domain:!0}}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Name Server 1\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.ns1,callback:function(t){e.ns1=t},expression:"ns1"}})],1),e._v(" "),s("ui-form-element",{attrs:{group:"setNameservers",validators:{required:!0,domain:!0},underline:!1}},[s("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                Name Server 2\n            ")]),e._v(" "),s("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.ns2,callback:function(t){e.ns2=t},expression:"ns2"}})],1),e._v(" "),s("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"setNameservers"},on:{click:e.updateDefaults},slot:"footer:buttons"},[s("translate",[e._v("Save")])],1)],1),e._v(" "),s("create-nameservers-dialog",{attrs:{"force-virtual":!e.actions.create},on:{create:function(t){e.checkedRows=[]}}}),e._v(" "),s("ui-dialog-delete-items",{attrs:{subject:e.$gettext("nameserver")},on:{"click:confirm":e.deleteNameservers}})],1)}),[],!1,null,null,null);"function"==typeof l()&&l()(i);var u=i.exports},"./src/js/pages/reseller/nameservers.vue?vue&type=custom&index=0&blockType=route":function(){}}]);